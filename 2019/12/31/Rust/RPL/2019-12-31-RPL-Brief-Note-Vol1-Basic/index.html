<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  
  <meta name="description" content="AI | NLP | 人工智能 | 哲学 | 自然语言处理 | 机器学习" />
  

  
  
  
  
  
  <title>The Rust Programming Language Brief Note (Vol1-Basic) | Yam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1 Getting Started3 Common Concepts3-1 Variables and Mutability3-1-1 Variables and Constants3-1-2 Shadowing3-2 Data Types3-2-1 Scalar3-2-1-1 Integer3-2-1-2 Numeric3-2-1-3 Boolean3-2-1-4 Character3-2-2">
<meta name="keywords" content="Rust">
<meta property="og:type" content="article">
<meta property="og:title" content="The Rust Programming Language Brief Note (Vol1-Basic)">
<meta property="og:url" content="https://www.yam.gift/2019/12/31/Rust/RPL/2019-12-31-RPL-Brief-Note-Vol1-Basic/index.html">
<meta property="og:site_name" content="Yam">
<meta property="og:description" content="1 Getting Started3 Common Concepts3-1 Variables and Mutability3-1-1 Variables and Constants3-1-2 Shadowing3-2 Data Types3-2-1 Scalar3-2-1-1 Integer3-2-1-2 Numeric3-2-1-3 Boolean3-2-1-4 Character3-2-2">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://doc.rust-lang.org/book/img/trpl04-01.svg">
<meta property="og:image" content="https://doc.rust-lang.org/book/img/trpl04-04.svg">
<meta property="og:image" content="https://doc.rust-lang.org/book/img/trpl04-05.svg">
<meta property="og:updated_time" content="2021-06-06T14:44:24.216Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The Rust Programming Language Brief Note (Vol1-Basic)">
<meta name="twitter:description" content="1 Getting Started3 Common Concepts3-1 Variables and Mutability3-1-1 Variables and Constants3-1-2 Shadowing3-2 Data Types3-2-1 Scalar3-2-1-1 Integer3-2-1-2 Numeric3-2-1-3 Boolean3-2-1-4 Character3-2-2">
<meta name="twitter:image" content="https://doc.rust-lang.org/book/img/trpl04-01.svg">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  

  
  <!-- baidu webmaster push -->
<link rel="alternate" href="/atom.xml" title="Yam" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body class="home blog custom-background custom-font-enabled single-author">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="page" class="hfeed site">
      <header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Yam" rel="home">Yam</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">Feeling, Coding, Thinking</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/series/">Series</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/archives/">Archives</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/about/">About</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://github.com/hscspring">Projects</a></li>
                
                </ul>
            </div>
    </nav>
</header>
      <div id="main" class="wrapper">
        <div id="primary" class="site-content"><div id="content" role="main"><article id="post-Rust/RPL/2019-12-31-RPL-Brief-Note-Vol1-Basic" class="post-Rust/RPL/2019-12-31-RPL-Brief-Note-Vol1-Basic post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        
  
    <h1 class="entry-title article-title">
      The Rust Programming Language Brief Note (Vol1-Basic)
    </h1>
  

        
        <!-- <div class="comments-link">
            
            <a href="javascript:void(0);" data-url="https://www.yam.gift/2019/12/31/Rust/RPL/2019-12-31-RPL-Brief-Note-Vol1-Basic/" data-id="ckplb0cn600wh0abzzryl15yz" class="leave-reply bdsharebuttonbox" data-cmd="more">undefined</a>
        </div> --><!-- .comments-link -->
      </header><!-- .entry-header -->

    <div class="entry-content">
      
            <!-- Table of Contents -->
              
        <p><div class="toc"><ul class="toc-item"><li><span><a href="#1-Getting-Started" data-toc-modified-id="1-Getting-Started-1">1 Getting Started</a></span></li><li><span><a href="#3-Common-Concepts" data-toc-modified-id="3-Common-Concepts-2">3 Common Concepts</a></span><ul class="toc-item"><li><span><a href="#3-1-Variables-and-Mutability" data-toc-modified-id="3-1-Variables-and-Mutability-2.1">3-1 Variables and Mutability</a></span><ul class="toc-item"><li><span><a href="#3-1-1-Variables-and-Constants" data-toc-modified-id="3-1-1-Variables-and-Constants-2.1.1">3-1-1 Variables and Constants</a></span></li><li><span><a href="#3-1-2-Shadowing" data-toc-modified-id="3-1-2-Shadowing-2.1.2">3-1-2 Shadowing</a></span></li></ul></li><li><span><a href="#3-2-Data-Types" data-toc-modified-id="3-2-Data-Types-2.2">3-2 Data Types</a></span><ul class="toc-item"><li><span><a href="#3-2-1-Scalar" data-toc-modified-id="3-2-1-Scalar-2.2.1">3-2-1 Scalar</a></span><ul class="toc-item"><li><span><a href="#3-2-1-1-Integer" data-toc-modified-id="3-2-1-1-Integer-2.2.1.1">3-2-1-1 Integer</a></span></li><li><span><a href="#3-2-1-2-Numeric" data-toc-modified-id="3-2-1-2-Numeric-2.2.1.2">3-2-1-2 Numeric</a></span></li><li><span><a href="#3-2-1-3-Boolean" data-toc-modified-id="3-2-1-3-Boolean-2.2.1.3">3-2-1-3 Boolean</a></span></li><li><span><a href="#3-2-1-4-Character" data-toc-modified-id="3-2-1-4-Character-2.2.1.4">3-2-1-4 Character</a></span></li></ul></li><li><span><a href="#3-2-2-Compound-Types" data-toc-modified-id="3-2-2-Compound-Types-2.2.2">3-2-2 Compound Types</a></span><ul class="toc-item"><li><span><a href="#3-2-2-1-Tuple" data-toc-modified-id="3-2-2-1-Tuple-2.2.2.1">3-2-2-1 Tuple</a></span></li><li><span><a href="#3-2-2-2-Array" data-toc-modified-id="3-2-2-2-Array-2.2.2.2">3-2-2-2 Array</a></span></li></ul></li></ul></li><li><span><a href="#3-3-Functions" data-toc-modified-id="3-3-Functions-2.3">3-3 Functions</a></span><ul class="toc-item"><li><span><a href="#3-3-1-Parameters" data-toc-modified-id="3-3-1-Parameters-2.3.1">3-3-1 Parameters</a></span></li><li><span><a href="#3-3-2-Statements-and-Expressions" data-toc-modified-id="3-3-2-Statements-and-Expressions-2.3.2">3-3-2 Statements and Expressions</a></span></li><li><span><a href="#3-3-3-Return-Values" data-toc-modified-id="3-3-3-Return-Values-2.3.3">3-3-3 Return Values</a></span></li></ul></li><li><span><a href="#3-4-Control-Flow" data-toc-modified-id="3-4-Control-Flow-2.4">3-4 Control Flow</a></span><ul class="toc-item"><li><span><a href="#3.4.1-if" data-toc-modified-id="3.4.1-if-2.4.1">3.4.1 if</a></span></li><li><span><a href="#3-4-2-Repetition" data-toc-modified-id="3-4-2-Repetition-2.4.2">3-4-2 Repetition</a></span><ul class="toc-item"><li><span><a href="#3-4-2-1-loop" data-toc-modified-id="3-4-2-1-loop-2.4.2.1">3-4-2-1 loop</a></span></li><li><span><a href="#3-4-2-2-while" data-toc-modified-id="3-4-2-2-while-2.4.2.2">3-4-2-2 while</a></span></li><li><span><a href="#3-4-2-3-for" data-toc-modified-id="3-4-2-3-for-2.4.2.3">3-4-2-3 for</a></span></li></ul></li></ul></li></ul></li><li><span><a href="#4-Understanding-Ownership" data-toc-modified-id="4-Understanding-Ownership-3">4 Understanding Ownership</a></span><ul class="toc-item"><li><span><a href="#4-1-What-Is-Ownership?" data-toc-modified-id="4-1-What-Is-Ownership?-3.1">4-1 What Is Ownership?</a></span><ul class="toc-item"><li><span><a href="#4-1-1-Ownership-Rules" data-toc-modified-id="4-1-1-Ownership-Rules-3.1.1">4-1-1 Ownership Rules</a></span></li><li><span><a href="#4-1-2-Variable-Scope" data-toc-modified-id="4-1-2-Variable-Scope-3.1.2">4-1-2 Variable Scope</a></span></li><li><span><a href="#4-1-3-The-String-Type" data-toc-modified-id="4-1-3-The-String-Type-3.1.3">4-1-3 The String Type</a></span></li><li><span><a href="#4-1-4-Memory-and-Allocation" data-toc-modified-id="4-1-4-Memory-and-Allocation-3.1.4">4-1-4 Memory and Allocation</a></span><ul class="toc-item"><li><span><a href="#4-1-4-1-Move" data-toc-modified-id="4-1-4-1-Move-3.1.4.1">4-1-4-1 Move</a></span></li><li><span><a href="#4-1-4-2-Clone" data-toc-modified-id="4-1-4-2-Clone-3.1.4.2">4-1-4-2 Clone</a></span></li><li><span><a href="#4-1-4-3-Copy" data-toc-modified-id="4-1-4-3-Copy-3.1.4.3">4-1-4-3 Copy</a></span></li></ul></li><li><span><a href="#4-1-5-Ownership-and-Functions" data-toc-modified-id="4-1-5-Ownership-and-Functions-3.1.5">4-1-5 Ownership and Functions</a></span></li><li><span><a href="#4-1-6-Return-Values-and-Scope" data-toc-modified-id="4-1-6-Return-Values-and-Scope-3.1.6">4-1-6 Return Values and Scope</a></span></li></ul></li><li><span><a href="#4-2-References-and-Borrowing" data-toc-modified-id="4-2-References-and-Borrowing-3.2">4-2 References and Borrowing</a></span><ul class="toc-item"><li><span><a href="#4-2-1-Mutable-References" data-toc-modified-id="4-2-1-Mutable-References-3.2.1">4-2-1 Mutable References</a></span></li><li><span><a href="#4-2-2-Dangling-References" data-toc-modified-id="4-2-2-Dangling-References-3.2.2">4-2-2 Dangling References</a></span></li></ul></li><li><span><a href="#4-3-The-Slice-Type" data-toc-modified-id="4-3-The-Slice-Type-3.3">4-3 The Slice Type</a></span><ul class="toc-item"><li><span><a href="#4-3-1-String-Slices" data-toc-modified-id="4-3-1-String-Slices-3.3.1">4-3-1 String Slices</a></span><ul class="toc-item"><li><span><a href="#4-3-1-1-String-Literals-Are-Slices" data-toc-modified-id="4-3-1-1-String-Literals-Are-Slices-3.3.1.1">4-3-1-1 String Literals Are Slices</a></span></li><li><span><a href="#4-3-1-2-String-Slices-as-Parameters" data-toc-modified-id="4-3-1-2-String-Slices-as-Parameters-3.3.1.2">4-3-1-2 String Slices as Parameters</a></span></li></ul></li><li><span><a href="#4-3-2-Other-Slices" data-toc-modified-id="4-3-2-Other-Slices-3.3.2">4-3-2 Other Slices</a></span></li></ul></li></ul></li><li><span><a href="#5-Using-Structs-to-Structure-Related-Data" data-toc-modified-id="5-Using-Structs-to-Structure-Related-Data-4">5 Using Structs to Structure Related Data</a></span><ul class="toc-item"><li><span><a href="#5-1-Defining-and-Instantiating-Structs" data-toc-modified-id="5-1-Defining-and-Instantiating-Structs-4.1">5-1 Defining and Instantiating Structs</a></span><ul class="toc-item"><li><span><a href="#5-1-1-Using-the-Field-Init-Shorthand-When-Variables-and-Fields-Have-the-Same-Name" data-toc-modified-id="5-1-1-Using-the-Field-Init-Shorthand-When-Variables-and-Fields-Have-the-Same-Name-4.1.1">5-1-1 Using the Field Init Shorthand When Variables and Fields Have the Same Name</a></span></li><li><span><a href="#5-1-2-Creating-Instances-From-Other-Instances-With-Struct-Update-Syntax" data-toc-modified-id="5-1-2-Creating-Instances-From-Other-Instances-With-Struct-Update-Syntax-4.1.2">5-1-2 Creating Instances From Other Instances With Struct Update Syntax</a></span></li><li><span><a href="#5-1-3-Using-Tuple-Structs-without-Named-Fields-to-Create-Different-Types" data-toc-modified-id="5-1-3-Using-Tuple-Structs-without-Named-Fields-to-Create-Different-Types-4.1.3">5-1-3 Using Tuple Structs without Named Fields to Create Different Types</a></span></li><li><span><a href="#5-1-4-Unit-Like-Structs-Without-Any-Fields" data-toc-modified-id="5-1-4-Unit-Like-Structs-Without-Any-Fields-4.1.4">5-1-4 Unit-Like Structs Without Any Fields</a></span></li><li><span><a href="#5-1-5-Ownership-of-Struct-Data" data-toc-modified-id="5-1-5-Ownership-of-Struct-Data-4.1.5">5-1-5 Ownership of Struct Data</a></span></li></ul></li><li><span><a href="#5-2-An-Example-Program-Using-Structs" data-toc-modified-id="5-2-An-Example-Program-Using-Structs-4.2">5-2 An Example Program Using Structs</a></span><ul class="toc-item"><li><span><a href="#5-2-1-Refactoring-with-Tuples" data-toc-modified-id="5-2-1-Refactoring-with-Tuples-4.2.1">5-2-1 Refactoring with Tuples</a></span></li><li><span><a href="#5-2-2-Refactoring-with-Structs-Adding-More-Meaning" data-toc-modified-id="5-2-2-Refactoring-with-Structs-Adding-More-Meaning-4.2.2">5-2-2 Refactoring with Structs Adding More Meaning</a></span></li><li><span><a href="#5-2-3-Adding-Useful-Functionality-with-Derived-Traits" data-toc-modified-id="5-2-3-Adding-Useful-Functionality-with-Derived-Traits-4.2.3">5-2-3 Adding Useful Functionality with Derived Traits</a></span></li></ul></li><li><span><a href="#5-3-Method-Syntax" data-toc-modified-id="5-3-Method-Syntax-4.3">5-3 Method Syntax</a></span><ul class="toc-item"><li><span><a href="#5-3-1-Defining-Methods" data-toc-modified-id="5-3-1-Defining-Methods-4.3.1">5-3-1 Defining Methods</a></span></li><li><span><a href="#5-3-2-Methods-with-More-Parameters" data-toc-modified-id="5-3-2-Methods-with-More-Parameters-4.3.2">5-3-2 Methods with More Parameters</a></span></li><li><span><a href="#5-3-3-Associated-Functions" data-toc-modified-id="5-3-3-Associated-Functions-4.3.3">5-3-3 Associated Functions</a></span></li><li><span><a href="#5-3-4-Multiple-impl-Blocks" data-toc-modified-id="5-3-4-Multiple-impl-Blocks-4.3.4">5-3-4 Multiple impl Blocks</a></span></li></ul></li></ul></li><li><span><a href="#6-Enums-and-Pattern-Matching" data-toc-modified-id="6-Enums-and-Pattern-Matching-5">6 Enums and Pattern Matching</a></span><ul class="toc-item"><li><span><a href="#6-1-Defining-an-Enum" data-toc-modified-id="6-1-Defining-an-Enum-5.1">6-1 Defining an Enum</a></span><ul class="toc-item"><li><span><a href="#6-1-1-Enum-Values" data-toc-modified-id="6-1-1-Enum-Values-5.1.1">6-1-1 Enum Values</a></span></li><li><span><a href="#6-1-2-The-Option-Enum-and-Its-Advantages-Over-Null-Vlues" data-toc-modified-id="6-1-2-The-Option-Enum-and-Its-Advantages-Over-Null-Vlues-5.1.2">6-1-2 The Option Enum and Its Advantages Over Null Vlues</a></span></li></ul></li><li><span><a href="#6-2-The-match-Control-Flow-Operator" data-toc-modified-id="6-2-The-match-Control-Flow-Operator-5.2">6-2 The match Control Flow Operator</a></span><ul class="toc-item"><li><span><a href="#6-2-1-Patterns-that-Bind-to-Values" data-toc-modified-id="6-2-1-Patterns-that-Bind-to-Values-5.2.1">6-2-1 Patterns that Bind to Values</a></span></li><li><span><a href="#6-2-2-Matching-with-Option<T>" data-toc-modified-id="6-2-2-Matching-with-Option<T>-5.2.2">6-2-2 Matching with <code>Option&lt;T&gt;</code></a></span></li><li><span><a href="#6-2-3-Matches-Are-Exhaustive" data-toc-modified-id="6-2-3-Matches-Are-Exhaustive-5.2.3">6-2-3 Matches Are Exhaustive</a></span></li><li><span><a href="#6-2-4-The-_-Placeholder" data-toc-modified-id="6-2-4-The-_-Placeholder-5.2.4">6-2-4 The <code>_</code> Placeholder</a></span></li></ul></li><li><span><a href="#6-3-Concise-Control-Flow-with-if-let" data-toc-modified-id="6-3-Concise-Control-Flow-with-if-let-5.3">6-3 Concise Control Flow with if let</a></span></li></ul></li><li><span><a href="#8-Common-Collections" data-toc-modified-id="8-Common-Collections-6">8 Common Collections</a></span><ul class="toc-item"><li><span><a href="#8-1-Storing-Lists-of-Values-with-Vectors" data-toc-modified-id="8-1-Storing-Lists-of-Values-with-Vectors-6.1">8-1 Storing Lists of Values with Vectors</a></span><ul class="toc-item"><li><span><a href="#8-1-1-Create-a-New-Vector" data-toc-modified-id="8-1-1-Create-a-New-Vector-6.1.1">8-1-1 Create a New Vector</a></span></li><li><span><a href="#8-1-2-Updating-a-Vector" data-toc-modified-id="8-1-2-Updating-a-Vector-6.1.2">8-1-2 Updating a Vector</a></span></li><li><span><a href="#8-1-3-Dropping-a-Vector-Drops-Its-Elements" data-toc-modified-id="8-1-3-Dropping-a-Vector-Drops-Its-Elements-6.1.3">8-1-3 Dropping a Vector Drops Its Elements</a></span></li><li><span><a href="#8-1-4-Reading-Elements-of-Vectors" data-toc-modified-id="8-1-4-Reading-Elements-of-Vectors-6.1.4">8-1-4 Reading Elements of Vectors</a></span></li><li><span><a href="#8-1-5-Iterating-over-the-Values-in-a-Vector" data-toc-modified-id="8-1-5-Iterating-over-the-Values-in-a-Vector-6.1.5">8-1-5 Iterating over the Values in a Vector</a></span></li><li><span><a href="#8-1-6-Using-an-Enum-to-Store-Multiple-Types" data-toc-modified-id="8-1-6-Using-an-Enum-to-Store-Multiple-Types-6.1.6">8-1-6 Using an Enum to Store Multiple Types</a></span></li></ul></li><li><span><a href="#8-2-Storing-UTF-8-Encoded-Text-with-Strings" data-toc-modified-id="8-2-Storing-UTF-8-Encoded-Text-with-Strings-6.2">8-2 Storing UTF-8 Encoded Text with Strings</a></span><ul class="toc-item"><li><span><a href="#8-2-1-What-Is-a-String?" data-toc-modified-id="8-2-1-What-Is-a-String?-6.2.1">8-2-1 What Is a String?</a></span></li><li><span><a href="#8-2-2-Creating-a-New-String" data-toc-modified-id="8-2-2-Creating-a-New-String-6.2.2">8-2-2 Creating a New String</a></span></li><li><span><a href="#8-2-3-Updating-a-String" data-toc-modified-id="8-2-3-Updating-a-String-6.2.3">8-2-3 Updating a String</a></span><ul class="toc-item"><li><span><a href="#8-2-3-1-Appending-to-a-String-with-push_str-and-push" data-toc-modified-id="8-2-3-1-Appending-to-a-String-with-push_str-and-push-6.2.3.1">8-2-3-1 Appending to a String with <code>push_str</code> and <code>push</code></a></span></li><li><span><a href="#8-2-3-2-Concatenation-with-the-+-Operator-or-the-format!-Macro" data-toc-modified-id="8-2-3-2-Concatenation-with-the-+-Operator-or-the-format!-Macro-6.2.3.2">8-2-3-2 Concatenation with the <code>+</code> Operator or the <code>format!</code> Macro</a></span></li></ul></li><li><span><a href="#8-2-4-Indexing-into-Strings" data-toc-modified-id="8-2-4-Indexing-into-Strings-6.2.4">8-2-4 Indexing into Strings</a></span><ul class="toc-item"><li><span><a href="#8-2-4-1-Internal-Representation" data-toc-modified-id="8-2-4-1-Internal-Representation-6.2.4.1">8-2-4-1 Internal Representation</a></span></li><li><span><a href="#8-2-4-2-Bytes-and-Scalar-Values-and-Grapheme-Clusters" data-toc-modified-id="8-2-4-2-Bytes-and-Scalar-Values-and-Grapheme-Clusters-6.2.4.2">8-2-4-2 Bytes and Scalar Values and Grapheme Clusters</a></span></li></ul></li><li><span><a href="#8-2-5-Slicing-Strings" data-toc-modified-id="8-2-5-Slicing-Strings-6.2.5">8-2-5 Slicing Strings</a></span></li><li><span><a href="#8-2-6-Methods-for-Iterating-Over-Strings" data-toc-modified-id="8-2-6-Methods-for-Iterating-Over-Strings-6.2.6">8-2-6 Methods for Iterating Over Strings</a></span></li><li><span><a href="#8-2-7-Exercise" data-toc-modified-id="8-2-7-Exercise-6.2.7">8-2-7 Exercise</a></span></li></ul></li><li><span><a href="#8-3-Storing-Keys-with-Associated-Values-in-Hash-Maps" data-toc-modified-id="8-3-Storing-Keys-with-Associated-Values-in-Hash-Maps-6.3">8-3 Storing Keys with Associated Values in Hash Maps</a></span><ul class="toc-item"><li><span><a href="#8-3-1-Creating-a-New-Hash-Map" data-toc-modified-id="8-3-1-Creating-a-New-Hash-Map-6.3.1">8-3-1 Creating a New Hash Map</a></span></li><li><span><a href="#8-3-2-Hash-Maps-and-Ownership" data-toc-modified-id="8-3-2-Hash-Maps-and-Ownership-6.3.2">8-3-2 Hash Maps and Ownership</a></span></li><li><span><a href="#8-3-3-Accessing-Values-in-a-Hash-Map" data-toc-modified-id="8-3-3-Accessing-Values-in-a-Hash-Map-6.3.3">8-3-3 Accessing Values in a Hash Map</a></span></li><li><span><a href="#8-3-4-Updating-a-Hash-Map" data-toc-modified-id="8-3-4-Updating-a-Hash-Map-6.3.4">8-3-4 Updating a Hash Map</a></span><ul class="toc-item"><li><span><a href="#8-3-4-1-Overwriting-a-Value" data-toc-modified-id="8-3-4-1-Overwriting-a-Value-6.3.4.1">8-3-4-1 Overwriting a Value</a></span></li><li><span><a href="#8-3-4-2-Only-Inserting-a-Value-If-the-Key-Has-No-Value" data-toc-modified-id="8-3-4-2-Only-Inserting-a-Value-If-the-Key-Has-No-Value-6.3.4.2">8-3-4-2 Only Inserting a Value If the Key Has No Value</a></span></li><li><span><a href="#8-3-4-3-Updating-a-Value-Based-on-the-Old-Value" data-toc-modified-id="8-3-4-3-Updating-a-Value-Based-on-the-Old-Value-6.3.4.3">8-3-4-3 Updating a Value Based on the Old Value</a></span></li></ul></li><li><span><a href="#8-3-5-Hashing-Functions" data-toc-modified-id="8-3-5-Hashing-Functions-6.3.5">8-3-5 Hashing Functions</a></span></li></ul></li></ul></li><li><span><a href="#9-Error-Handling" data-toc-modified-id="9-Error-Handling-7">9 Error Handling</a></span><ul class="toc-item"><li><span><a href="#9-1-Unrecoverable-Errors-with-panic!" data-toc-modified-id="9-1-Unrecoverable-Errors-with-panic!-7.1">9-1 Unrecoverable Errors with <code>panic!</code></a></span><ul class="toc-item"><li><span><a href="#9-1-1-Using-a-panic!-Backtrace" data-toc-modified-id="9-1-1-Using-a-panic!-Backtrace-7.1.1">9-1-1 Using a <code>panic!</code> Backtrace</a></span></li></ul></li><li><span><a href="#9-2-Recoverable-Errors-with-Result" data-toc-modified-id="9-2-Recoverable-Errors-with-Result-7.2">9-2 Recoverable Errors with Result</a></span><ul class="toc-item"><li><span><a href="#9-2-1-Matching-on-Different-Errors" data-toc-modified-id="9-2-1-Matching-on-Different-Errors-7.2.1">9-2-1 Matching on Different Errors</a></span></li><li><span><a href="#9-2-2-Shortcuts-for-Panic-on-Error-unwrap-and-expect" data-toc-modified-id="9-2-2-Shortcuts-for-Panic-on-Error-unwrap-and-expect-7.2.2">9-2-2 Shortcuts for Panic on Error <code>unwrap</code> and <code>expect</code></a></span></li><li><span><a href="#9-2-3-Propagating-Errors" data-toc-modified-id="9-2-3-Propagating-Errors-7.2.3">9-2-3 Propagating Errors</a></span></li><li><span><a href="#9-2-4-A-Shortcut-for-Propagating-Errors-the-?-Operator" data-toc-modified-id="9-2-4-A-Shortcut-for-Propagating-Errors-the-?-Operator-7.2.4">9-2-4 A Shortcut for Propagating Errors the <code>?</code> Operator</a></span></li><li><span><a href="#9-2-5-The-?-Operator-Can-Only-Be-Used-in-Functions-That-Return-Result" data-toc-modified-id="9-2-5-The-?-Operator-Can-Only-Be-Used-in-Functions-That-Return-Result-7.2.5">9-2-5 The <code>?</code> Operator Can Only Be Used in Functions That Return <code>Result</code></a></span></li></ul></li><li><span><a href="#9-3-To-panic!-or-Not-to-panic!" data-toc-modified-id="9-3-To-panic!-or-Not-to-panic!-7.3">9-3 To <code>panic!</code> or Not to <code>panic!</code></a></span><ul class="toc-item"><li><span><a href="#9-3-1-Examples-Prototype-Code-and-Tests" data-toc-modified-id="9-3-1-Examples-Prototype-Code-and-Tests-7.3.1">9-3-1 Examples Prototype Code and Tests</a></span></li><li><span><a href="#9-3-2-Cases-in-Which-You-Have-More-Information-Than-the-Compiler" data-toc-modified-id="9-3-2-Cases-in-Which-You-Have-More-Information-Than-the-Compiler-7.3.2">9-3-2 Cases in Which You Have More Information Than the Compiler</a></span></li><li><span><a href="#9-3-3-Guidelines-for-Error-Handling" data-toc-modified-id="9-3-3-Guidelines-for-Error-Handling-7.3.3">9-3-3 Guidelines for Error Handling</a></span></li><li><span><a href="#9-3-4-Creating-Custom-Types-for-Validation" data-toc-modified-id="9-3-4-Creating-Custom-Types-for-Validation-7.3.4">9-3-4 Creating Custom Types for Validation</a></span></li></ul></li></ul></li><li><span><a href="#10-Generic-Types,-Traits,-and-Lifetimes" data-toc-modified-id="10-Generic-Types,-Traits,-and-Lifetimes-8">10 Generic Types, Traits, and Lifetimes</a></span><ul class="toc-item"><li><span><a href="#10-1-Generic-Data-Types" data-toc-modified-id="10-1-Generic-Data-Types-8.1">10-1 Generic Data Types</a></span><ul class="toc-item"><li><span><a href="#10-1-1-In-Function-Definitions" data-toc-modified-id="10-1-1-In-Function-Definitions-8.1.1">10-1-1 In Function Definitions</a></span></li><li><span><a href="#10-1-2-In-Struct-Definitions" data-toc-modified-id="10-1-2-In-Struct-Definitions-8.1.2">10-1-2 In Struct Definitions</a></span></li><li><span><a href="#10-1-3-In-Enum-Definitions" data-toc-modified-id="10-1-3-In-Enum-Definitions-8.1.3">10-1-3 In Enum Definitions</a></span></li><li><span><a href="#10-1-4-In-Method-Definitions" data-toc-modified-id="10-1-4-In-Method-Definitions-8.1.4">10-1-4 In Method Definitions</a></span></li><li><span><a href="#10-1-5-Performance-of-Code-Using-Generics" data-toc-modified-id="10-1-5-Performance-of-Code-Using-Generics-8.1.5">10-1-5 Performance of Code Using Generics</a></span></li></ul></li><li><span><a href="#10-2-Traits-Defining-Shared-Behavior" data-toc-modified-id="10-2-Traits-Defining-Shared-Behavior-8.2">10-2 Traits Defining Shared Behavior</a></span><ul class="toc-item"><li><span><a href="#10-2-1-Defining-a-Trait" data-toc-modified-id="10-2-1-Defining-a-Trait-8.2.1">10-2-1 Defining a Trait</a></span></li><li><span><a href="#10-2-2-Implementing-a-Trait-on-a-Type" data-toc-modified-id="10-2-2-Implementing-a-Trait-on-a-Type-8.2.2">10-2-2 Implementing a Trait on a Type</a></span></li><li><span><a href="#10-2-3-Default-Implementations" data-toc-modified-id="10-2-3-Default-Implementations-8.2.3">10-2-3 Default Implementations</a></span></li><li><span><a href="#10-2-4-Traits-as-Parameters" data-toc-modified-id="10-2-4-Traits-as-Parameters-8.2.4">10-2-4 Traits as Parameters</a></span><ul class="toc-item"><li><span><a href="#10-2-4-1-Trait-Bound-Syntax" data-toc-modified-id="10-2-4-1-Trait-Bound-Syntax-8.2.4.1">10-2-4-1 Trait Bound Syntax</a></span></li><li><span><a href="#10-2-4-2-Specifying-Multiple-Trait-Bounds-with-+-Syntax" data-toc-modified-id="10-2-4-2-Specifying-Multiple-Trait-Bounds-with-+-Syntax-8.2.4.2">10-2-4-2 Specifying Multiple Trait Bounds with <code>+</code> Syntax</a></span></li><li><span><a href="#10-2-4-3-Clearer-Trait-Bounds-with-where-Clauses" data-toc-modified-id="10-2-4-3-Clearer-Trait-Bounds-with-where-Clauses-8.2.4.3">10-2-4-3 Clearer Trait Bounds with <code>where</code> Clauses</a></span></li></ul></li><li><span><a href="#10-2-5-Returning-Types-that-Implement-Traits" data-toc-modified-id="10-2-5-Returning-Types-that-Implement-Traits-8.2.5">10-2-5 Returning Types that Implement Traits</a></span></li><li><span><a href="#10-2-6-Fixing-the-largest-Function-with-Trait-Bounds" data-toc-modified-id="10-2-6-Fixing-the-largest-Function-with-Trait-Bounds-8.2.6">10-2-6 Fixing the <code>largest</code> Function with Trait Bounds</a></span></li><li><span><a href="#10-2-7-Using-Trait-Bounds-to-Conditionally-Implement-Methods" data-toc-modified-id="10-2-7-Using-Trait-Bounds-to-Conditionally-Implement-Methods-8.2.7">10-2-7 Using Trait Bounds to Conditionally Implement Methods</a></span></li></ul></li><li><span><a href="#10-3-Validating-References-with-Lifetimes" data-toc-modified-id="10-3-Validating-References-with-Lifetimes-8.3">10-3 Validating References with Lifetimes</a></span><ul class="toc-item"><li><span><a href="#10-3-1-Preventing-Dangling-References-with-Lifetimes" data-toc-modified-id="10-3-1-Preventing-Dangling-References-with-Lifetimes-8.3.1">10-3-1 Preventing Dangling References with Lifetimes</a></span></li><li><span><a href="#10-3-2-The-Borrow-Checker" data-toc-modified-id="10-3-2-The-Borrow-Checker-8.3.2">10-3-2 The Borrow Checker</a></span></li><li><span><a href="#10-3-3-Generic-Lifetimes-in-Functions" data-toc-modified-id="10-3-3-Generic-Lifetimes-in-Functions-8.3.3">10-3-3 Generic Lifetimes in Functions</a></span></li><li><span><a href="#10-3-4-Lifetime-Annotation-Syntax" data-toc-modified-id="10-3-4-Lifetime-Annotation-Syntax-8.3.4">10-3-4 Lifetime Annotation Syntax</a></span></li><li><span><a href="#10-3-5-Lifetime-Annotations-in-Function-Signatures" data-toc-modified-id="10-3-5-Lifetime-Annotations-in-Function-Signatures-8.3.5">10-3-5 Lifetime Annotations in Function Signatures</a></span></li><li><span><a href="#10-3-6-Thinking-in-Terms-of-Lifetimes" data-toc-modified-id="10-3-6-Thinking-in-Terms-of-Lifetimes-8.3.6">10-3-6 Thinking in Terms of Lifetimes</a></span></li><li><span><a href="#10-3-7-Lifetime-Annotations-in-Struct-Definitions" data-toc-modified-id="10-3-7-Lifetime-Annotations-in-Struct-Definitions-8.3.7">10-3-7 Lifetime Annotations in Struct Definitions</a></span></li><li><span><a href="#10-3-8-Lifetime-Elision" data-toc-modified-id="10-3-8-Lifetime-Elision-8.3.8">10-3-8 Lifetime Elision</a></span></li><li><span><a href="#10-3-9-Lifetime-Annotations-in-Method-Definitions" data-toc-modified-id="10-3-9-Lifetime-Annotations-in-Method-Definitions-8.3.9">10-3-9 Lifetime Annotations in Method Definitions</a></span></li><li><span><a href="#10-3-10-The-Static-Lifetime" data-toc-modified-id="10-3-10-The-Static-Lifetime-8.3.10">10-3-10 The Static Lifetime</a></span></li></ul></li><li><span><a href="#10-4-Generic-Type-Parameters-Trait-Bounds-and-Lifetimes-Together" data-toc-modified-id="10-4-Generic-Type-Parameters-Trait-Bounds-and-Lifetimes-Together-8.4">10-4 Generic Type Parameters Trait Bounds and Lifetimes Together</a></span></li></ul></li><li><span><a href="#11-Writing-Automated-Tests" data-toc-modified-id="11-Writing-Automated-Tests-9">11 Writing Automated Tests</a></span><ul class="toc-item"><li><span><a href="#11-1-How-to-Write-Tests" data-toc-modified-id="11-1-How-to-Write-Tests-9.1">11-1 How to Write Tests</a></span><ul class="toc-item"><li><span><a href="#11-1-1-The-Anatomy-of-a-Test-Function" data-toc-modified-id="11-1-1-The-Anatomy-of-a-Test-Function-9.1.1">11-1-1 The Anatomy of a Test Function</a></span></li><li><span><a href="#11-1-2-Checking-Results-with-the-assert!-Macro" data-toc-modified-id="11-1-2-Checking-Results-with-the-assert!-Macro-9.1.2">11-1-2 Checking Results with the <code>assert!</code> Macro</a></span></li><li><span><a href="#11-1-3-Testing-Equality-with-the-assert_eq!-and-assert_ne!-Macros" data-toc-modified-id="11-1-3-Testing-Equality-with-the-assert_eq!-and-assert_ne!-Macros-9.1.3">11-1-3 Testing Equality with the <code>assert_eq!</code> and <code>assert_ne!</code> Macros</a></span></li><li><span><a href="#11-1-4-Adding-Custom-Failure-Messages" data-toc-modified-id="11-1-4-Adding-Custom-Failure-Messages-9.1.4">11-1-4 Adding Custom Failure Messages</a></span></li><li><span><a href="#11-1-5-Checking-for-Panics-with-should_panic" data-toc-modified-id="11-1-5-Checking-for-Panics-with-should_panic-9.1.5">11-1-5 Checking for Panics with <code>should_panic</code></a></span></li><li><span><a href="#11-1-6-Using-Result<T,-E>-in-Tests" data-toc-modified-id="11-1-6-Using-Result<T,-E>-in-Tests-9.1.6">11-1-6 Using <code>Result&lt;T, E&gt;</code> in Tests</a></span></li></ul></li><li><span><a href="#11-2-Controlling-How-Tests-Are-Run" data-toc-modified-id="11-2-Controlling-How-Tests-Are-Run-9.2">11-2 Controlling How Tests Are Run</a></span><ul class="toc-item"><li><span><a href="#11-2-1-Running-Tests-in-Parallel-or-Consecutively" data-toc-modified-id="11-2-1-Running-Tests-in-Parallel-or-Consecutively-9.2.1">11-2-1 Running Tests in Parallel or Consecutively</a></span></li><li><span><a href="#11-2-2-Showing-Function-Output" data-toc-modified-id="11-2-2-Showing-Function-Output-9.2.2">11-2-2 Showing Function Output</a></span></li><li><span><a href="#11-2-3-Running-a-Subset-of-Tests-by-Name" data-toc-modified-id="11-2-3-Running-a-Subset-of-Tests-by-Name-9.2.3">11-2-3 Running a Subset of Tests by Name</a></span></li><li><span><a href="#11-2-4-Ignoring-Some-Tests-Unless-Specifically-Requested" data-toc-modified-id="11-2-4-Ignoring-Some-Tests-Unless-Specifically-Requested-9.2.4">11-2-4 Ignoring Some Tests Unless Specifically Requested</a></span></li></ul></li><li><span><a href="#11-3-Test-Organization" data-toc-modified-id="11-3-Test-Organization-9.3">11-3 Test Organization</a></span><ul class="toc-item"><li><span><a href="#11-3-1-Unit-Tests" data-toc-modified-id="11-3-1-Unit-Tests-9.3.1">11-3-1 Unit Tests</a></span><ul class="toc-item"><li><span><a href="#11-3-1-1-The-Tests-Module-and-#[cfg(test)]" data-toc-modified-id="11-3-1-1-The-Tests-Module-and-#[cfg(test)]-9.3.1.1">11-3-1-1 The Tests Module and <code>#[cfg(test)]</code></a></span></li><li><span><a href="#11-3-1-2-Testing-Private-Functions" data-toc-modified-id="11-3-1-2-Testing-Private-Functions-9.3.1.2">11-3-1-2 Testing Private Functions</a></span></li></ul></li><li><span><a href="#11-3-2-Integration-Tests" data-toc-modified-id="11-3-2-Integration-Tests-9.3.2">11-3-2 Integration Tests</a></span><ul class="toc-item"><li><span><a href="#11-3-2-1-The-tests-Directory" data-toc-modified-id="11-3-2-1-The-tests-Directory-9.3.2.1">11-3-2-1 The tests Directory</a></span></li><li><span><a href="#11-3-2-2-Submodules-in-Integration-Tests" data-toc-modified-id="11-3-2-2-Submodules-in-Integration-Tests-9.3.2.2">11-3-2-2 Submodules in Integration Tests</a></span></li><li><span><a href="#11-3-2-3-Integration-Tests-for-Binary-Crates" data-toc-modified-id="11-3-2-3-Integration-Tests-for-Binary-Crates-9.3.2.3">11-3-2-3 Integration Tests for Binary Crates</a></span></li></ul></li></ul></li></ul></li><li><span><a href="#18-Patterns-and-Matching" data-toc-modified-id="18-Patterns-and-Matching-10">18 Patterns and Matching</a></span><ul class="toc-item"><li><span><a href="#18-1-All-the-Places-Patterns-Can-Be-Used" data-toc-modified-id="18-1-All-the-Places-Patterns-Can-Be-Used-10.1">18-1 All the Places Patterns Can Be Used</a></span><ul class="toc-item"><li><span><a href="#18-1-1-match-Arms" data-toc-modified-id="18-1-1-match-Arms-10.1.1">18-1-1 <code>match</code> Arms</a></span></li><li><span><a href="#18-1-2-Conditional-if-let-Expressions" data-toc-modified-id="18-1-2-Conditional-if-let-Expressions-10.1.2">18-1-2 Conditional <code>if let</code> Expressions</a></span></li><li><span><a href="#18-1-3-while-let-Conditional-Loops" data-toc-modified-id="18-1-3-while-let-Conditional-Loops-10.1.3">18-1-3 <code>while let</code> Conditional Loops</a></span></li><li><span><a href="#18-1-4-for-Loops" data-toc-modified-id="18-1-4-for-Loops-10.1.4">18-1-4 <code>for</code> Loops</a></span></li><li><span><a href="#18-1-5-let-Statements" data-toc-modified-id="18-1-5-let-Statements-10.1.5">18-1-5 <code>let</code> Statements</a></span></li><li><span><a href="#18-1-6-Function-Parameters" data-toc-modified-id="18-1-6-Function-Parameters-10.1.6">18-1-6 Function Parameters</a></span></li></ul></li><li><span><a href="#18-2-Refutability-Whether-a-Pattern-Might-Fail-to-Match" data-toc-modified-id="18-2-Refutability-Whether-a-Pattern-Might-Fail-to-Match-10.2">18-2 Refutability Whether a Pattern Might Fail to Match</a></span></li><li><span><a href="#18-3-Pattern-Syntax" data-toc-modified-id="18-3-Pattern-Syntax-10.3">18-3 Pattern Syntax</a></span><ul class="toc-item"><li><span><a href="#18-3-1-Matching-Literals" data-toc-modified-id="18-3-1-Matching-Literals-10.3.1">18-3-1 Matching Literals</a></span></li><li><span><a href="#18-3-2-Matching-Named-Variables" data-toc-modified-id="18-3-2-Matching-Named-Variables-10.3.2">18-3-2 Matching Named Variables</a></span></li><li><span><a href="#18-3-3-Multiple-Patterns" data-toc-modified-id="18-3-3-Multiple-Patterns-10.3.3">18-3-3 Multiple Patterns</a></span></li><li><span><a href="#18-3-4-Matching-Ranges-of-Values-with-..=" data-toc-modified-id="18-3-4-Matching-Ranges-of-Values-with-..=-10.3.4">18-3-4 Matching Ranges of Values with <code>..=</code></a></span></li><li><span><a href="#18-3-5-Destructuring-to-Break-Apart-Values" data-toc-modified-id="18-3-5-Destructuring-to-Break-Apart-Values-10.3.5">18-3-5 Destructuring to Break Apart Values</a></span><ul class="toc-item"><li><span><a href="#18-3-5-1-Destructuring-Structs" data-toc-modified-id="18-3-5-1-Destructuring-Structs-10.3.5.1">18-3-5-1 Destructuring Structs</a></span></li><li><span><a href="#18-3-5-2-Destructuring-Enums" data-toc-modified-id="18-3-5-2-Destructuring-Enums-10.3.5.2">18-3-5-2 Destructuring Enums</a></span></li><li><span><a href="#18-3-5-3-Destructuring-Nested-Structs-and-Enums" data-toc-modified-id="18-3-5-3-Destructuring-Nested-Structs-and-Enums-10.3.5.3">18-3-5-3 Destructuring Nested Structs and Enums</a></span></li><li><span><a href="#18-3-5-4-Destructuring-Structs-and-Tuples" data-toc-modified-id="18-3-5-4-Destructuring-Structs-and-Tuples-10.3.5.4">18-3-5-4 Destructuring Structs and Tuples</a></span></li></ul></li><li><span><a href="#18-3-6-Ignoring-Values-in-a-Pattern" data-toc-modified-id="18-3-6-Ignoring-Values-in-a-Pattern-10.3.6">18-3-6 Ignoring Values in a Pattern</a></span><ul class="toc-item"><li><span><a href="#18-3-6-1-Ignoring-an-Entire-Value-with-_" data-toc-modified-id="18-3-6-1-Ignoring-an-Entire-Value-with-_-10.3.6.1">18-3-6-1 Ignoring an Entire Value with <code>_</code></a></span></li><li><span><a href="#18-3-6-2-Ignoring-Parts-of-a-Value-with-a-Nested-_" data-toc-modified-id="18-3-6-2-Ignoring-Parts-of-a-Value-with-a-Nested-_-10.3.6.2">18-3-6-2 Ignoring Parts of a Value with a Nested <code>_</code></a></span></li><li><span><a href="#18-3-6-3-Ignoring-an-Unused-Variable-by-Starting-Its-Name-with-_" data-toc-modified-id="18-3-6-3-Ignoring-an-Unused-Variable-by-Starting-Its-Name-with-_-10.3.6.3">18-3-6-3 Ignoring an Unused Variable by Starting Its Name with <code>_</code></a></span></li><li><span><a href="#18-3-6-4-Ignoring-Remaining-Parts-of-a-Value-with-.." data-toc-modified-id="18-3-6-4-Ignoring-Remaining-Parts-of-a-Value-with-..-10.3.6.4">18-3-6-4 Ignoring Remaining Parts of a Value with <code>..</code></a></span></li></ul></li><li><span><a href="#18-3-7-Extra-Conditionals-with-Match-Guards" data-toc-modified-id="18-3-7-Extra-Conditionals-with-Match-Guards-10.3.7">18-3-7 Extra Conditionals with Match Guards</a></span></li><li><span><a href="#18-3-8-@-Bindings" data-toc-modified-id="18-3-8-@-Bindings-10.3.8">18-3-8 <code>@</code> Bindings</a></span></li></ul></li></ul></li></ul></div></p>
<h2 id="1-Getting-Started"><a href="#1-Getting-Started" class="headerlink" title="1 Getting Started"></a>1 Getting Started</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ cargo new proj</span><br><span class="line"></span><br><span class="line">// build</span><br><span class="line">$ cargo build //dev</span><br><span class="line">$ cargo check</span><br><span class="line">// build result</span><br><span class="line">$ ./target/debug/proj</span><br><span class="line">// build + run</span><br><span class="line">$ cargo run	</span><br><span class="line"></span><br><span class="line">$ cargo build --release  //prod</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="3-Common-Concepts"><a href="#3-Common-Concepts" class="headerlink" title="3 Common Concepts"></a>3 Common Concepts</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Raw identifiers</span></span><br><span class="line"><span class="keyword">let</span> r#<span class="function"><span class="keyword">fn</span> = "<span class="title">this</span> <span class="title">variable</span> <span class="title">is</span> <span class="title">named</span> '<span class="title">fn</span>' <span class="title">even</span> <span class="title">though</span> <span class="title">that</span>'<span class="title">s</span> <span class="title">a</span> <span class="title">keyword</span>";</span></span><br><span class="line"><span class="function">// <span class="title">call</span> <span class="title">a</span> <span class="title">function</span> <span class="title">named</span> '<span class="title">match</span>'</span></span><br><span class="line"><span class="function"><span class="title">r</span>#<span class="title">match</span></span>();</span><br></pre></td></tr></table></figure>
<h3 id="3-1-Variables-and-Mutability"><a href="#3-1-Variables-and-Mutability" class="headerlink" title="3-1 Variables and Mutability"></a>3-1 Variables and Mutability</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> x = <span class="number">5</span>; <span class="comment">// mutable</span></span><br><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>; <span class="comment">// imutable</span></span><br></pre></td></tr></table></figure>
<h4 id="3-1-1-Variables-and-Constants"><a href="#3-1-1-Variables-and-Constants" class="headerlink" title="3-1-1 Variables and Constants"></a>3-1-1 Variables and Constants</h4><ul>
<li><p><code>mut</code> is not allowed with constants (always immutable).</p>
</li>
<li><p>using the <code>const</code> keyword instead of  <code>let</code>, and the type of the value <em>must</em> be annotated.</p>
</li>
<li><p>Constants can be declared in any scope, including the global scope.</p>
</li>
<li>Constants may be set only to a constant expression, not the result of a function call or any other value that could only be computed at runtime.</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MAX_POINTS: <span class="keyword">u32</span> = <span class="number">100_000</span>; <span class="comment">// 100000</span></span><br></pre></td></tr></table></figure>
<p>Constants are valid for the entire time a program runs, within the scope they were declared in.</p>
<h4 id="3-1-2-Shadowing"><a href="#3-1-2-Shadowing" class="headerlink" title="3-1-2 Shadowing"></a>3-1-2 Shadowing</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> x = x + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> x = x * <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of x is: &#123;&#125;"</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The value of x is: 12</span></span><br></pre></td></tr></table></figure>
<p>By using <code>let</code>, we can perform a few transformations on a value but have the variable be immutable after those transformations have been completed.</p>
<p>The other difference between <code>mut</code> and shadowing is that because we’re effectively creating a new variable when we use the <code>let</code> keyword again, we can change the type of the value but reuse the same name.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> spaces = <span class="string">"   "</span>;</span><br><span class="line"><span class="keyword">let</span> spaces = spaces.len();</span><br><span class="line"></span><br><span class="line"><span class="comment">// compile-time error</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> spaces = <span class="string">"   "</span>;</span><br><span class="line">spaces = spaces.len();</span><br></pre></td></tr></table></figure>
<h3 id="3-2-Data-Types"><a href="#3-2-Data-Types" class="headerlink" title="3-2 Data Types"></a>3-2 Data Types</h3><p>Rust is a <em>statically typed</em> language, which means that it must know the types of all variables at compile time.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> guess: <span class="keyword">u32</span> = <span class="string">"42"</span>.parse().expect(<span class="string">"Not a number!"</span>);</span><br><span class="line"><span class="comment">// u32 is the type</span></span><br></pre></td></tr></table></figure>
<h4 id="3-2-1-Scalar"><a href="#3-2-1-Scalar" class="headerlink" title="3-2-1 Scalar"></a>3-2-1 Scalar</h4><p>A <em>scalar</em> type represents a single value. </p>
<h5 id="3-2-1-1-Integer"><a href="#3-2-1-1-Integer" class="headerlink" title="3-2-1-1 Integer"></a>3-2-1-1 Integer</h5><div class="table-container">
<table>
<thead>
<tr>
<th>Length</th>
<th>Signed</th>
<th>Unsigned</th>
</tr>
</thead>
<tbody>
<tr>
<td>8-bit</td>
<td><code>i8</code></td>
<td><code>u8</code></td>
</tr>
<tr>
<td>16-bit</td>
<td><code>i16</code></td>
<td><code>u16</code></td>
</tr>
<tr>
<td>32-bit</td>
<td><code>i32</code></td>
<td><code>u32</code></td>
</tr>
<tr>
<td>64-bit</td>
<td><code>i64</code></td>
<td><code>u64</code></td>
</tr>
<tr>
<td>128-bit</td>
<td><code>i128</code></td>
<td><code>u128</code></td>
</tr>
<tr>
<td>arch</td>
<td><code>isize</code></td>
<td><code>usize</code></td>
</tr>
</tbody>
</table>
</div>
<p>Each signed variant can store numbers from <code>-(2^{n - 1})</code> to <code>2^{n - 1} - 1</code> inclusive, where <em>n</em> is the number of bits that variant uses. Unsigned variants can store numbers from 0 to <code>2^{n - 1}</code>.</p>
<p>The <code>isize</code> and <code>usize</code> types depend on the kind of computer your program is running on.</p>
<h5 id="3-2-1-2-Numeric"><a href="#3-2-1-2-Numeric" class="headerlink" title="3-2-1-2 Numeric"></a>3-2-1-2 Numeric</h5><p>Can not operate two different types of nums.</p>
<h5 id="3-2-1-3-Boolean"><a href="#3-2-1-3-Boolean" class="headerlink" title="3-2-1-3 Boolean"></a>3-2-1-3 Boolean</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> t = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> f: <span class="keyword">bool</span> = <span class="literal">false</span>; <span class="comment">// with explicit type annotation</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-2-1-4-Character"><a href="#3-2-1-4-Character" class="headerlink" title="3-2-1-4 Character"></a>3-2-1-4 Character</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> c = <span class="string">'z'</span>; <span class="comment">// not " "</span></span><br><span class="line">    <span class="keyword">let</span> z = <span class="string">'ℤ'</span>;</span><br><span class="line">    <span class="keyword">let</span> heart_eyed_cat = '😻';</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Rust’s <code>char</code> type represents a Unicode Scalar Value. </p>
<h4 id="3-2-2-Compound-Types"><a href="#3-2-2-Compound-Types" class="headerlink" title="3-2-2 Compound Types"></a>3-2-2 Compound Types</h4><h5 id="3-2-2-1-Tuple"><a href="#3-2-2-1-Tuple" class="headerlink" title="3-2-2-1 Tuple"></a>3-2-2-1 Tuple</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> tup: (<span class="keyword">i32</span>, <span class="keyword">f64</span>, <span class="keyword">u8</span>) = (<span class="number">500</span>, <span class="number">6.4</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> (x, y, z) = tup;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of x y z is: &#123;&#125; &#123;&#125; &#123;&#125;"</span>, x, y, z);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> x: (<span class="keyword">i32</span>, <span class="keyword">f64</span>, <span class="keyword">u8</span>) = (<span class="number">500</span>, <span class="number">6.4</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> five_hundred = x.<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> six_point_four = x.<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> one = x.<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-2-2-2-Array"><a href="#3-2-2-2-Array" class="headerlink" title="3-2-2-2 Array"></a>3-2-2-2 Array</h5><p>Unlike a tuple, every element of an array must have the same type. Arrays have a <strong>fixed length</strong>, like tuples.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A vector is a similar collection type provided by the standard library that <em>is</em> allowed to grow or shrink in size. If not sure, use a vector. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a: [<span class="keyword">i32</span>; <span class="number">5</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">    <span class="keyword">let</span> first = a[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The first (i32) is the type of each element. Since all elements have the same type, just list it once. </p>
<p>After the semicolon, there’s a number that indicates the length of the array. </p>
<h3 id="3-3-Functions"><a href="#3-3-Functions" class="headerlink" title="3-3 Functions"></a>3-3 Functions</h3><h4 id="3-3-1-Parameters"><a href="#3-3-1-Parameters" class="headerlink" title="3-3-1 Parameters"></a>3-3-1 Parameters</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    another_function(<span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">another_function</span></span>(x: <span class="keyword">i32</span>, y: <span class="keyword">i32</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of x is: &#123;&#125;"</span>, x);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of y is: &#123;&#125;"</span>, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>must</em> declare the type of each parameter. </p>
<h4 id="3-3-2-Statements-and-Expressions"><a href="#3-3-2-Statements-and-Expressions" class="headerlink" title="3-3-2 Statements and Expressions"></a>3-3-2 Statements and Expressions</h4><p>Cannot write <code>x = y = 6</code> .</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> y = &#123;</span><br><span class="line">        <span class="keyword">let</span> x = <span class="number">3</span>;</span><br><span class="line">        x + <span class="number">1</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of y is: &#123;&#125;"</span>, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// y=4</span></span><br></pre></td></tr></table></figure>
<p>That value gets bound to <code>y</code> as part of the <code>let</code>statement. Note the <code>x + 1</code> line without <code>;</code> at the end. </p>
<p>Expressions do not include <code>;</code>. If added it’s a statement, which will then not return a value. </p>
<h4 id="3-3-3-Return-Values"><a href="#3-3-3-Return-Values" class="headerlink" title="3-3-3 Return Values"></a>3-3-3 Return Values</h4><p>Declare their type after an arrow (<code>-&gt;</code>). In Rust, the return value of the function is synonymous with the value of the final expression in the block of the body of a function. </p>
<p>You can return early from a function by using the <code>return</code> keyword and specifying a value, but most functions return the last expression implicitly.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">five</span></span>() -&gt; <span class="keyword">i32</span> &#123;</span><br><span class="line">    <span class="number">5</span> <span class="comment">// also can be written to: `return 5`, `return 5;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = five();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of x is: &#123;&#125;"</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-4-Control-Flow"><a href="#3-4-Control-Flow" class="headerlink" title="3-4 Control Flow"></a>3-4 Control Flow</h3><h4 id="3-4-1-if"><a href="#3-4-1-if" class="headerlink" title="3.4.1 if"></a>3.4.1 if</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">if</span> number % <span class="number">4</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"number is divisible by 4"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> number % <span class="number">3</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"number is divisible by 3"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"number is not divisible by 4 or 3"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The condition in this code <em>must</em> be a <code>bool</code>.</p>
<p>Rust only executes the block for the first true condition, and once it finds one, it doesn’t even check the rest.</p>
<p>Using too many <code>else if</code> expressions can clutter the code, so we use <code>match</code>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> condition = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="keyword">if</span> condition &#123;</span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="number">6</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The value of number is: &#123;&#125;"</span>, number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-4-2-Repetition"><a href="#3-4-2-Repetition" class="headerlink" title="3-4-2 Repetition"></a>3-4-2 Repetition</h4><h5 id="3-4-2-1-loop"><a href="#3-4-2-1-loop" class="headerlink" title="3-4-2-1 loop"></a>3-4-2-1 loop</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">loop</span> &#123;</span><br><span class="line">        counter += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> counter == <span class="number">10</span> &#123;</span><br><span class="line">            <span class="keyword">break</span> counter * <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(result, <span class="number">20</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-4-2-2-while"><a href="#3-4-2-2-while" class="headerlink" title="3-4-2-2 while"></a>3-4-2-2 while</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> number = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">while</span> number != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"&#123;&#125;!"</span>, number);</span><br><span class="line">        number = number - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"LIFTOFF!!!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-4-2-3-for"><a href="#3-4-2-3-for" class="headerlink" title="3-4-2-3 for"></a>3-4-2-3 for</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> index &lt; <span class="number">5</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"the value is: &#123;&#125;"</span>, a[index]);</span><br><span class="line">        index = index + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This approach is error prone; we could cause the program to panic if the index length is incorrect. It’s also slow, because the compiler adds runtime code to perform the conditional check on every element on every iteration through the loop.</p>
<p>As a more concise alternative, you can use a <code>for</code> loop and execute some code for each item in a collection. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> a.iter() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"the value is: &#123;&#125;"</span>, element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">for</span> number <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">4</span>).rev() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"&#123;&#125;!"</span>, number);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"LIFTOFF!!!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3!</span></span><br><span class="line"><span class="comment">// 2!</span></span><br><span class="line"><span class="comment">// 1!</span></span><br><span class="line"><span class="comment">// LIFTOFF!!!</span></span><br></pre></td></tr></table></figure>
<h2 id="4-Understanding-Ownership"><a href="#4-Understanding-Ownership" class="headerlink" title="4 Understanding Ownership"></a>4 Understanding Ownership</h2><h3 id="4-1-What-Is-Ownership"><a href="#4-1-What-Is-Ownership" class="headerlink" title="4-1 What Is Ownership?"></a>4-1 What Is Ownership?</h3><p>Rust uses a third approach: memory is managed through a system of ownership with a set of rules that the compiler checks at compile time. None of the ownership features slow down your program while it’s running.</p>
<blockquote>
<p>堆和栈：</p>
<ul>
<li>栈：速度快（最上面的那个），大小固定；函数调用。</li>
<li>堆：速度慢（指派空间，指针跳转）；减少堆上数据复制，及时清理未使用的数据。</li>
</ul>
</blockquote>
<h4 id="4-1-1-Ownership-Rules"><a href="#4-1-1-Ownership-Rules" class="headerlink" title="4-1-1 Ownership Rules"></a>4-1-1 Ownership Rules</h4><ul>
<li>Each value in Rust has a variable that’s called its <em>owner</em>.</li>
<li>There can only be one owner at a time.</li>
<li>When the owner goes out of scope, the value will be dropped.</li>
</ul>
<h4 id="4-1-2-Variable-Scope"><a href="#4-1-2-Variable-Scope" class="headerlink" title="4-1-2 Variable Scope"></a>4-1-2 Variable Scope</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;                      <span class="comment">// s is not valid here, it’s not yet declared</span></span><br><span class="line">    <span class="keyword">let</span> s = <span class="string">"hello"</span>;   <span class="comment">// s is valid from this point forward</span></span><br><span class="line">    <span class="comment">// do stuff with s</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-1-3-The-String-Type"><a href="#4-1-3-The-String-Type" class="headerlink" title="4-1-3 The String Type"></a>4-1-3 The String Type</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line">s.push_str(<span class="string">", world!"</span>); <span class="comment">// push_str() appends a literal to a String</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, s); <span class="comment">// `hello, world!`</span></span><br></pre></td></tr></table></figure>
<h4 id="4-1-4-Memory-and-Allocation"><a href="#4-1-4-Memory-and-Allocation" class="headerlink" title="4-1-4 Memory and Allocation"></a>4-1-4 Memory and Allocation</h4><p>With the <code>String</code> type, in order to support a mutable, growable piece of text, we need to allocate an amount of memory on the heap, unknown at compile time, to hold the contents. This means:</p>
<ul>
<li>The memory must be requested from the operating system at runtime: when we call <code>String::from</code>, its implementation requests the memory it needs.</li>
<li>Returning this memory to the operating system when we’re done with our <code>String</code>: the memory is automatically returned (use a function called <code>drop</code>) once the variable that owns it goes out of scope.</li>
</ul>
<h5 id="4-1-4-1-Move"><a href="#4-1-4-1-Move" class="headerlink" title="4-1-4-1 Move"></a>4-1-4-1 Move</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = s1;</span><br></pre></td></tr></table></figure>
<p>A <code>String</code> is made up of three parts: </p>
<ul>
<li>a pointer to the memory that holds the contents of the string</li>
<li>a length</li>
<li>a capacity. </li>
</ul>
<p>This group of data is stored on the stack. On the right is the memory on the heap that holds the contents.</p>
<p><img src="https://doc.rust-lang.org/book/img/trpl04-01.svg" alt="String in memory"></p>
<p>The length is how much memory, in bytes, the contents of the <code>String</code> is currently using. The capacity is the total amount of memory, in bytes, that the <code>String</code> has received from the operating system. </p>
<p>When we assign <code>s1</code> to <code>s2</code>, the <code>String</code> data is copied, meaning we copy the pointer, the length, and the capacity that are on the stack. We do not copy the data on the heap that the pointer refers to. </p>
<p>Both data pointers pointing to the same location. This is a problem: when <code>s2</code> and <code>s1</code> go out of scope, they will both try to free the same memory. This is known as a <em>double free</em> error and is one of the memory safety bugs. Freeing memory twice can lead to memory corruption, which can potentially lead to security vulnerabilities.</p>
<p>Instead of trying to copy the allocated memory, Rust let s1 invalid, so that we do not need to care s1 any more. That’s a bit like “shallow copy”, but in Rust we call it “move”.</p>
<p><img src="https://doc.rust-lang.org/book/img/trpl04-04.svg" alt="s1 moved to s2"></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = s1;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;, world!"</span>, s1); <span class="comment">// s1 is invalid</span></span><br><span class="line"><span class="comment">// error[E0382]: use of moved value: `s1`</span></span><br></pre></td></tr></table></figure>
<p>In addition, there’s a design choice that’s implied by this: Rust will <strong>never automatically create “deep” copies</strong> of your data. Therefore, any <em>automatic</em> copying can be assumed to be inexpensive in terms of runtime performance.</p>
<h5 id="4-1-4-2-Clone"><a href="#4-1-4-2-Clone" class="headerlink" title="4-1-4-2 Clone"></a>4-1-4-2 Clone</h5><p>If we <em>do</em> want to deeply copy the heap data of the <code>String</code>, not just the stack data, we can use a common method called <code>clone</code>. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = s1.clone();</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"s1 = &#123;&#125;, s2 = &#123;&#125;"</span>, s1, s2);</span><br></pre></td></tr></table></figure>
<h5 id="4-1-4-3-Copy"><a href="#4-1-4-3-Copy" class="headerlink" title="4-1-4-3 Copy"></a>4-1-4-3 Copy</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> y = x;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"x = &#123;&#125;, y = &#123;&#125;"</span>, x, y);</span><br></pre></td></tr></table></figure>
<p>Here, we don’t have a call to <code>clone</code>, but <code>x</code> is still valid and wasn’t moved into <code>y</code>.</p>
<p>The reason is that types such as integers that have a known size at compile time are stored entirely on the stack, so copies of the actual values are quick to make. There’s no difference between deep and shallow copying here, so calling <code>clone</code> wouldn’t do anything different from the usual shallow copying and we can leave it out.</p>
<p>As a general rule, any group of simple scalar values can be <code>Copy</code>, and nothing that requires allocation or is some form of resource is <code>Copy</code>. </p>
<ul>
<li>All the integer types, such as <code>u32</code>.</li>
<li>The Boolean type, <code>bool</code>, with values <code>true</code> and <code>false</code>.</li>
<li>All the floating point types, such as <code>f64</code>.</li>
<li>The character type, <code>char</code>.</li>
<li>Tuples, if they only contain types that are also <code>Copy</code>. For example, <code>(i32, i32)</code> is <code>Copy</code>, but <code>(i32, String)</code> is not.</li>
</ul>
<h4 id="4-1-5-Ownership-and-Functions"><a href="#4-1-5-Ownership-and-Functions" class="headerlink" title="4-1-5 Ownership and Functions"></a>4-1-5 Ownership and Functions</h4><p>The semantics for passing a value to a function are similar to those for assigning a value to a variable. Passing a variable to a function will move or copy, just as assignment does.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);  <span class="comment">// s comes into scope</span></span><br><span class="line">    takes_ownership(s);             <span class="comment">// s's value moves into the function...</span></span><br><span class="line">                                    <span class="comment">// ... and so is no longer valid here</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;                      <span class="comment">// x comes into scope</span></span><br><span class="line">    makes_copy(x);                  <span class="comment">// x would move into the function,</span></span><br><span class="line">                                    <span class="comment">// but i32 is Copy, so it’s okay to still</span></span><br><span class="line">                                    <span class="comment">// use x afterward</span></span><br><span class="line">&#125; <span class="comment">// Here, x goes out of scope, then s. But because s's value was moved, nothing</span></span><br><span class="line">  <span class="comment">// special happens.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">takes_ownership</span></span>(some_string: <span class="built_in">String</span>) &#123; <span class="comment">// some_string comes into scope</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, some_string);</span><br><span class="line">&#125; <span class="comment">// Here, some_string goes out of scope and `drop` is called. The backing</span></span><br><span class="line">  <span class="comment">// memory is freed.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">makes_copy</span></span>(some_integer: <span class="keyword">i32</span>) &#123; <span class="comment">// some_integer comes into scope</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, some_integer);</span><br><span class="line">&#125; <span class="comment">// Here, some_integer goes out of scope. Nothing special happens.</span></span><br></pre></td></tr></table></figure>
<h4 id="4-1-6-Return-Values-and-Scope"><a href="#4-1-6-Return-Values-and-Scope" class="headerlink" title="4-1-6 Return Values and Scope"></a>4-1-6 Return Values and Scope</h4><p>Returning values can also transfer ownership.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s1 = gives_ownership();         <span class="comment">// gives_ownership moves its return</span></span><br><span class="line">                                        <span class="comment">// value into s1</span></span><br><span class="line">    <span class="keyword">let</span> s2 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);     <span class="comment">// s2 comes into scope</span></span><br><span class="line">    <span class="keyword">let</span> s3 = takes_and_gives_back(s2);  <span class="comment">// s2 is moved into</span></span><br><span class="line">                                        <span class="comment">// takes_and_gives_back, which also</span></span><br><span class="line">                                        <span class="comment">// moves its return value into s3</span></span><br><span class="line">&#125; <span class="comment">// Here, s3 goes out of scope and is dropped. s2 goes out of scope but was</span></span><br><span class="line">  <span class="comment">// moved, so nothing happens. s1 goes out of scope and is dropped.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">gives_ownership</span></span>() -&gt; <span class="built_in">String</span> &#123;             <span class="comment">// gives_ownership will move its</span></span><br><span class="line">                                             <span class="comment">// return value into the function</span></span><br><span class="line">                                             <span class="comment">// that calls it</span></span><br><span class="line">    <span class="keyword">let</span> some_string = <span class="built_in">String</span>::from(<span class="string">"hello"</span>); <span class="comment">// some_string comes into scope</span></span><br><span class="line">    some_string                              <span class="comment">// some_string is returned and</span></span><br><span class="line">                                             <span class="comment">// moves out to the calling function</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// takes_and_gives_back will take a String and return one</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">takes_and_gives_back</span></span>(a_string: <span class="built_in">String</span>) -&gt; <span class="built_in">String</span> &#123; <span class="comment">// a_string comes into</span></span><br><span class="line">                                                      <span class="comment">// scope</span></span><br><span class="line">    a_string  <span class="comment">// a_string is returned and moves out to the calling function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It’s possible to return multiple values using a tuple.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line">    <span class="keyword">let</span> (s2, len) = calculate_length(s1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The length of '&#123;&#125;' is &#123;&#125;."</span>, s2, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">calculate_length</span></span>(s: <span class="built_in">String</span>) -&gt; (<span class="built_in">String</span>, <span class="keyword">usize</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> length = s.len(); <span class="comment">// len() returns the length of a String</span></span><br><span class="line">    (s, length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>But this is too much ceremony and a lot of work for a concept that should be common. Luckily for us, Rust has a feature for this concept, called <em>references</em>.</p>
<h3 id="4-2-References-and-Borrowing"><a href="#4-2-References-and-Borrowing" class="headerlink" title="4-2 References and Borrowing"></a>4-2 References and Borrowing</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line">    <span class="keyword">let</span> len = calculate_length(&amp;s1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The length of '&#123;&#125;' is &#123;&#125;."</span>, s1, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">calculate_length</span></span>(s: &amp;<span class="built_in">String</span>) -&gt; <span class="keyword">usize</span> &#123; <span class="comment">// s is a reference to a String</span></span><br><span class="line">    s.len()</span><br><span class="line">&#125; <span class="comment">// Here, s goes out of scope. But because it does not have ownership of what</span></span><br><span class="line">  <span class="comment">// it refers to, nothing happens.</span></span><br></pre></td></tr></table></figure>
<p>First, notice that all the tuple code in the variable declaration and the function return value is gone. Second, note that we pass <code>&amp;s1</code> into <code>calculate_length</code> and, in its definition, we take <code>&amp;String</code>rather than <code>String</code>. These ampersands are <em>references</em>, and they allow you to refer to some value without taking ownership of it.</p>
<p><img src="https://doc.rust-lang.org/book/img/trpl04-05.svg" alt="&amp;String s pointing at String s1"></p>
<p>The <code>&amp;s1</code> syntax lets us create a reference that <em>refers</em> to the value of <code>s1</code> but does not own it. We call having references as function parameters <em>borrowing</em>. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line">    change(&amp;s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">change</span></span>(some_string: &amp;<span class="built_in">String</span>) &#123;</span><br><span class="line">    some_string.push_str(<span class="string">", world"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// error[E0596]: cannot borrow immutable borrowed content `*some_string` as mutable</span></span><br></pre></td></tr></table></figure>
<p><strong>Just as variables are immutable by default, so are references</strong>. We’re not allowed to modify something we have a reference to.</p>
<h4 id="4-2-1-Mutable-References"><a href="#4-2-1-Mutable-References" class="headerlink" title="4-2-1 Mutable References"></a>4-2-1 Mutable References</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line">    change(&amp;<span class="keyword">mut</span> s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">change</span></span>(some_string: &amp;<span class="keyword">mut</span> <span class="built_in">String</span>) &#123;</span><br><span class="line">    some_string.push_str(<span class="string">", world"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>First, we had to change <code>s</code> to be <code>mut</code>. Then we had to create a mutable reference with <code>&amp;mut s</code> and accept a mutable reference with <code>some_string: &amp;mut String</code>.</p>
<p>But mutable references have one big restriction: <strong>you can have only one mutable reference to a particular piece of data in a particular scope</strong>. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r1 = &amp;<span class="keyword">mut</span> s;</span><br><span class="line"><span class="keyword">let</span> r2 = &amp;<span class="keyword">mut</span> s;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;, &#123;&#125;"</span>, r1, r2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// error[E0499]: cannot borrow `s` as mutable more than once at a time</span></span><br></pre></td></tr></table></figure>
<p>The benefit of having this restriction is that Rust can prevent data races at compile time. A <em>data race</em>is similar to a race condition and happens when these three behaviors occur:</p>
<ul>
<li>Two or more pointers access the same data at the same time.</li>
<li>At least one of the pointers is being used to write to the data.</li>
<li>There’s no mechanism being used to synchronize access to the data.</li>
</ul>
<p>Data races cause undefined behavior and can be difficult to diagnose and fix when you’re trying to track them down at runtime; Rust prevents this problem from happening because it won’t even compile code with data races!</p>
<p>As always, we can use curly brackets to create a new scope, allowing for multiple mutable references, just not <em>simultaneous</em> ones:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> r1 = &amp;<span class="keyword">mut</span> s;</span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// r1 goes out of scope here, so we can make a new reference with no problems.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r2 = &amp;<span class="keyword">mut</span> s;</span><br></pre></td></tr></table></figure>
<p>A similar rule exists for combining mutable and immutable references. This code results in an error:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r1 = &amp;s; <span class="comment">// no problem</span></span><br><span class="line"><span class="keyword">let</span> r2 = &amp;s; <span class="comment">// no problem</span></span><br><span class="line"><span class="keyword">let</span> r3 = &amp;<span class="keyword">mut</span> s; <span class="comment">// BIG PROBLEM</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;&#125;, &#123;&#125;, and &#123;&#125;"</span>, r1, r2, r3);</span><br><span class="line"></span><br><span class="line"><span class="comment">// error[E0502]: cannot borrow `s` as mutable because it is also borrowed as immutable</span></span><br></pre></td></tr></table></figure>
<p>We <em>also</em> cannot have a mutable reference while we have an immutable one. However, multiple immutable references are okay because no one who is just reading the data has the ability to affect anyone else’s reading of the data.</p>
<h4 id="4-2-2-Dangling-References"><a href="#4-2-2-Dangling-References" class="headerlink" title="4-2-2 Dangling References"></a>4-2-2 Dangling References</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> reference_to_nothing = dangle();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">dangle</span></span>() -&gt; &amp;<span class="built_in">String</span> &#123; <span class="comment">// dangle returns a reference to a String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello"</span>); <span class="comment">// s is a new String</span></span><br><span class="line"></span><br><span class="line">    &amp;s <span class="comment">// we return a reference to the String, s</span></span><br><span class="line">&#125; <span class="comment">// Here, s goes out of scope, and is dropped. Its memory goes away.</span></span><br><span class="line">  <span class="comment">// Danger!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// this function's return type contains a borrowed value, but there is no value</span></span><br><span class="line"><span class="comment">// for it to be borrowed from.</span></span><br></pre></td></tr></table></figure>
<p>Because <code>s</code> is created inside <code>dangle</code>, when the code of <code>dangle</code> is finished, <code>s</code> will be deallocated. But we tried to return a reference to it. That means this reference would be pointing to an invalid <code>String</code>. </p>
<h3 id="4-3-The-Slice-Type"><a href="#4-3-The-Slice-Type" class="headerlink" title="4-3 The Slice Type"></a>4-3 The Slice Type</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">first_word</span></span>(s: &amp;<span class="built_in">String</span>) -&gt; <span class="keyword">usize</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bytes = s.as_bytes();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i, &amp;item) <span class="keyword">in</span> bytes.iter().enumerate() &#123;</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">b' '</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    s.len()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello world"</span>);</span><br><span class="line">    <span class="keyword">let</span> word = first_word(&amp;s); <span class="comment">// word will get the value 5</span></span><br><span class="line">    s.clear(); <span class="comment">// this empties the String, making it equal to ""</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// word still has the value 5 here, but there's no more string that</span></span><br><span class="line">    <span class="comment">// we could meaningfully use the value 5 with. word is now totally invalid!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-3-1-String-Slices"><a href="#4-3-1-String-Slices" class="headerlink" title="4-3-1 String Slices"></a>4-3-1 String Slices</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"hello world"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> hello = &amp;s[<span class="number">0</span>..<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> world = &amp;s[<span class="number">6</span>..<span class="number">11</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">let</span> hello = &amp;s[<span class="number">0</span>..=<span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> world = &amp;s[<span class="number">6</span>..=<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">let</span> hello = &amp;s[..<span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> world = &amp;s[<span class="number">6</span>..];</span><br><span class="line"></span><br><span class="line"><span class="comment">// One Chinese Character placeholder is 3</span></span><br></pre></td></tr></table></figure>
<p>The type that signifies “string slice” is written as <code>&amp;str</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">first_word</span></span>(s: &amp;<span class="built_in">String</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bytes = s.as_bytes();</span><br><span class="line">    <span class="keyword">for</span> (i, &amp;item) <span class="keyword">in</span> bytes.iter().enumerate() &#123;</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">b' '</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &amp;s[<span class="number">0</span>..i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;s[..]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello world"</span>);</span><br><span class="line">    <span class="keyword">let</span> word = first_word(&amp;s); <span class="comment">// immutable</span></span><br><span class="line">    s.clear(); <span class="comment">// error!, mutable</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"the first word is: &#123;&#125;"</span>, word);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// cannot borrow `s` as mutable because it is also borrowed as immutable</span></span><br></pre></td></tr></table></figure>
<p>Recall from the borrowing rules that if we have an immutable reference to something, we cannot also take a mutable reference. Because <code>clear</code> needs to truncate the <code>String</code>, it tries to take a mutable reference, which fails. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">first_word</span></span>(s: &amp;<span class="keyword">mut</span> <span class="built_in">String</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bytes = s.as_bytes();</span><br><span class="line">    <span class="keyword">for</span> (i, &amp;item) <span class="keyword">in</span> bytes.iter().enumerate() &#123;</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">b' '</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &amp;s[<span class="number">0</span>..i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;s[..]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"hello world"</span>);</span><br><span class="line">    <span class="keyword">let</span> word = first_word(&amp;<span class="keyword">mut</span> s); <span class="comment">// mutable</span></span><br><span class="line">    s.clear(); <span class="comment">// error!, mutable twice</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"the first word is: &#123;&#125;"</span>, word);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  cannot borrow `s` as mutable more than once at a time</span></span><br></pre></td></tr></table></figure>
<h5 id="4-3-1-1-String-Literals-Are-Slices"><a href="#4-3-1-1-String-Literals-Are-Slices" class="headerlink" title="4-3-1-1 String Literals Are Slices"></a>4-3-1-1 String Literals Are Slices</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">"Hello, world!"</span>;</span><br></pre></td></tr></table></figure>
<p>The type of <code>s</code> here is <code>&amp;str</code>: it’s a slice pointing to that specific point of the binary. This is also why string literals are immutable; <code>&amp;str</code> is an immutable reference.</p>
<h5 id="4-3-1-2-String-Slices-as-Parameters"><a href="#4-3-1-2-String-Slices-as-Parameters" class="headerlink" title="4-3-1-2 String Slices as Parameters"></a>4-3-1-2 String Slices as Parameters</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">first_word</span></span>(s: &amp;<span class="keyword">str</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bytes = s.as_bytes();</span><br><span class="line">    <span class="keyword">for</span> (i, &amp;item) <span class="keyword">in</span> bytes.iter().enumerate() &#123;</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">b' '</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &amp;s[<span class="number">0</span>..i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;s[..]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> my_string = <span class="built_in">String</span>::from(<span class="string">"hello world"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// first_word works on slices of `String`s</span></span><br><span class="line">    <span class="keyword">let</span> word = first_word(&amp;my_string[..]);</span><br><span class="line">    <span class="keyword">let</span> my_string_literal = <span class="string">"hello world"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// first_word works on slices of string literals</span></span><br><span class="line">    <span class="keyword">let</span> word = first_word(&amp;my_string_literal[..]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Because string literals *are* string slices already,</span></span><br><span class="line">    <span class="comment">// this works too, without the slice syntax!</span></span><br><span class="line">    <span class="comment">// see String Literals Are Slices</span></span><br><span class="line">    <span class="keyword">let</span> word = first_word(my_string_literal);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-3-2-Other-Slices"><a href="#4-3-2-Other-Slices" class="headerlink" title="4-3-2 Other Slices"></a>4-3-2 Other Slices</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> slice = &amp;a[<span class="number">1</span>..<span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<p>This slice has the type <code>&amp;[i32]</code>. It works the same way as string slices do, by storing a reference to the first element and a length. </p>
<h2 id="5-Using-Structs-to-Structure-Related-Data"><a href="#5-Using-Structs-to-Structure-Related-Data" class="headerlink" title="5 Using Structs to Structure Related Data"></a>5 Using Structs to Structure Related Data</h2><h3 id="5-1-Defining-and-Instantiating-Structs"><a href="#5-1-Defining-and-Instantiating-Structs" class="headerlink" title="5-1 Defining and Instantiating Structs"></a>5-1 Defining and Instantiating Structs</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">User</span></span> &#123;</span><br><span class="line">    username: <span class="built_in">String</span>,</span><br><span class="line">    email: <span class="built_in">String</span>,</span><br><span class="line">    sign_in_count: <span class="keyword">u64</span>,</span><br><span class="line">    active: <span class="keyword">bool</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// create an instance of the User struct, just like struct in C</span></span><br><span class="line"><span class="keyword">let</span> user1 = User &#123;</span><br><span class="line">    email: <span class="built_in">String</span>::from(<span class="string">"someone@example.com"</span>),</span><br><span class="line">    username: <span class="built_in">String</span>::from(<span class="string">"someusername123"</span>),</span><br><span class="line">    active: <span class="literal">true</span>,</span><br><span class="line">    sign_in_count: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// mutable</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> user1 = User &#123;</span><br><span class="line">    email: <span class="built_in">String</span>::from(<span class="string">"someone@example.com"</span>),</span><br><span class="line">    username: <span class="built_in">String</span>::from(<span class="string">"someusername123"</span>),</span><br><span class="line">    active: <span class="literal">true</span>,</span><br><span class="line">    sign_in_count: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line">user1.email = <span class="built_in">String</span>::from(<span class="string">"anotheremail@example.com"</span>);</span><br></pre></td></tr></table></figure>
<p>Note that <strong>the entire instance must be mutable</strong>; Rust doesn’t allow us to mark only certain fields as mutable. As with any expression, we can construct a new instance of the struct as the last expression in the function body to implicitly return that new instance.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">build_user</span></span>(email: <span class="built_in">String</span>, username: <span class="built_in">String</span>) -&gt; User &#123;</span><br><span class="line">    User &#123;</span><br><span class="line">        email: email,</span><br><span class="line">        username: username,</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-1-1-Using-the-Field-Init-Shorthand-When-Variables-and-Fields-Have-the-Same-Name"><a href="#5-1-1-Using-the-Field-Init-Shorthand-When-Variables-and-Fields-Have-the-Same-Name" class="headerlink" title="5-1-1 Using the Field Init Shorthand When Variables and Fields Have the Same Name"></a>5-1-1 Using the Field Init Shorthand When Variables and Fields Have the Same Name</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">build_user</span></span>(email: <span class="built_in">String</span>, username: <span class="built_in">String</span>) -&gt; User &#123;</span><br><span class="line">    User &#123;</span><br><span class="line">        email,</span><br><span class="line">        username,</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-1-2-Creating-Instances-From-Other-Instances-With-Struct-Update-Syntax"><a href="#5-1-2-Creating-Instances-From-Other-Instances-With-Struct-Update-Syntax" class="headerlink" title="5-1-2 Creating Instances From Other Instances With Struct Update Syntax"></a>5-1-2 Creating Instances From Other Instances With Struct Update Syntax</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> user2 = User &#123;</span><br><span class="line">    email: <span class="built_in">String</span>::from(<span class="string">"another@example.com"</span>),</span><br><span class="line">    username: <span class="built_in">String</span>::from(<span class="string">"anotherusername567"</span>),</span><br><span class="line">    active: user1.active,</span><br><span class="line">    sign_in_count: user1.sign_in_count,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> user2 = User &#123;</span><br><span class="line">    email: <span class="built_in">String</span>::from(<span class="string">"another@example.com"</span>),</span><br><span class="line">    username: <span class="built_in">String</span>::from(<span class="string">"anotherusername567"</span>),</span><br><span class="line">    ..user1</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>The syntax <code>..</code> specifies that the remaining fields not explicitly set should have the same value as the fields in the given instance.</p>
<h4 id="5-1-3-Using-Tuple-Structs-without-Named-Fields-to-Create-Different-Types"><a href="#5-1-3-Using-Tuple-Structs-without-Named-Fields-to-Create-Different-Types" class="headerlink" title="5-1-3 Using Tuple Structs without Named Fields to Create Different Types"></a>5-1-3 Using Tuple Structs without Named Fields to Create Different Types</h4><p>Structs that look similar to tuples, called <em>tuple structs</em>. </p>
<p><code>typedef int myint;</code> to define a meaningful data type.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Color</span></span>(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> black = Color(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">let</span> origin = Point(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>Each struct you define is its own type, even though the fields within the struct have the same types. Otherwise, tuple struct instances behave like tuples: you can destructure them into their individual pieces, you can use a <code>.</code>followed by the index to access an individual value, and so on.</p>
<h4 id="5-1-4-Unit-Like-Structs-Without-Any-Fields"><a href="#5-1-4-Unit-Like-Structs-Without-Any-Fields" class="headerlink" title="5-1-4 Unit-Like Structs Without Any Fields"></a>5-1-4 Unit-Like Structs Without Any Fields</h4><p>Unit-like structs can be useful in situations in which you need to implement a trait on some type but don’t have any data that you want to store in the type itself. </p>
<h4 id="5-1-5-Ownership-of-Struct-Data"><a href="#5-1-5-Ownership-of-Struct-Data" class="headerlink" title="5-1-5 Ownership of Struct Data"></a>5-1-5 Ownership of Struct Data</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">User</span></span> &#123;</span><br><span class="line">    username: &amp;<span class="keyword">str</span>,</span><br><span class="line">    email: &amp;<span class="keyword">str</span>,</span><br><span class="line">    sign_in_count: <span class="keyword">u64</span>,</span><br><span class="line">    active: <span class="keyword">bool</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> user1 = User &#123;</span><br><span class="line">        email: <span class="string">"someone@example.com"</span>,</span><br><span class="line">        username: <span class="string">"someusername123"</span>,</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// error[E0106]: missing lifetime specifier</span></span><br><span class="line"><span class="comment">// fix errors using owned types like String instead of references like &amp;str.</span></span><br></pre></td></tr></table></figure>
<h3 id="5-2-An-Example-Program-Using-Structs"><a href="#5-2-An-Example-Program-Using-Structs" class="headerlink" title="5-2 An Example Program Using Structs"></a>5-2 An Example Program Using Structs</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> width1 = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">let</span> height1 = <span class="number">50</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The area of the rectangle is &#123;&#125; square pixels."</span>, area(width1, height1));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">area</span></span>(width: <span class="keyword">u32</span>, height: <span class="keyword">u32</span>) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">    width * height</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-2-1-Refactoring-with-Tuples"><a href="#5-2-1-Refactoring-with-Tuples" class="headerlink" title="5-2-1 Refactoring with Tuples"></a>5-2-1 Refactoring with Tuples</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> rect1 = (<span class="number">30</span>, <span class="number">50</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The area of the rectangle is &#123;&#125; square pixels."</span>, area(rect1));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">area</span></span>(dimensions: (<span class="keyword">u32</span>, <span class="keyword">u32</span>)) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">    dimensions.<span class="number">0</span> * dimensions.<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-2-2-Refactoring-with-Structs-Adding-More-Meaning"><a href="#5-2-2-Refactoring-with-Structs-Adding-More-Meaning" class="headerlink" title="5-2-2 Refactoring with Structs Adding More Meaning"></a>5-2-2 Refactoring with Structs Adding More Meaning</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rectangle</span></span> &#123;</span><br><span class="line">    width: <span class="keyword">u32</span>,</span><br><span class="line">    height: <span class="keyword">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> rect1 = Rectangle &#123; width: <span class="number">30</span>, height: <span class="number">50</span> &#125;;</span><br><span class="line">	<span class="comment">// borrow the struct rather than take ownership. </span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The area of the rectangle is &#123;&#125; square pixels."</span>, area(&amp;rect1));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">area</span></span>(rectangle: &amp;Rectangle) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">    rectangle.width * rectangle.height</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-2-3-Adding-Useful-Functionality-with-Derived-Traits"><a href="#5-2-3-Adding-Useful-Functionality-with-Derived-Traits" class="headerlink" title="5-2-3 Adding Useful Functionality with Derived Traits"></a>5-2-3 Adding Useful Functionality with Derived Traits</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rectangle</span></span> &#123;</span><br><span class="line">    width: <span class="keyword">u32</span>,</span><br><span class="line">    height: <span class="keyword">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> rect1 = Rectangle &#123; width: <span class="number">30</span>, height: <span class="number">50</span> &#125;;</span><br><span class="line">    <span class="comment">// error: `Rectangle` cannot be formatted with the default formatter</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"rect1 is &#123;&#125;"</span>, rect1); </span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"rect1 is &#123;:?&#125;"</span>, rect1);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"rect1 is &#123;:#?&#125;"</span>, rect1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-3-Method-Syntax"><a href="#5-3-Method-Syntax" class="headerlink" title="5-3 Method Syntax"></a>5-3 Method Syntax</h3><p>Methods are different from functions in that they’re defined within the context of a struct (or an enum or a trait object), and their first parameter is always <code>self</code>, which represents the instance of the struct the method is being called on.</p>
<h4 id="5-3-1-Defining-Methods"><a href="#5-3-1-Defining-Methods" class="headerlink" title="5-3-1 Defining Methods"></a>5-3-1 Defining Methods</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rectangle</span></span> &#123;</span><br><span class="line">    width: <span class="keyword">u32</span>,</span><br><span class="line">    height: <span class="keyword">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Rectangle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">area</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> rect1 = Rectangle &#123; width: <span class="number">30</span>, height: <span class="number">50</span> &#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The area of the rectangle is &#123;&#125; square pixels."</span>, rect1.area());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Rust knows the type of <code>self</code> is <code>Rectangle</code> due to this method’s being inside the <code>impl Rectangle</code> context. Methods can take ownership of <code>self</code>, borrow <code>self</code> immutably as we’ve done here, or borrow <code>self</code> mutably, just as they can any other parameter.</p>
<p>We’ve chosen <code>&amp;self</code> here for the same reason we used <code>&amp;Rectangle</code> in the function version: we don’t want to take ownership, and we just want to read the data in the struct, not write to it. If we wanted to change the instance that we’ve called the method on as part of what the method does, we’d use <code>&amp;mut self</code> as the first parameter. </p>
<h4 id="5-3-2-Methods-with-More-Parameters"><a href="#5-3-2-Methods-with-More-Parameters" class="headerlink" title="5-3-2 Methods with More Parameters"></a>5-3-2 Methods with More Parameters</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Rectangle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">area</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">can_hold</span></span>(&amp;<span class="keyword">self</span>, other: &amp;Rectangle) -&gt; <span class="keyword">bool</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width &gt; other.width &amp;&amp; <span class="keyword">self</span>.height &gt; other.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-3-3-Associated-Functions"><a href="#5-3-3-Associated-Functions" class="headerlink" title="5-3-3 Associated Functions"></a>5-3-3 Associated Functions</h4><p>Another useful feature of <code>impl</code> blocks is that we’re allowed to define functions within <code>impl</code> blocks that <em>don’t</em> take <code>self</code> as a parameter. These are called <em>associated functions</em> because they’re associated with the struct. They’re still functions, not methods, because they don’t have an instance of the struct to work with. You’ve already used the <code>String::from</code> associated function. </p>
<p><strong>Associated functions are often used for constructors that will return a new instance of the struct</strong>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Rectangle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">square</span></span>(size: <span class="keyword">u32</span>) -&gt; Rectangle &#123;</span><br><span class="line">        Rectangle &#123; width: size, height: size &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> sq = Rectangle::square(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<h4 id="5-3-4-Multiple-impl-Blocks"><a href="#5-3-4-Multiple-impl-Blocks" class="headerlink" title="5-3-4 Multiple impl Blocks"></a>5-3-4 Multiple impl Blocks</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// just like</span></span><br><span class="line"><span class="keyword">impl</span> Rectangle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">area</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Rectangle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">can_hold</span></span>(&amp;<span class="keyword">self</span>, other: &amp;Rectangle) -&gt; <span class="keyword">bool</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width &gt; other.width &amp;&amp; <span class="keyword">self</span>.height &gt; other.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-Enums-and-Pattern-Matching"><a href="#6-Enums-and-Pattern-Matching" class="headerlink" title="6 Enums and Pattern Matching"></a>6 Enums and Pattern Matching</h2><h3 id="6-1-Defining-an-Enum"><a href="#6-1-Defining-an-Enum" class="headerlink" title="6-1 Defining an Enum"></a>6-1 Defining an Enum</h3><p>That property of IP addresses makes the enum data structure appropriate, because enum values can only be <strong>one</strong> of the variants.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IpAddrKind</span></span> &#123;</span><br><span class="line">    V4,</span><br><span class="line">    V6,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-1-1-Enum-Values"><a href="#6-1-1-Enum-Values" class="headerlink" title="6-1-1 Enum Values"></a>6-1-1 Enum Values</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> four = IpAddrKind::V4;</span><br><span class="line"><span class="keyword">let</span> six = IpAddrKind::V6;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IpAddr</span></span> &#123;</span><br><span class="line">    kind: IpAddrKind,</span><br><span class="line">    address: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> home = IpAddr &#123;</span><br><span class="line">    kind: IpAddrKind::V4,</span><br><span class="line">    address: <span class="built_in">String</span>::from(<span class="string">"127.0.0.1"</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> loopback = IpAddr &#123;</span><br><span class="line">    kind: IpAddrKind::V6,</span><br><span class="line">    address: <span class="built_in">String</span>::from(<span class="string">"::1"</span>),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IpAddr</span></span> &#123;</span><br><span class="line">    V4(<span class="built_in">String</span>),</span><br><span class="line">    V6(<span class="built_in">String</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> home = IpAddr::V4(<span class="built_in">String</span>::from(<span class="string">"127.0.0.1"</span>));</span><br><span class="line"><span class="keyword">let</span> loopback = IpAddr::V6(<span class="built_in">String</span>::from(<span class="string">"::1"</span>));</span><br></pre></td></tr></table></figure>
<p>There’s another advantage to using an enum rather than a struct: <strong>each variant can have different types and amounts of associated data.</strong> </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IpAddr</span></span> &#123;</span><br><span class="line">    V4(<span class="keyword">u8</span>, <span class="keyword">u8</span>, <span class="keyword">u8</span>, <span class="keyword">u8</span>),</span><br><span class="line">    V6(<span class="built_in">String</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> home = IpAddr::V4(<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> loopback = IpAddr::V6(<span class="built_in">String</span>::from(<span class="string">"::1"</span>));</span><br></pre></td></tr></table></figure>
<p>This code illustrates that you can put any kind of data inside an enum variant: strings, numeric types, or structs, for example. You can even include another enum! </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ipv4Addr</span></span> &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ipv6Addr</span></span> &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IpAddr</span></span> &#123;</span><br><span class="line">    V4(Ipv4Addr),</span><br><span class="line">    V6(Ipv6Addr),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span> &#123;</span><br><span class="line">    Quit,</span><br><span class="line">    Move &#123; x: <span class="keyword">i32</span>, y: <span class="keyword">i32</span> &#125;,</span><br><span class="line">    Write(<span class="built_in">String</span>),</span><br><span class="line">    ChangeColor(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QuitMessage</span></span>; <span class="comment">// unit struct</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MoveMessage</span></span> &#123;</span><br><span class="line">    x: <span class="keyword">i32</span>,</span><br><span class="line">    y: <span class="keyword">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">WriteMessage</span></span>(<span class="built_in">String</span>); <span class="comment">// tuple struct</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ChangeColorMessage</span></span>(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>); <span class="comment">// tuple struct</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Message &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">call</span></span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// method body would be defined here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> m = Message::Write(<span class="built_in">String</span>::from(<span class="string">"hello"</span>));</span><br><span class="line">m.call();</span><br></pre></td></tr></table></figure>
<h4 id="6-1-2-The-Option-Enum-and-Its-Advantages-Over-Null-Vlues"><a href="#6-1-2-The-Option-Enum-and-Its-Advantages-Over-Null-Vlues" class="headerlink" title="6-1-2 The Option Enum and Its Advantages Over Null Vlues"></a>6-1-2 The Option Enum and Its Advantages Over Null Vlues</h4><p>The problem isn’t really with the concept but with the particular implementation. As such, Rust does not have nulls, but it does have an enum that can encode the concept of a value being present or absent. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option</span></span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="literal">Some</span>(T),</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> some_number = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> some_string = <span class="literal">Some</span>(<span class="string">"a string"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> absent_number: <span class="built_in">Option</span>&lt;<span class="keyword">i32</span>&gt; = <span class="literal">None</span>;</span><br></pre></td></tr></table></figure>
<p>If we use <code>None</code> rather than <code>Some</code>, we need to tell Rust what type of <code>Option&lt;T&gt;</code> we have, because the compiler can’t infer the type that the <code>Some</code> variant will hold by looking only at a <code>None</code> value.</p>
<p>So why is having <code>Option&lt;T&gt;</code> any better than having null? In short, because <code>Option&lt;T&gt;</code> and <code>T</code> (where <code>T</code> can be any type) are different types, the compiler won’t let us use an <code>Option&lt;T&gt;</code> value as if it were definitely a valid value. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x: <span class="keyword">i8</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> y: <span class="built_in">Option</span>&lt;<span class="keyword">i8</span>&gt; = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="comment">// i8 and Option&lt;i8&gt; are different types</span></span><br><span class="line"><span class="keyword">let</span> sum = x + y;</span><br><span class="line"><span class="comment">// error[E0277]: the trait bound `i8: std::ops::Add&lt;std::option::Option&lt;i8&gt;&gt;` is not satisfied</span></span><br></pre></td></tr></table></figure>
<h3 id="6-2-The-match-Control-Flow-Operator"><a href="#6-2-The-match-Control-Flow-Operator" class="headerlink" title="6-2 The match Control Flow Operator"></a>6-2 The match Control Flow Operator</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Coin</span></span> &#123;</span><br><span class="line">    Penny,</span><br><span class="line">    Nickel,</span><br><span class="line">    Dime,</span><br><span class="line">    Quarter,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">value_in_cents</span></span>(coin: Coin) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">    <span class="keyword">match</span> coin &#123;</span><br><span class="line">        Coin::Penny =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Lucky penny!"</span>);</span><br><span class="line">            <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        Coin::Nickel =&gt; <span class="number">5</span>,</span><br><span class="line">        Coin::Dime =&gt; <span class="number">10</span>,</span><br><span class="line">        Coin::Quarter =&gt; <span class="number">25</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-1-Patterns-that-Bind-to-Values"><a href="#6-2-1-Patterns-that-Bind-to-Values" class="headerlink" title="6-2-1 Patterns that Bind to Values"></a>6-2-1 Patterns that Bind to Values</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span> <span class="comment">// so we can inspect the state in a minute</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">UsState</span></span> &#123;</span><br><span class="line">    Alabama,</span><br><span class="line">    Alaska,</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Coin</span></span> &#123;</span><br><span class="line">    Penny,</span><br><span class="line">    Nickel,</span><br><span class="line">    Dime,</span><br><span class="line">    Quarter(UsState),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">value_in_cents</span></span>(coin: Coin) -&gt; <span class="keyword">u32</span> &#123;</span><br><span class="line">    <span class="keyword">match</span> coin &#123;</span><br><span class="line">        Coin::Penny =&gt; <span class="number">1</span>,</span><br><span class="line">        Coin::Nickel =&gt; <span class="number">5</span>,</span><br><span class="line">        Coin::Dime =&gt; <span class="number">10</span>,</span><br><span class="line">        Coin::Quarter(state) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"State quarter from &#123;:?&#125;!"</span>, state);</span><br><span class="line">            <span class="number">25</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-2-Matching-with-Option-lt-T-gt"><a href="#6-2-2-Matching-with-Option-lt-T-gt" class="headerlink" title="6-2-2 Matching with Option&lt;T&gt;"></a>6-2-2 Matching with <code>Option&lt;T&gt;</code></h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">plus_one</span></span>(x: <span class="built_in">Option</span>&lt;<span class="keyword">i32</span>&gt;) -&gt; <span class="built_in">Option</span>&lt;<span class="keyword">i32</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">match</span> x &#123;</span><br><span class="line">        <span class="literal">None</span> =&gt; <span class="literal">None</span>,</span><br><span class="line">        <span class="literal">Some</span>(i) =&gt; <span class="literal">Some</span>(i + <span class="number">1</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> five = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> six = plus_one(five);</span><br><span class="line"><span class="keyword">let</span> none = plus_one(<span class="literal">None</span>);</span><br></pre></td></tr></table></figure>
<p>Combining <code>match</code> and enums is useful in many situations. You’ll see this pattern a lot in Rust code: <strong><code>match</code> against an enum, bind a variable to the data inside, and then execute code based on it.</strong> </p>
<h4 id="6-2-3-Matches-Are-Exhaustive"><a href="#6-2-3-Matches-Are-Exhaustive" class="headerlink" title="6-2-3 Matches Are Exhaustive"></a>6-2-3 Matches Are Exhaustive</h4><p>Rust knows that we didn’t cover every possible case and even knows which pattern we forgot! Matches in Rust are <em>exhaustive</em>: we must exhaust every last possibility in order for the code to be valid. Especially in the case of <code>Option&lt;T&gt;</code>, when Rust prevents us from forgetting to explicitly handle the <code>None</code> case, it protects us from assuming that we have a value when we might have null, thus making the billion-dollar mistake discussed earlier.</p>
<h4 id="6-2-4-The-Placeholder"><a href="#6-2-4-The-Placeholder" class="headerlink" title="6-2-4 The _ Placeholder"></a>6-2-4 The <code>_</code> Placeholder</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> some_u8_value = <span class="number">0u8</span>;</span><br><span class="line"><span class="keyword">match</span> some_u8_value &#123;</span><br><span class="line">    <span class="number">1</span> =&gt; <span class="built_in">println!</span>(<span class="string">"one"</span>),</span><br><span class="line">    <span class="number">3</span> =&gt; <span class="built_in">println!</span>(<span class="string">"three"</span>),</span><br><span class="line">    <span class="number">5</span> =&gt; <span class="built_in">println!</span>(<span class="string">"five"</span>),</span><br><span class="line">    <span class="number">7</span> =&gt; <span class="built_in">println!</span>(<span class="string">"seven"</span>),</span><br><span class="line">    _ =&gt; (),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>_</code> will match all the possible cases that aren’t specified before it. The <code>()</code> is just the unit value, so nothing will happen in the <code>_</code> case. </p>
<h3 id="6-3-Concise-Control-Flow-with-if-let"><a href="#6-3-Concise-Control-Flow-with-if-let" class="headerlink" title="6-3 Concise Control Flow with if let"></a>6-3 Concise Control Flow with if let</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> some_u8_value = <span class="literal">Some</span>(<span class="number">0u8</span>);</span><br><span class="line"><span class="keyword">match</span> some_u8_value &#123;</span><br><span class="line">    <span class="literal">Some</span>(<span class="number">3</span>) =&gt; <span class="built_in">println!</span>(<span class="string">"three"</span>),</span><br><span class="line">    _ =&gt; (),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(<span class="number">3</span>) = some_u8_value &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"three"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Using <code>if let</code> means less typing, less indentation, and less boilerplate code. However, you lose the exhaustive checking that <code>match</code> enforces. <strong>Choosing between <code>match</code> and <code>if let</code> depends on what you’re doing in your particular situation and whether gaining conciseness is an appropriate trade-off for losing exhaustive checking.</strong></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">match</span> coin &#123;</span><br><span class="line">    Coin::Quarter(state) =&gt; <span class="built_in">println!</span>(<span class="string">"State quarter from &#123;:?&#125;!"</span>, state),</span><br><span class="line">    _ =&gt; count += <span class="number">1</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> Coin::Quarter(state) = coin &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"State quarter from &#123;:?&#125;!"</span>, state);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    count += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="8-Common-Collections"><a href="#8-Common-Collections" class="headerlink" title="8 Common Collections"></a>8 Common Collections</h2><p>Unlike the built-in array and tuple types, the data these collections point to is stored on the heap, which means the amount of data does not need to be known at compile time and can grow or shrink as the program runs. </p>
<h3 id="8-1-Storing-Lists-of-Values-with-Vectors"><a href="#8-1-Storing-Lists-of-Values-with-Vectors" class="headerlink" title="8-1 Storing Lists of Values with Vectors"></a>8-1 Storing Lists of Values with Vectors</h3><p>Vectors can only store values of the same type. </p>
<h4 id="8-1-1-Create-a-New-Vector"><a href="#8-1-1-Create-a-New-Vector" class="headerlink" title="8-1-1 Create a New Vector"></a>8-1-1 Create a New Vector</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> v: <span class="built_in">Vec</span>&lt;<span class="keyword">i32</span>&gt; = <span class="built_in">Vec</span>::new();</span><br><span class="line"><span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<p>It’s more common to create a <code>Vec&lt;T&gt;</code> that has initial values, and Rust provides the <code>vec!</code> macro for convenience. </p>
<h4 id="8-1-2-Updating-a-Vector"><a href="#8-1-2-Updating-a-Vector" class="headerlink" title="8-1-2 Updating a Vector"></a>8-1-2 Updating a Vector</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> v = <span class="built_in">Vec</span>::new();</span><br><span class="line">v.push(<span class="number">5</span>);</span><br><span class="line">v.push(<span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<p>The numbers we place inside are all of type <code>i32</code>, and Rust infers this from the data, so we don’t need the <code>Vec&lt;i32&gt;</code> annotation.</p>
<h4 id="8-1-3-Dropping-a-Vector-Drops-Its-Elements"><a href="#8-1-3-Dropping-a-Vector-Drops-Its-Elements" class="headerlink" title="8-1-3 Dropping a Vector Drops Its Elements"></a>8-1-3 Dropping a Vector Drops Its Elements</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="comment">// do stuff with v</span></span><br><span class="line">&#125; <span class="comment">// &lt;- v goes out of scope and is freed here</span></span><br></pre></td></tr></table></figure>
<h4 id="8-1-4-Reading-Elements-of-Vectors"><a href="#8-1-4-Reading-Elements-of-Vectors" class="headerlink" title="8-1-4 Reading Elements of Vectors"></a>8-1-4 Reading Elements of Vectors</h4><p>Both methods of accessing a value in a vector, either with indexing syntax or the <code>get</code> method.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> third: &amp;<span class="keyword">i32</span> = &amp;v[<span class="number">2</span>];</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"The third element is &#123;&#125;"</span>, third);</span><br><span class="line"><span class="keyword">match</span> v.get(<span class="number">2</span>) &#123;</span><br><span class="line">    <span class="literal">Some</span>(third_or_other) =&gt; <span class="built_in">println!</span>(<span class="string">"The third element is &#123;&#125;"</span>, third_or_other),</span><br><span class="line">    <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">"There is no third element."</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> does_not_exist = &amp;v[<span class="number">100</span>]; <span class="comment">// will cause panic</span></span><br><span class="line"><span class="keyword">let</span> does_not_exist = v.get(<span class="number">100</span>); <span class="comment">// return None without panic</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> v = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> first = &amp;v[<span class="number">0</span>];</span><br><span class="line">v.push(<span class="number">6</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"The first element is: &#123;&#125;"</span>, first);</span><br><span class="line"><span class="comment">// error[E0502]: cannot borrow `v` as mutable because it is also borrowed as immutable</span></span><br></pre></td></tr></table></figure>
<p>Why should a reference to the first element care about what changes at the end of the vector? This error is due to the way vectors work: adding a new element onto the end of the vector might require allocating new memory and copying the old elements to the new space, if there isn’t enough room to put all the elements next to each other where the vector currently is. In that case, the reference to the first element would be pointing to deallocated memory. The borrowing rules prevent programs from ending up in that situation.</p>
<h4 id="8-1-5-Iterating-over-the-Values-in-a-Vector"><a href="#8-1-5-Iterating-over-the-Values-in-a-Vector" class="headerlink" title="8-1-5 Iterating over the Values in a Vector"></a>8-1-5 Iterating over the Values in a Vector</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="number">100</span>, <span class="number">32</span>, <span class="number">57</span>];</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &amp;v &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> v = <span class="built_in">vec!</span>[<span class="number">100</span>, <span class="number">32</span>, <span class="number">57</span>];</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &amp;<span class="keyword">mut</span> v &#123;</span><br><span class="line">    *i += <span class="number">50</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-1-6-Using-an-Enum-to-Store-Multiple-Types"><a href="#8-1-6-Using-an-Enum-to-Store-Multiple-Types" class="headerlink" title="8-1-6 Using an Enum to Store Multiple Types"></a>8-1-6 Using an Enum to Store Multiple Types</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">SpreadsheetCell</span></span> &#123;</span><br><span class="line">    Int(<span class="keyword">i32</span>),</span><br><span class="line">    Float(<span class="keyword">f64</span>),</span><br><span class="line">    Text(<span class="built_in">String</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> row = <span class="built_in">vec!</span>[</span><br><span class="line">    SpreadsheetCell::Int(<span class="number">3</span>),</span><br><span class="line">    SpreadsheetCell::Text(<span class="built_in">String</span>::from(<span class="string">"blue"</span>)),</span><br><span class="line">    SpreadsheetCell::Float(<span class="number">10.12</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>Rust needs to know what types will be in the vector at compile time so it knows exactly how much memory on the heap will be needed to store each element.</p>
<h3 id="8-2-Storing-UTF-8-Encoded-Text-with-Strings"><a href="#8-2-Storing-UTF-8-Encoded-Text-with-Strings" class="headerlink" title="8-2 Storing UTF-8 Encoded Text with Strings"></a>8-2 Storing UTF-8 Encoded Text with Strings</h3><h4 id="8-2-1-What-Is-a-String"><a href="#8-2-1-What-Is-a-String" class="headerlink" title="8-2-1 What Is a String?"></a>8-2-1 What Is a String?</h4><p>Rust’s standard library also includes a number of other string types, such as <code>OsString</code>, <code>OsStr</code>, <code>CString</code>, and <code>CStr</code>. These string types can store text in different encodings or be represented in memory in a different way.</p>
<h4 id="8-2-2-Creating-a-New-String"><a href="#8-2-2-Creating-a-New-String" class="headerlink" title="8-2-2 Creating a New String"></a>8-2-2 Creating a New String</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::new();</span><br><span class="line"><span class="keyword">let</span> data = <span class="string">"initial contents"</span>;</span><br><span class="line"><span class="keyword">let</span> s = data.to_string();</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">"initial contents"</span>.to_string();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="built_in">String</span>::from(<span class="string">"initial contents"</span>);</span><br><span class="line"><span class="keyword">let</span> hello = <span class="built_in">String</span>::from(<span class="string">"你好"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="8-2-3-Updating-a-String"><a href="#8-2-3-Updating-a-String" class="headerlink" title="8-2-3 Updating a String"></a>8-2-3 Updating a String</h4><h5 id="8-2-3-1-Appending-to-a-String-with-push-str-and-push"><a href="#8-2-3-1-Appending-to-a-String-with-push-str-and-push" class="headerlink" title="8-2-3-1 Appending to a String with push_str and push"></a>8-2-3-1 Appending to a String with <code>push_str</code> and <code>push</code></h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"foo"</span>);</span><br><span class="line">s.push_str(<span class="string">"bar"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s1 = <span class="built_in">String</span>::from(<span class="string">"foo"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="string">"bar"</span>;</span><br><span class="line">s1.push_str(s2);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"s2 is &#123;&#125;"</span>, s2);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::from(<span class="string">"lo"</span>);</span><br><span class="line">s.push(<span class="string">'l'</span>); <span class="comment">// must be char</span></span><br></pre></td></tr></table></figure>
<p>The <code>push_str</code> method takes a string slice because we don’t necessarily want to take ownership of the parameter. </p>
<h5 id="8-2-3-2-Concatenation-with-the-Operator-or-the-format-Macro"><a href="#8-2-3-2-Concatenation-with-the-Operator-or-the-format-Macro" class="headerlink" title="8-2-3-2 Concatenation with the + Operator or the format! Macro"></a>8-2-3-2 Concatenation with the <code>+</code> Operator or the <code>format!</code> Macro</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"Hello, "</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="built_in">String</span>::from(<span class="string">"world!"</span>);</span><br><span class="line"><span class="keyword">let</span> s3 = s1 + &amp;s2; <span class="comment">// note s1 has been moved here and can no longer be used</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">add</span></span>(<span class="keyword">self</span>, s: &amp;<span class="keyword">str</span>) -&gt; <span class="built_in">String</span> &#123;</span><br></pre></td></tr></table></figure>
<p>First, <code>s2</code> has an <code>&amp;</code>, meaning that we’re adding a <em>reference</em> of the second string to the first string because of the <code>s</code> parameter in the <code>add</code> function: we can only add a <code>&amp;str</code> to a <code>String</code>; we can’t add two <code>String</code> values together. But wait—the type of <code>&amp;s2</code> is <code>&amp;String</code>, not <code>&amp;str</code>, as specified in the second parameter to <code>add</code>. So why does it compile?</p>
<p>The reason we’re able to use <code>&amp;s2</code> in the call to <code>add</code> is that the compiler can <em>coerce</em> the <code>&amp;String</code>argument into a <code>&amp;str</code>. When we call the <code>add</code> method, Rust uses a <em>deref coercion</em>, which here turns <code>&amp;s2</code> into <code>&amp;s2[..]</code>.  Because <code>add</code> does not take ownership of the <code>s</code> parameter, <code>s2</code> will still be a valid <code>String</code> after this operation.</p>
<p>Second, we can see in the signature that <code>add</code> takes ownership of <code>self</code>, because <code>self</code> does <em>not</em> have an <code>&amp;</code>. This means <code>s1</code> will be moved into the <code>add</code> call and no longer be valid after that. So although <code>let s3 = s1 + &amp;s2;</code> looks like it will copy both strings and create a new one, this statement actually takes ownership of <code>s1</code>, appends a copy of the contents of <code>s2</code>, and then returns ownership of the result. In other words, it looks like it’s making a lot of copies but isn’t; the implementation is more efficient than copying.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"tic"</span>);</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="built_in">String</span>::from(<span class="string">"tac"</span>);</span><br><span class="line"><span class="keyword">let</span> s3 = <span class="built_in">String</span>::from(<span class="string">"toe"</span>);</span><br><span class="line"><span class="keyword">let</span> s = s1 + <span class="string">"-"</span> + &amp;s2 + <span class="string">"-"</span> + &amp;s3; <span class="comment">// tic-tac-toe</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="built_in">format!</span>(<span class="string">"&#123;&#125;-&#123;&#125;-&#123;&#125;"</span>, s1, s2, s3); <span class="comment">// tic-tac-toe</span></span><br></pre></td></tr></table></figure>
<h4 id="8-2-4-Indexing-into-Strings"><a href="#8-2-4-Indexing-into-Strings" class="headerlink" title="8-2-4 Indexing into Strings"></a>8-2-4 Indexing into Strings</h4><p>Rust strings don’t support indexing. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s1 = <span class="built_in">String</span>::from(<span class="string">"hello"</span>);</span><br><span class="line"><span class="keyword">let</span> h = s1[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// compile error</span></span><br></pre></td></tr></table></figure>
<h5 id="8-2-4-1-Internal-Representation"><a href="#8-2-4-1-Internal-Representation" class="headerlink" title="8-2-4-1 Internal Representation"></a>8-2-4-1 Internal Representation</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> hello = <span class="string">"Здравствуйте"</span>;</span><br><span class="line"><span class="keyword">let</span> answer = &amp;hello[<span class="number">0</span>]; <span class="comment">// `str` cannot be indexed by `&#123;integer&#125;`</span></span><br><span class="line"><span class="keyword">let</span> answer = &amp;hello[<span class="number">0</span>::<span class="number">1</span>]; <span class="comment">// 3, [0::3] Зд, д takes two bytes of storage</span></span><br></pre></td></tr></table></figure>
<h5 id="8-2-4-2-Bytes-and-Scalar-Values-and-Grapheme-Clusters"><a href="#8-2-4-2-Bytes-and-Scalar-Values-and-Grapheme-Clusters" class="headerlink" title="8-2-4-2 Bytes and Scalar Values and Grapheme Clusters"></a>8-2-4-2 Bytes and Scalar Values and Grapheme Clusters</h5><p>Another point about UTF-8 is that there are actually three relevant ways to look at strings from Rust’s perspective: as bytes, scalar values, and grapheme clusters (the closest thing to what we would call <em>letters</em>).</p>
<p>Rust provides different ways of interpreting the raw string data that computers store so that each program can choose the interpretation it needs, no matter what human language the data is in.</p>
<h4 id="8-2-5-Slicing-Strings"><a href="#8-2-5-Slicing-Strings" class="headerlink" title="8-2-5 Slicing Strings"></a>8-2-5 Slicing Strings</h4><p>Indexing into a string is often a bad idea because it’s not clear what the return type of the string-indexing operation should be: a byte value, a character, a grapheme cluster, or a string slice. Therefore, Rust asks you to be more specific if you really need to use indices to create string slices. To be more specific in your indexing and indicate that you want a string slice, rather than indexing using <code>[]</code> with a single number, you can use <code>[]</code> with a range to create a string slice containing particular bytes:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> hello = <span class="string">"Здравствуйте"</span>;</span><br><span class="line"><span class="keyword">let</span> s = &amp;hello[<span class="number">0</span>..<span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<h4 id="8-2-6-Methods-for-Iterating-Over-Strings"><a href="#8-2-6-Methods-for-Iterating-Over-Strings" class="headerlink" title="8-2-6 Methods for Iterating Over Strings"></a>8-2-6 Methods for Iterating Over Strings</h4><p>If you need to perform operations on individual Unicode scalar values, the best way to do so is to use the <code>chars</code> method. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">"नमस्ते"</span>.chars() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">"नमस्ते"</span>.bytes() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-2-7-Exercise"><a href="#8-2-7-Exercise" class="headerlink" title="8-2-7 Exercise"></a>8-2-7 Exercise</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">string_slice</span></span>(arg: &amp;<span class="keyword">str</span>) &#123; <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, arg); &#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">string</span></span>(arg: <span class="built_in">String</span>) &#123; <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, arg); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    string_slice(<span class="string">"blue"</span>);</span><br><span class="line">    string(<span class="string">"red"</span>.to_string());</span><br><span class="line">    string(<span class="built_in">String</span>::from(<span class="string">"hi"</span>));</span><br><span class="line">    string(<span class="string">"rust is fun!"</span>.to_owned());</span><br><span class="line">    string(<span class="string">"nice weather"</span>.into());</span><br><span class="line">    string(<span class="built_in">format!</span>(<span class="string">"Interpolation &#123;&#125;"</span>, <span class="string">"Station"</span>));</span><br><span class="line">    string_slice(&amp;<span class="built_in">String</span>::from(<span class="string">"abc"</span>)[<span class="number">0</span>..<span class="number">1</span>]);</span><br><span class="line">    string_slice(&amp;<span class="string">"abc"</span>.to_string()[<span class="number">0</span>..<span class="number">1</span>]);</span><br><span class="line">    string_slice(<span class="string">"  hello there "</span>.trim());</span><br><span class="line">    string(<span class="string">"Happy Monday!"</span>.to_string().replace(<span class="string">"Mon"</span>, <span class="string">"Tues"</span>));</span><br><span class="line">    string(<span class="string">"mY sHiFt KeY iS sTiCkY"</span>.to_lowercase());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-3-Storing-Keys-with-Associated-Values-in-Hash-Maps"><a href="#8-3-Storing-Keys-with-Associated-Values-in-Hash-Maps" class="headerlink" title="8-3 Storing Keys with Associated Values in Hash Maps"></a>8-3 Storing Keys with Associated Values in Hash Maps</h3><h4 id="8-3-1-Creating-a-New-Hash-Map"><a href="#8-3-1-Creating-a-New-Hash-Map" class="headerlink" title="8-3-1 Creating a New Hash Map"></a>8-3-1 Creating a New Hash Map</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> scores = HashMap::new();</span><br><span class="line">scores.insert(<span class="built_in">String</span>::from(<span class="string">"Blue"</span>), <span class="number">10</span>);</span><br><span class="line">scores.insert(<span class="built_in">String</span>::from(<span class="string">"Yellow"</span>), <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> teams  = <span class="built_in">vec!</span>[<span class="built_in">String</span>::from(<span class="string">"Blue"</span>), <span class="built_in">String</span>::from(<span class="string">"Yellow"</span>)];</span><br><span class="line"><span class="keyword">let</span> initial_scores = <span class="built_in">vec!</span>[<span class="number">10</span>, <span class="number">50</span>];</span><br><span class="line"><span class="keyword">let</span> scores: HashMap&lt;_, _&gt; = teams.iter().zip(initial_scores.iter()).collect();</span><br></pre></td></tr></table></figure>
<p>Just like vectors, hash maps store their data on the heap. Like vectors, hash maps are homogeneous: all of the keys must have the same type, and all of the values must have the same type.</p>
<p>The type annotation <code>HashMap&lt;_, _&gt;</code> is needed here because it’s possible to <code>collect</code> into many different data structures and Rust doesn’t know which you want unless you specify. For the parameters for the key and value types, however, we use underscores, and Rust can infer the types that the hash map contains based on the types of the data in the vectors.</p>
<h4 id="8-3-2-Hash-Maps-and-Ownership"><a href="#8-3-2-Hash-Maps-and-Ownership" class="headerlink" title="8-3-2 Hash Maps and Ownership"></a>8-3-2 Hash Maps and Ownership</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> field_name = <span class="built_in">String</span>::from(<span class="string">"Favorite color"</span>);</span><br><span class="line"><span class="keyword">let</span> field_value = <span class="built_in">String</span>::from(<span class="string">"Blue"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> map = HashMap::new();</span><br><span class="line">map.insert(field_name, field_value);</span><br><span class="line"><span class="comment">// field_name and field_value are invalid at this point,</span></span><br></pre></td></tr></table></figure>
<p>We aren’t able to use the variables <code>field_name</code> and <code>field_value</code> after they’ve been moved into the hash map with the call to <code>insert</code>.</p>
<p>If we insert references to values into the hash map, the values won’t be moved into the hash map. The values that the references point to must be valid for at least as long as the hash map is valid. </p>
<h4 id="8-3-3-Accessing-Values-in-a-Hash-Map"><a href="#8-3-3-Accessing-Values-in-a-Hash-Map" class="headerlink" title="8-3-3 Accessing Values in a Hash Map"></a>8-3-3 Accessing Values in a Hash Map</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> team_name = <span class="built_in">String</span>::from(<span class="string">"Blue"</span>);</span><br><span class="line"><span class="keyword">let</span> score = scores.get(&amp;team_name);</span><br></pre></td></tr></table></figure>
<p><code>score</code> will have the value that’s associated with the Blue team, and the result will be <code>Some(&amp;10)</code>. The result is wrapped in <code>Some</code> because <code>get</code> returns an <code>Option&lt;&amp;V&gt;</code>; if there’s no value for that key in the hash map, <code>get</code> will return <code>None</code>. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (key, value) <span class="keyword">in</span> &amp;scores &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;: &#123;&#125;"</span>, key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="8-3-4-Updating-a-Hash-Map"><a href="#8-3-4-Updating-a-Hash-Map" class="headerlink" title="8-3-4 Updating a Hash Map"></a>8-3-4 Updating a Hash Map</h4><h5 id="8-3-4-1-Overwriting-a-Value"><a href="#8-3-4-1-Overwriting-a-Value" class="headerlink" title="8-3-4-1 Overwriting a Value"></a>8-3-4-1 Overwriting a Value</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scores.insert(<span class="built_in">String</span>::from(<span class="string">"Blue"</span>), <span class="number">10</span>);</span><br><span class="line">scores.insert(<span class="built_in">String</span>::from(<span class="string">"Blue"</span>), <span class="number">25</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, scores); <span class="comment">// &#123;"Blue": 25&#125;</span></span><br></pre></td></tr></table></figure>
<h5 id="8-3-4-2-Only-Inserting-a-Value-If-the-Key-Has-No-Value"><a href="#8-3-4-2-Only-Inserting-a-Value-If-the-Key-Has-No-Value" class="headerlink" title="8-3-4-2 Only Inserting a Value If the Key Has No Value"></a>8-3-4-2 Only Inserting a Value If the Key Has No Value</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scores.entry(<span class="built_in">String</span>::from(<span class="string">"Yellow"</span>)).or_insert(<span class="number">50</span>);</span><br><span class="line">scores.entry(<span class="built_in">String</span>::from(<span class="string">"Blue"</span>)).or_insert(<span class="number">50</span>);</span><br></pre></td></tr></table></figure>
<p>The <code>or_insert</code> method on <code>Entry</code> is defined to return a mutable reference to the value for the corresponding <code>Entry</code> key if that key exists, and if not, inserts the parameter as the new value for this key and returns a mutable reference to the new value. This technique is much cleaner than writing the logic ourselves and, in addition, plays more nicely with the borrow checker.</p>
<h5 id="8-3-4-3-Updating-a-Value-Based-on-the-Old-Value"><a href="#8-3-4-3-Updating-a-Value-Based-on-the-Old-Value" class="headerlink" title="8-3-4-3 Updating a Value Based on the Old Value"></a>8-3-4-3 Updating a Value Based on the Old Value</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> text = <span class="string">"hello world wonderful world"</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> map = HashMap::new();</span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> text.split_whitespace() &#123;</span><br><span class="line">    <span class="keyword">let</span> count = map.entry(word).or_insert(<span class="number">0</span>);</span><br><span class="line">    *count += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, map); <span class="comment">// &#123;"world": 2, "hello": 1, "wonderful": 1&#125;</span></span><br></pre></td></tr></table></figure>
<p>The <code>or_insert</code> method actually returns a mutable reference (<code>&amp;mut V</code>) to the value for this key.</p>
<h4 id="8-3-5-Hashing-Functions"><a href="#8-3-5-Hashing-Functions" class="headerlink" title="8-3-5 Hashing Functions"></a>8-3-5 Hashing Functions</h4><p>By default, <code>HashMap</code> uses a “cryptographically strong”<a href="https://doc.rust-lang.org/book/ch08-03-hash-maps.html#siphash" target="_blank" rel="noopener">1</a> hashing function that can provide resistance to Denial of Service (DoS) attacks. This is not the fastest hashing algorithm available, but the trade-off for better security that comes with the drop in performance is worth it. If you profile your code and find that the default hash function is too slow for your purposes, you can switch to another function by specifying a different <em>hasher</em>. A hasher is a type that implements the <code>BuildHasher</code> trait. </p>
<h2 id="9-Error-Handling"><a href="#9-Error-Handling" class="headerlink" title="9 Error Handling"></a>9 Error Handling</h2><p>Rust doesn’t have exceptions. Instead, it has the type <code>Result&lt;T, E&gt;</code> for recoverable errors and the <code>panic!</code> macro that stops execution when the program encounters an unrecoverable error. </p>
<h3 id="9-1-Unrecoverable-Errors-with-panic"><a href="#9-1-Unrecoverable-Errors-with-panic" class="headerlink" title="9-1 Unrecoverable Errors with panic!"></a>9-1 Unrecoverable Errors with <code>panic!</code></h3><p>When the <code>panic!</code> macro executes, your program will print a failure message, unwind and clean up the stack, and then quit. This most commonly occurs when a bug of some kind has been detected and it’s not clear to the programmer how to handle the error.</p>
<blockquote>
<p>By default, when a panic occurs, the program starts <em>unwinding</em>, which means Rust walks back up the stack and cleans up the data from each function it encounters. But this walking back and cleanup is a lot of work. The alternative is to immediately <em>abort</em>, which ends the program without cleaning up. Memory that the program was using will then need to be cleaned up by the operating system. If in your project you need to make the resulting binary as small as possible, you can switch from unwinding to aborting upon a panic by adding <code>panic = &#39;abort&#39;</code>to the appropriate <code>[profile]</code> sections in your <em>Cargo.toml</em> file. For example, if you want to abort on panic in release mode, add this:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;[profile.release]</span><br><span class="line">&gt;panic = 'abort'</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="built_in">panic!</span>(<span class="string">"crash and burn"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// thread 'main' panicked at 'crash and burn', src/main.rs:2:4</span></span><br><span class="line"><span class="comment">// note: Run with `RUST_BACKTRACE=1` for a backtrace.</span></span><br></pre></td></tr></table></figure>
<h4 id="9-1-1-Using-a-panic-Backtrace"><a href="#9-1-1-Using-a-panic-Backtrace" class="headerlink" title="9-1-1 Using a panic! Backtrace"></a>9-1-1 Using a <code>panic!</code> Backtrace</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">    v[<span class="number">99</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// thread 'main' panicked at 'index out of bounds: the len is 3 but the index is 99', checkout/src/liballoc/vec.rs:1555:10</span></span><br><span class="line"><span class="comment">// note: Run with `RUST_BACKTRACE=1` for a backtrace.</span></span><br></pre></td></tr></table></figure>
<p>Other languages, like C, will attempt to give you exactly what you asked for in this situation, even though it isn’t what you want: you’ll get whatever is at the location in memory that would correspond to that element in the vector, even though the memory doesn’t belong to the vector. This is called a <em>buffer overread</em> and can lead to security vulnerabilities if an attacker is able to manipulate the index in such a way as to read data they shouldn’t be allowed to that is stored after the array.</p>
<p>To protect your program from this sort of vulnerability, if you try to read an element at an index that doesn’t exist, Rust will stop execution and refuse to continue.</p>
<p>This error points at a file we didn’t write, <em>vec.rs</em>. That’s the implementation of <code>Vec&lt;T&gt;</code> in the standard library. The code that gets run when we use <code>[]</code> on our vector <code>v</code> is in <em>vec.rs</em>, and that is where the <code>panic!</code> is actually happening.</p>
<p>The next note line tells us that we can set the <code>RUST_BACKTRACE</code> environment variable to get a backtrace of exactly what happened to cause the error. A <em>backtrace</em> is a list of all the functions that have been called to get to this point. Backtraces in Rust work as they do in other languages: the key to reading the backtrace is to start from the top and read until you see files you wrote. That’s the spot where the problem originated. The lines above the lines mentioning your files are code that your code called; the lines below are code that called your code. These lines might include core Rust code, standard library code, or crates that you’re using. Let’s try getting a backtrace by setting the <code>RUST_BACKTRACE</code> environment variable to any value except 0. </p>
<p><code>RUST_BACKTRACE=1 cargo run</code></p>
<p>Debug symbols are enabled by default when using <code>cargo build</code> or <code>cargo run</code> without the <code>--release</code> flag.</p>
<h3 id="9-2-Recoverable-Errors-with-Result"><a href="#9-2-Recoverable-Errors-with-Result" class="headerlink" title="9-2 Recoverable Errors with Result"></a>9-2 Recoverable Errors with Result</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> f = <span class="keyword">match</span> f &#123;</span><br><span class="line">    	<span class="literal">Ok</span>(file) =&gt; file,</span><br><span class="line">        <span class="literal">Err</span>(error) =&gt; &#123;</span><br><span class="line">        	<span class="built_in">panic!</span>(<span class="string">"There was a problem opening the file: &#123;:?&#125;"</span>, error)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The return type of the <code>File::open</code> function is a <code>Result&lt;T, E&gt;</code>. The generic parameter <code>T</code> has been filled in here with the type of the success value, <code>std::fs::File</code>, which is a file handle. The type of <code>E</code> used in the error value is <code>std::io::Error</code>.</p>
<h4 id="9-2-1-Matching-on-Different-Errors"><a href="#9-2-1-Matching-on-Different-Errors" class="headerlink" title="9-2-1 Matching on Different Errors"></a>9-2-1 Matching on Different Errors</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"><span class="keyword">use</span> std::io::ErrorKind;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> f = <span class="keyword">match</span> f &#123;</span><br><span class="line">        <span class="literal">Ok</span>(file) =&gt; file,</span><br><span class="line">        <span class="literal">Err</span>(error) =&gt; <span class="keyword">match</span> error.kind() &#123;</span><br><span class="line">            ErrorKind::NotFound =&gt; <span class="keyword">match</span> File::create(<span class="string">"hello.txt"</span>) &#123;</span><br><span class="line">                <span class="literal">Ok</span>(fc) =&gt; fc,</span><br><span class="line">                <span class="literal">Err</span>(e) =&gt; <span class="built_in">panic!</span>(<span class="string">"Tried to create file but there was a problem: &#123;:?&#125;"</span>, e),</span><br><span class="line">            &#125;,</span><br><span class="line">            other_error =&gt; <span class="built_in">panic!</span>(<span class="string">"There was a problem opening the file: &#123;:?&#125;"</span>, other_error),</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A more seasoned Rustacean might write this code: </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"><span class="keyword">use</span> std::io::ErrorKind;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>).unwrap_or_else(|error| &#123;</span><br><span class="line">        <span class="keyword">if</span> error.kind() == ErrorKind::NotFound &#123;</span><br><span class="line">            File::create(<span class="string">"hello.txt"</span>).unwrap_or_else(|error| &#123;</span><br><span class="line">                <span class="built_in">panic!</span>(<span class="string">"Tried to create file but there was a problem: &#123;:?&#125;"</span>, error);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">"There was a problem opening the file: &#123;:?&#125;"</span>, error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="9-2-2-Shortcuts-for-Panic-on-Error-unwrap-and-expect"><a href="#9-2-2-Shortcuts-for-Panic-on-Error-unwrap-and-expect" class="headerlink" title="9-2-2 Shortcuts for Panic on Error unwrap and expect"></a>9-2-2 Shortcuts for Panic on Error <code>unwrap</code> and <code>expect</code></h4><p><code>unwrap</code> is a shortcut method that is implemented just like the <code>match</code>expression, If the <code>Result</code> value is the <code>Ok</code> variant, <code>unwrap</code> will return the value inside the <code>Ok</code>. If the <code>Result</code> is the <code>Err</code> variant, <code>unwrap</code> will call the <code>panic!</code> macro for us. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>).unwrap();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// thread 'main' panicked at 'called `Result::unwrap()` on an `Err` value:</span></span><br></pre></td></tr></table></figure>
<p><code>expect</code>, which is similar to <code>unwrap</code>, lets us also choose the <code>panic!</code> error message. Using <code>expect</code> instead of <code>unwrap</code> and providing good error messages can convey your intent and make tracking down the source of a panic easier. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>).expect(<span class="string">"Failed to open hello.txt"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// thread 'main' panicked at 'Failed to open hello.txt:</span></span><br></pre></td></tr></table></figure>
<h4 id="9-2-3-Propagating-Errors"><a href="#9-2-3-Propagating-Errors" class="headerlink" title="9-2-3 Propagating Errors"></a>9-2-3 Propagating Errors</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"><span class="keyword">use</span> std::io::Read;</span><br><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username_from_file</span></span>() -&gt; <span class="built_in">Result</span>&lt;<span class="built_in">String</span>, io::Error&gt; &#123;</span><br><span class="line">    <span class="comment">// returning a value of the type Result&lt;T, E&gt; with String and io::Error</span></span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> f = <span class="keyword">match</span> f &#123;</span><br><span class="line">        <span class="literal">Ok</span>(file) =&gt; file,</span><br><span class="line">        <span class="literal">Err</span>(e) =&gt; <span class="keyword">return</span> <span class="literal">Err</span>(e),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::new();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> f.read_to_string(&amp;<span class="keyword">mut</span> s) &#123;</span><br><span class="line">        <span class="literal">Ok</span>(_) =&gt; <span class="literal">Ok</span>(s),</span><br><span class="line">        <span class="literal">Err</span>(e) =&gt; <span class="literal">Err</span>(e),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="9-2-4-A-Shortcut-for-Propagating-Errors-the-Operator"><a href="#9-2-4-A-Shortcut-for-Propagating-Errors-the-Operator" class="headerlink" title="9-2-4 A Shortcut for Propagating Errors the ? Operator"></a>9-2-4 A Shortcut for Propagating Errors the <code>?</code> Operator</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"><span class="keyword">use</span> std::io::Read;</span><br><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username_from_file</span></span>() -&gt; <span class="built_in">Result</span>&lt;<span class="built_in">String</span>, io::Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> f = File::open(<span class="string">"hello.txt"</span>)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::new();</span><br><span class="line">    f.read_to_string(&amp;<span class="keyword">mut</span> s)?;</span><br><span class="line">    <span class="literal">Ok</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username_from_file</span></span>() -&gt; <span class="built_in">Result</span>&lt;<span class="built_in">String</span>, io::Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> s = <span class="built_in">String</span>::new();</span><br><span class="line">    File::open(<span class="string">"hello.txt"</span>)?.read_to_string(&amp;<span class="keyword">mut</span> s)?;</span><br><span class="line">    <span class="literal">Ok</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> std::fs;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">read_username_from_file</span></span>() -&gt; <span class="built_in">Result</span>&lt;<span class="built_in">String</span>, io::Error&gt; &#123;</span><br><span class="line">    fs::read_to_string(<span class="string">"hello.txt"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="9-2-5-The-Operator-Can-Only-Be-Used-in-Functions-That-Return-Result"><a href="#9-2-5-The-Operator-Can-Only-Be-Used-in-Functions-That-Return-Result" class="headerlink" title="9-2-5 The ? Operator Can Only Be Used in Functions That Return Result"></a>9-2-5 The <code>?</code> Operator Can Only Be Used in Functions That Return <code>Result</code></h4><p>Because it is defined to work in the same way as the <code>match</code> expression.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>)?; <span class="comment">// without mut, return ()</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">error[E0277]: the `?` operator can only be used in a function that returns</span></span><br><span class="line"><span class="string">`Result` or `Option` (or another type that implements `std::ops::Try`)</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure>
<p>However, we can change how we write the <code>main</code> function so that it does return a <code>Result&lt;T, E&gt;</code>:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::error::Error;</span><br><span class="line"><span class="keyword">use</span> std::fs::File;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() -&gt; <span class="built_in">Result</span>&lt;(), <span class="built_in">Box</span>&lt;dyn Error&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> f = File::open(<span class="string">"hello.txt"</span>)?;</span><br><span class="line">    <span class="literal">Ok</span>(())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For now, you can read <code>Box&lt;dyn Error&gt;</code> to mean “any kind of error.”</p>
<h3 id="9-3-To-panic-or-Not-to-panic"><a href="#9-3-To-panic-or-Not-to-panic" class="headerlink" title="9-3 To panic! or Not to panic!"></a>9-3 To <code>panic!</code> or Not to <code>panic!</code></h3><p>When you choose to return a <code>Result</code> value, you give the calling code options rather than making the decision for it. The calling code could choose to attempt to recover in a way that’s appropriate for its situation, or it could decide that an <code>Err</code> value in this case is unrecoverable, so it can call <code>panic!</code> and turn your recoverable error into an unrecoverable one. <strong>Therefore, returning <code>Result</code> is a good default choice when you’re defining a function that might fail. In rare situations, it’s more appropriate to write code that panics instead of returning a <code>Result</code>.</strong></p>
<h4 id="9-3-1-Examples-Prototype-Code-and-Tests"><a href="#9-3-1-Examples-Prototype-Code-and-Tests" class="headerlink" title="9-3-1 Examples Prototype Code and Tests"></a>9-3-1 Examples Prototype Code and Tests</h4><p>If a method call fails in a test, you’d want the whole test to fail, even if that method isn’t the functionality under test. Because <code>panic!</code> is how a test is marked as a failure, calling <code>unwrap</code> or <code>expect</code> is exactly what should happen.</p>
<h4 id="9-3-2-Cases-in-Which-You-Have-More-Information-Than-the-Compiler"><a href="#9-3-2-Cases-in-Which-You-Have-More-Information-Than-the-Compiler" class="headerlink" title="9-3-2 Cases in Which You Have More Information Than the Compiler"></a>9-3-2 Cases in Which You Have More Information Than the Compiler</h4><p>It would also be appropriate to call <code>unwrap</code> when you have some other logic that ensures the <code>Result</code> will have an <code>Ok</code> value, but the logic isn’t something the compiler understands. You’ll still have a <code>Result</code> value that you need to handle: whatever operation you’re calling still has the possibility of failing in general, even though it’s logically impossible in your particular situation. If you can ensure by manually inspecting the code that you’ll never have an <code>Err</code> variant, it’s perfectly acceptable to call <code>unwrap</code>. Here’s an example:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::net::IpAddr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> home: IpAddr = <span class="string">"127.0.0.1"</span>.parse().unwrap();</span><br></pre></td></tr></table></figure>
<p>We’re creating an <code>IpAddr</code> instance by parsing a hardcoded string. We can see that <code>127.0.0.1</code> is a valid IP address, so it’s acceptable to use <code>unwrap</code> here. However, having a hardcoded, valid string doesn’t change the return type of the <code>parse</code> method: we still get a <code>Result</code> value, and the compiler will still make us handle the <code>Result</code> as if the <code>Err</code> variant is a possibility because the compiler isn’t smart enough to see that this string is always a valid IP address. If the IP address string came from a user rather than being hardcoded into the program and therefore <em>did</em> have a possibility of failure, we’d definitely want to handle the <code>Result</code> in a more robust way instead.</p>
<h4 id="9-3-3-Guidelines-for-Error-Handling"><a href="#9-3-3-Guidelines-for-Error-Handling" class="headerlink" title="9-3-3 Guidelines for Error Handling"></a>9-3-3 Guidelines for Error Handling</h4><p>It’s advisable to have your code panic when it’s possible that your code could end up in a bad state. In this context, a <em>bad state</em> is when some assumption, guarantee, contract, or invariant has been broken, such as when invalid values, contradictory values, or missing values are passed to your code—plus one or more of the following:</p>
<ul>
<li>The bad state is not something that’s <em>expected</em> to happen occasionally.</li>
<li>Your code after this point needs to rely on not being in this bad state.</li>
<li>There’s not a good way to encode this information in the types you use.</li>
</ul>
<p>If someone calls your code and passes in values that don’t make sense, the best choice might be to call <code>panic!</code> and alert the person using your library to the bug in their code so they can fix it during development. Similarly, <code>panic!</code> is often appropriate if you’re calling external code that is out of your control and it returns an invalid state that you have no way of fixing.</p>
<p>However, <strong>when failure is expected, it’s more appropriate to return a <code>Result</code> than to make a <code>panic!</code>call.</strong> Examples include a parser being given malformed data or an HTTP request returning a status that indicates you have hit a rate limit. In these cases, returning a <code>Result</code> indicates that failure is an expected possibility that the calling code must decide how to handle.</p>
<p>When your code performs operations on values, your code should verify the values are valid first and panic if the values aren’t valid. This is mostly for safety reasons: attempting to operate on invalid data can expose your code to vulnerabilities. This is the main reason the standard library will call <code>panic!</code> if you attempt an out-of-bounds memory access: trying to access memory that doesn’t belong to the current data structure is a common security problem. Functions often have <em>contracts</em>: their behavior is only guaranteed if the inputs meet particular requirements. Panicking when the contract is violated makes sense because a contract violation always indicates a caller-side bug and it’s not a kind of error you want the calling code to have to explicitly handle. In fact, there’s no reasonable way for calling code to recover; the calling <em>programmers</em> need to fix the code. Contracts for a function, especially when a violation will cause a panic, should be explained in the API documentation for the function.</p>
<p>However, having lots of error checks in all of your functions would be verbose and annoying. Fortunately, you can use Rust’s type system (and thus the type checking the compiler does) to do many of the checks for you. If your function has a particular type as a parameter, you can proceed with your code’s logic knowing that the compiler has already ensured you have a valid value. For example, if you have a type rather than an <code>Option</code>, your program expects to have <em>something</em> rather than <em>nothing</em>. Your code then doesn’t have to handle two cases for the <code>Some</code> and <code>None</code> variants: it will only have one case for definitely having a value. Code trying to pass nothing to your function won’t even compile, so your function doesn’t have to check for that case at runtime. Another example is using an unsigned integer type such as <code>u32</code>, which ensures the parameter is never negative.</p>
<h4 id="9-3-4-Creating-Custom-Types-for-Validation"><a href="#9-3-4-Creating-Custom-Types-for-Validation" class="headerlink" title="9-3-4 Creating Custom Types for Validation"></a>9-3-4 Creating Custom Types for Validation</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">loop</span> &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> guess: <span class="keyword">i32</span> = <span class="keyword">match</span> guess.trim().parse() &#123;</span><br><span class="line">        <span class="literal">Ok</span>(num) =&gt; num,</span><br><span class="line">        <span class="literal">Err</span>(_) =&gt; <span class="keyword">continue</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> guess &lt; <span class="number">1</span> || guess &gt; <span class="number">100</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"The secret number will be between 1 and 100."</span>);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> guess.cmp(&amp;secret_number) &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, this is not an ideal solution: if it was absolutely critical that the program only operated on values between 1 and 100, and it had many functions with this requirement, having a check like this in every function would be tedious (and might impact performance).</p>
<p>Instead, we can make a new type and put the validations in a function to create an instance of the type rather than repeating the validations everywhere. That way, it’s safe for functions to use the new type in their signatures and confidently use the values they receive. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Guess</span></span> &#123;</span><br><span class="line">    value: <span class="keyword">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Guess &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>(value: <span class="keyword">i32</span>) -&gt; Guess &#123;</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">1</span> || value &gt; <span class="number">100</span> &#123;</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">"Guess value must be between 1 and 100, got &#123;&#125;."</span>, value);</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="comment">// private, can not be set, only create by new</span></span><br><span class="line">        Guess &#123;</span><br><span class="line">            value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">value</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="keyword">i32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>panic!</code> macro signals that your program is in a state it can’t handle and lets you tell the process to stop instead of trying to proceed with invalid or incorrect values. The <code>Result</code> enum uses Rust’s type system to indicate that operations might fail in a way that your code could recover from.</p>
<h2 id="10-Generic-Types-Traits-and-Lifetimes"><a href="#10-Generic-Types-Traits-and-Lifetimes" class="headerlink" title="10 Generic Types, Traits, and Lifetimes"></a>10 Generic Types, Traits, and Lifetimes</h2><p>Generics are abstract stand-ins for concrete types or other properties. </p>
<h3 id="10-1-Generic-Data-Types"><a href="#10-1-Generic-Data-Types" class="headerlink" title="10-1 Generic Data Types"></a>10-1 Generic Data Types</h3><h4 id="10-1-1-In-Function-Definitions"><a href="#10-1-1-In-Function-Definitions" class="headerlink" title="10-1-1 In Function Definitions"></a>10-1-1 In Function Definitions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest_i32</span></span>(list: &amp;[<span class="keyword">i32</span>]) -&gt; <span class="keyword">i32</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> largest = list[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> &amp;item <span class="keyword">in</span> list.iter() &#123;</span><br><span class="line">        <span class="keyword">if</span> item &gt; largest &#123;</span><br><span class="line">            largest = item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    largest</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest_char</span></span>(list: &amp;[<span class="keyword">char</span>]) -&gt; <span class="keyword">char</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> largest = list[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> &amp;item <span class="keyword">in</span> list.iter() &#123;</span><br><span class="line">        <span class="keyword">if</span> item &gt; largest &#123;</span><br><span class="line">            largest = item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    largest</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest</span></span>&lt;T&gt;(list: &amp;[T]) -&gt; T &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> largest = list[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> &amp;item <span class="keyword">in</span> list.iter() &#123;</span><br><span class="line">        <span class="keyword">if</span> item &gt; largest &#123;</span><br><span class="line">            largest = item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    largest</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="10-1-2-In-Struct-Definitions"><a href="#10-1-2-In-Struct-Definitions" class="headerlink" title="10-1-2 In Struct Definitions"></a>10-1-2 In Struct Definitions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x, y same type</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T&gt; &#123;</span><br><span class="line">    x: T,</span><br><span class="line">    y: T,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> integer = Point &#123; x: <span class="number">5</span>, y: <span class="number">10</span> &#125;;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">float</span> = Point &#123; x: <span class="number">1.0</span>, y: <span class="number">4.0</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// x, y different type</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T, U&gt; &#123;</span><br><span class="line">    x: T,</span><br><span class="line">    y: U,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> both_integer = Point &#123; x: <span class="number">5</span>, y: <span class="number">10</span> &#125;;</span><br><span class="line">    <span class="keyword">let</span> both_float = Point &#123; x: <span class="number">1.0</span>, y: <span class="number">4.0</span> &#125;;</span><br><span class="line">    <span class="keyword">let</span> integer_and_float = Point &#123; x: <span class="number">5</span>, y: <span class="number">4.0</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="10-1-3-In-Enum-Definitions"><a href="#10-1-3-In-Enum-Definitions" class="headerlink" title="10-1-3 In Enum Definitions"></a>10-1-3 In Enum Definitions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option</span></span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="literal">Some</span>(T),</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Result</span></span>&lt;T, E&gt; &#123;</span><br><span class="line">    <span class="literal">Ok</span>(T),</span><br><span class="line">    <span class="literal">Err</span>(E),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="10-1-4-In-Method-Definitions"><a href="#10-1-4-In-Method-Definitions" class="headerlink" title="10-1-4 In Method Definitions"></a>10-1-4 In Method Definitions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T&gt; &#123;</span><br><span class="line">    x: T,</span><br><span class="line">    y: T,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; Point&lt;T&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">x</span></span>(&amp;<span class="keyword">self</span>) -&gt; &amp;T &#123;</span><br><span class="line">        &amp;<span class="keyword">self</span>.x</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// type Point&lt;f32&gt; will have a method named distance_from_origin and other instances of Point&lt;T&gt; where T is not of type f32 will not have this method defined. </span></span><br><span class="line"><span class="keyword">impl</span> Point&lt;<span class="keyword">f32</span>&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">distance_from_origin</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="keyword">f32</span> &#123;</span><br><span class="line">        (<span class="keyword">self</span>.x.powi(<span class="number">2</span>) + <span class="keyword">self</span>.y.powi(<span class="number">2</span>)).sqrt()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> p = Point &#123; x: <span class="number">5</span>, y: <span class="number">10</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"p.x = &#123;&#125;"</span>, p.x());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// p.x = 5</span></span><br></pre></td></tr></table></figure>
<p>Generic type parameters in a struct definition aren’t always the same as those you use in that struct’s method signatures.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T, U&gt; &#123;</span><br><span class="line">    x: T,</span><br><span class="line">    y: U,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T, U&gt; Point&lt;T, U&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">mixup</span></span>&lt;V, W&gt;(<span class="keyword">self</span>, other: Point&lt;V, W&gt;) -&gt; Point&lt;T, W&gt; &#123;</span><br><span class="line">        Point &#123;</span><br><span class="line">            x: <span class="keyword">self</span>.x,</span><br><span class="line">            y: other.y,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> p1 = Point &#123; x: <span class="number">5</span>, y: <span class="number">10.4</span> &#125;;</span><br><span class="line">    <span class="keyword">let</span> p2 = Point &#123; x: <span class="string">"Hello"</span>, y: <span class="string">'c'</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> p3 = p1.mixup(p2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"p3.x = &#123;&#125;, p3.y = &#123;&#125;"</span>, p3.x, p3.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// p3.x = 5, p3.y = c</span></span><br></pre></td></tr></table></figure>
<p>Here, the generic parameters <code>T</code> and <code>U</code> are declared after <code>impl</code>, because they go with the struct definition. The generic parameters <code>V</code> and <code>W</code> are declared after <code>fn mixup</code>, because they’re only relevant to the method.</p>
<h4 id="10-1-5-Performance-of-Code-Using-Generics"><a href="#10-1-5-Performance-of-Code-Using-Generics" class="headerlink" title="10-1-5 Performance of Code Using Generics"></a>10-1-5 Performance of Code Using Generics</h4><p>Rust accomplishes this by performing monomorphization of the code that is using generics at compile time. <em>Monomorphization</em> is the process of turning generic code into specific code by filling in the concrete types that are used when compiled.</p>
<p>The monomorphized version of the code looks like the following. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option_i32</span></span> &#123;</span><br><span class="line">    <span class="literal">Some</span>(<span class="keyword">i32</span>),</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option_f64</span></span> &#123;</span><br><span class="line">    <span class="literal">Some</span>(<span class="keyword">f64</span>),</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> integer = Option_i32::<span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">float</span> = Option_f64::<span class="literal">Some</span>(<span class="number">5.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Because Rust compiles generic code into code that specifies the type in each instance, we pay no runtime cost for using generics. When the code runs, it performs just as it would if we had duplicated each definition by hand. The process of monomorphization makes Rust’s generics extremely efficient at runtime.</p>
<h3 id="10-2-Traits-Defining-Shared-Behavior"><a href="#10-2-Traits-Defining-Shared-Behavior" class="headerlink" title="10-2 Traits Defining Shared Behavior"></a>10-2 Traits Defining Shared Behavior</h3><p>A <em>trait</em> tells the Rust compiler about functionality a particular type has and can share with other types. We can use traits to define shared behavior in an abstract way. We can use trait bounds to specify that a generic can be any type that has certain behavior.</p>
<h4 id="10-2-1-Defining-a-Trait"><a href="#10-2-1-Defining-a-Trait" class="headerlink" title="10-2-1 Defining a Trait"></a>10-2-1 Defining a Trait</h4><p>Trait definitions are a way to group method signatures together to define a set of behaviors necessary to accomplish some purpose.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">Summary</span></span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A trait can have multiple methods in its body: the method signatures are listed one per line and each line ends in a semicolon.</p>
<h4 id="10-2-2-Implementing-a-Trait-on-a-Type"><a href="#10-2-2-Implementing-a-Trait-on-a-Type" class="headerlink" title="10-2-2 Implementing a Trait on a Type"></a>10-2-2 Implementing a Trait on a Type</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">NewsArticle</span></span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> headline: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">pub</span> location: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">pub</span> author: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">pub</span> content: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Summary <span class="keyword">for</span> NewsArticle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">"&#123;&#125;, by &#123;&#125; (&#123;&#125;)"</span>, <span class="keyword">self</span>.headline, <span class="keyword">self</span>.author, <span class="keyword">self</span>.location)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Tweet</span></span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> username: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">pub</span> content: <span class="built_in">String</span>,</span><br><span class="line">    <span class="keyword">pub</span> reply: <span class="keyword">bool</span>,</span><br><span class="line">    <span class="keyword">pub</span> retweet: <span class="keyword">bool</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Summary <span class="keyword">for</span> Tweet &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">"&#123;&#125;: &#123;&#125;"</span>, <span class="keyword">self</span>.username, <span class="keyword">self</span>.content)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>After implementing the trait, we can call the methods on instances of <code>NewsArticle</code> and <code>Tweet</code> in the same way we call regular methods, like this:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tweet = Tweet &#123;</span><br><span class="line">    username: <span class="built_in">String</span>::from(<span class="string">"horse_ebooks"</span>),</span><br><span class="line">    content: <span class="built_in">String</span>::from(<span class="string">"of course, as you probably already know, people"</span>),</span><br><span class="line">    reply: <span class="literal">false</span>,</span><br><span class="line">    retweet: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"1 new tweet: &#123;&#125;"</span>, tweet.summarize());</span><br></pre></td></tr></table></figure>
<p><code>use aggregator::Summary;</code> would enable them to implement <code>Summary</code> for their type. The <code>Summary</code> trait would also need to be a public trait for another crate to implement it.</p>
<p>One restriction to note with trait implementations is that we can implement a trait on a type only if either the trait or the type is local to our crate. For example, we can implement standard library traits like <code>Display</code> on a custom type like <code>Tweet</code> as part of our <code>aggregator</code> crate functionality, because the type <code>Tweet</code> is local to our <code>aggregator</code> crate. We can also implement <code>Summary</code> on <code>Vec&lt;T&gt;</code> in our <code>aggregator</code> crate, because the trait <code>Summary</code> is local to our <code>aggregator</code> crate.</p>
<p>But we can’t implement external traits on external types. For example, we can’t implement the <code>Display</code> trait on <code>Vec&lt;T&gt;</code> within our <code>aggregator</code> crate, because <code>Display</code> and <code>Vec&lt;T&gt;</code> are defined in the standard library and aren’t local to our <code>aggregator</code> crate. This restriction is part of a property of programs called <em>coherence</em>, and more specifically the <em>orphan rule</em>, so named because the parent type is not present. This rule ensures that other people’s code can’t break your code and vice versa. Without the rule, two crates could implement the same trait for the same type, and Rust wouldn’t know which implementation to use.</p>
<h4 id="10-2-3-Default-Implementations"><a href="#10-2-3-Default-Implementations" class="headerlink" title="10-2-3 Default Implementations"></a>10-2-3 Default Implementations</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">Summary</span></span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">        <span class="built_in">String</span>::from(<span class="string">"(Read more...)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">Summary</span></span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize_author</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">"(Read more from &#123;&#125;...)"</span>, <span class="keyword">self</span>.summarize_author())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To use this version of <code>Summary</code>, we only need to define <code>summarize_author</code> when we implement the trait on a type:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Summary <span class="keyword">for</span> Tweet &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">summarize_author</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">        <span class="built_in">format!</span>(<span class="string">"@&#123;&#125;"</span>, <span class="keyword">self</span>.username)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note that it isn’t possible to call the default implementation from an overriding implementation of that same method.</p>
<h4 id="10-2-4-Traits-as-Parameters"><a href="#10-2-4-Traits-as-Parameters" class="headerlink" title="10-2-4 Traits as Parameters"></a>10-2-4 Traits as Parameters</h4><p>We can define a function <code>notify</code> that calls the <code>summarize</code> method on its parameter <code>item</code>, which is of some type that implements the <code>Summary</code> trait. To do this, we can use the <code>impl Trait</code>syntax, like this:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>(item: <span class="keyword">impl</span> Summary) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"Breaking news! &#123;&#125;"</span>, item.summarize());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="10-2-4-1-Trait-Bound-Syntax"><a href="#10-2-4-1-Trait-Bound-Syntax" class="headerlink" title="10-2-4-1 Trait Bound Syntax"></a>10-2-4-1 Trait Bound Syntax</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>&lt;T: Summary&gt;(item: T) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"Breaking news! &#123;&#125;"</span>, item.summarize());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It is equivalent to the example above, but is a bit more verbose.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// have two parameters that implement Summary</span></span><br><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>(item1: <span class="keyword">impl</span> Summary, item2: <span class="keyword">impl</span> Summary) &#123;&#125;</span><br><span class="line"><span class="comment">// force both parameters to have the exact same type</span></span><br><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>&lt;T: Summary&gt;(item1: T, item2: T) &#123;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="10-2-4-2-Specifying-Multiple-Trait-Bounds-with-Syntax"><a href="#10-2-4-2-Specifying-Multiple-Trait-Bounds-with-Syntax" class="headerlink" title="10-2-4-2 Specifying Multiple Trait Bounds with + Syntax"></a>10-2-4-2 Specifying Multiple Trait Bounds with <code>+</code> Syntax</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>(item: <span class="keyword">impl</span> Summary + Display) &#123;&#125;</span><br><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>&lt;T: Summary + Display&gt;(item: T) &#123;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="10-2-4-3-Clearer-Trait-Bounds-with-where-Clauses"><a href="#10-2-4-3-Clearer-Trait-Bounds-with-where-Clauses" class="headerlink" title="10-2-4-3 Clearer Trait Bounds with where Clauses"></a>10-2-4-3 Clearer Trait Bounds with <code>where</code> Clauses</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">some_function</span></span>&lt;T: Display + <span class="built_in">Clone</span>, U: <span class="built_in">Clone</span> + Debug&gt;(t: T, u: U) -&gt; <span class="keyword">i32</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// the same as</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">some_function</span></span>&lt;T, U&gt;(t: T, u: U) -&gt; <span class="keyword">i32</span></span><br><span class="line">    <span class="keyword">where</span> T: Display + <span class="built_in">Clone</span>,</span><br><span class="line">          U: <span class="built_in">Clone</span> + Debug</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="10-2-5-Returning-Types-that-Implement-Traits"><a href="#10-2-5-Returning-Types-that-Implement-Traits" class="headerlink" title="10-2-5 Returning Types that Implement Traits"></a>10-2-5 Returning Types that Implement Traits</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">returns_summarizable</span></span>() -&gt; <span class="keyword">impl</span> Summary &#123;</span><br><span class="line">    Tweet &#123;</span><br><span class="line">        username: <span class="built_in">String</span>::from(<span class="string">"horse_ebooks"</span>),</span><br><span class="line">        content: <span class="built_in">String</span>::from(<span class="string">"of course, as you probably already know, people"</span>),</span><br><span class="line">        reply: <span class="literal">false</span>,</span><br><span class="line">        retweet: <span class="literal">false</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Using <code>impl Trait</code> is only allowed if you have a single type that you’re returning. </p>
<h4 id="10-2-6-Fixing-the-largest-Function-with-Trait-Bounds"><a href="#10-2-6-Fixing-the-largest-Function-with-Trait-Bounds" class="headerlink" title="10-2-6 Fixing the largest Function with Trait Bounds"></a>10-2-6 Fixing the <code>largest</code> Function with Trait Bounds</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest</span></span>&lt;T&gt;(list: &amp;[T]) -&gt; T &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> largest = list[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> &amp;item <span class="keyword">in</span> list.iter() &#123;</span><br><span class="line">        <span class="keyword">if</span> item &gt; largest &#123;</span><br><span class="line">            largest = item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    largest</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> number_list = <span class="built_in">vec!</span>[<span class="number">34</span>, <span class="number">50</span>, <span class="number">25</span>, <span class="number">100</span>, <span class="number">65</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = largest(&amp;number_list);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The largest number is &#123;&#125;"</span>, result);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> char_list = <span class="built_in">vec!</span>[<span class="string">'y'</span>, <span class="string">'m'</span>, <span class="string">'a'</span>, <span class="string">'q'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = largest(&amp;char_list);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The largest char is &#123;&#125;"</span>, result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error[E0369]: binary operation `&gt;` cannot be applied to type `T`</span></span><br></pre></td></tr></table></figure>
<p>In the body of <code>largest</code> we wanted to compare two values of type <code>T</code> using the greater than (<code>&gt;</code>) operator. Because that operator is defined as a default method on the standard library trait <code>std::cmp::PartialOrd</code>, we need to specify <code>PartialOrd</code> in the trait bounds for <code>T</code> so the <code>largest</code> function can work on slices of any type that we can compare. We don’t need to bring <code>PartialOrd</code> into scope because it’s in the prelude. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest</span></span>&lt;T: <span class="built_in">PartialOrd</span>&gt;(list: &amp;[T]) -&gt; T &#123;&#125;</span><br><span class="line"><span class="comment">// error[E0508]: cannot move out of type `[T]`, a non-copy slice</span></span><br></pre></td></tr></table></figure>
<p>Types like <code>i32</code> and <code>char</code> that have a known size can be stored on the stack, so they implement the <code>Copy</code> trait. But when we made the <code>largest</code> function generic, it became possible for the <code>list</code> parameter to have types in it that don’t implement the <code>Copy</code> trait. Consequently, we wouldn’t be able to move the value out of <code>list[0]</code> and into the <code>largest</code> variable, resulting in this error.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest</span></span>&lt;T: <span class="built_in">PartialOrd</span> + <span class="built_in">Copy</span>&gt;(list: &amp;[T]) -&gt; T &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> largest = list[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> &amp;item <span class="keyword">in</span> list.iter() &#123;</span><br><span class="line">        <span class="keyword">if</span> item &gt; largest &#123;</span><br><span class="line">            largest = item;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    largest</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> number_list = <span class="built_in">vec!</span>[<span class="number">34</span>, <span class="number">50</span>, <span class="number">25</span>, <span class="number">100</span>, <span class="number">65</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = largest(&amp;number_list);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The largest number is &#123;&#125;"</span>, result);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> char_list = <span class="built_in">vec!</span>[<span class="string">'y'</span>, <span class="string">'m'</span>, <span class="string">'a'</span>, <span class="string">'q'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = largest(&amp;char_list);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The largest char is &#123;&#125;"</span>, result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The largest number is 100</span></span><br><span class="line"><span class="comment">// The largest char is y</span></span><br></pre></td></tr></table></figure>
<p>If we don’t want to restrict the <code>largest</code> function to the types that implement the <code>Copy</code> trait, we could specify that <code>T</code> has the trait bound <code>Clone</code> instead of <code>Copy</code>. Then we could clone each value in the slice when we want the <code>largest</code> function to have ownership. Using the <code>clone</code> function means we’re potentially making more heap allocations in the case of types that own heap data like <code>String</code>, and heap allocations can be slow if we’re working with large amounts of data.</p>
<p>Another way we could implement <code>largest</code> is for the function to return a reference to a <code>T</code> value in the slice. If we change the return type to <code>&amp;T</code> instead of <code>T</code>, thereby changing the body of the function to return a reference, we wouldn’t need the <code>Clone</code> or <code>Copy</code> trait bounds and we could avoid heap allocations.</p>
<h4 id="10-2-7-Using-Trait-Bounds-to-Conditionally-Implement-Methods"><a href="#10-2-7-Using-Trait-Bounds-to-Conditionally-Implement-Methods" class="headerlink" title="10-2-7 Using Trait Bounds to Conditionally Implement Methods"></a>10-2-7 Using Trait Bounds to Conditionally Implement Methods</h4><p>By using a trait bound with an <code>impl</code> block that uses generic type parameters, we can implement methods conditionally for types that implement the specified traits. For example, the type <code>Pair&lt;T&gt;</code>always implements the <code>new</code> function. But <code>Pair&lt;T&gt;</code> only implements the <code>cmp_display</code> method if its inner type <code>T</code> implements the <code>PartialOrd</code> trait that enables comparison <em>and</em> the <code>Display</code> trait that enables printing.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fmt::Display;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pair</span></span>&lt;T&gt; &#123;</span><br><span class="line">    x: T,</span><br><span class="line">    y: T,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; Pair&lt;T&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>(x: T, y: T) -&gt; <span class="keyword">Self</span> &#123;</span><br><span class="line">        <span class="keyword">Self</span> &#123;</span><br><span class="line">            x,</span><br><span class="line">            y,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T: Display + <span class="built_in">PartialOrd</span>&gt; Pair&lt;T&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">cmp_display</span></span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.x &gt;= <span class="keyword">self</span>.y &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"The largest member is x = &#123;&#125;"</span>, <span class="keyword">self</span>.x);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"The largest member is y = &#123;&#125;"</span>, <span class="keyword">self</span>.y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We can also conditionally implement a trait for any type that implements another trait. Implementations of a trait on any type that satisfies the trait bounds are called <em>blanket implementations</em> and are extensively used in the Rust standard library. For example, the standard library implements the <code>ToString</code> trait on any type that implements the <code>Display</code> trait. The <code>impl</code>block in the standard library looks similar to this code:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;T: Display&gt; <span class="built_in">ToString</span> <span class="keyword">for</span> T &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Because the standard library has this blanket implementation, we can call the to_string method defined by the ToString trait on any type that implements the Display trait. For example, we can turn integers into their corresponding String values like this because integers implement Display:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="number">3</span>.to_string();</span><br></pre></td></tr></table></figure>
<h3 id="10-3-Validating-References-with-Lifetimes"><a href="#10-3-Validating-References-with-Lifetimes" class="headerlink" title="10-3 Validating References with Lifetimes"></a>10-3 Validating References with Lifetimes</h3><h4 id="10-3-1-Preventing-Dangling-References-with-Lifetimes"><a href="#10-3-1-Preventing-Dangling-References-with-Lifetimes" class="headerlink" title="10-3-1 Preventing Dangling References with Lifetimes"></a>10-3-1 Preventing Dangling References with Lifetimes</h4><p>x out of scope doesn’t live long enough.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> r;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line">        r = &amp;x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"r: &#123;&#125;"</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This code won’t compile because the value <code>r</code> is referring to has gone out of scope before we try to use it. </p>
<h4 id="10-3-2-The-Borrow-Checker"><a href="#10-3-2-The-Borrow-Checker" class="headerlink" title="10-3-2 The Borrow Checker"></a>10-3-2 The Borrow Checker</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;            <span class="comment">// ----------+-- 'b</span></span><br><span class="line">                          <span class="comment">//           |</span></span><br><span class="line">    <span class="keyword">let</span> r = &amp;x;           <span class="comment">// --+-- 'a  |</span></span><br><span class="line">                          <span class="comment">//   |       |</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"r: &#123;&#125;"</span>, r); <span class="comment">//   |       |</span></span><br><span class="line">                          <span class="comment">// --+       |</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here, <code>x</code> has the lifetime <code>&#39;b</code>, which in this case is larger than <code>&#39;a</code>. This means <code>r</code> can reference <code>x</code>because Rust knows that the reference in <code>r</code> will always be valid while <code>x</code> is valid.</p>
<h4 id="10-3-3-Generic-Lifetimes-in-Functions"><a href="#10-3-3-Generic-Lifetimes-in-Functions" class="headerlink" title="10-3-3 Generic Lifetimes in Functions"></a>10-3-3 Generic Lifetimes in Functions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">longest</span></span>(x: &amp;<span class="keyword">str</span>, y: &amp;<span class="keyword">str</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> x.len() &gt; y.len() &#123;</span><br><span class="line">        x</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> string1 = <span class="built_in">String</span>::from(<span class="string">"abcd"</span>);</span><br><span class="line">    <span class="keyword">let</span> string2 = <span class="string">"xyz"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = longest(string1.as_str(), string2);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The longest string is &#123;&#125;"</span>, result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error: missing lifetime specifier</span></span><br><span class="line"><span class="comment">// this function's return type contains a borrowed value, but the signature does not say whether it is borrowed from `x` or `y`</span></span><br></pre></td></tr></table></figure>
<p>When we’re defining this function, we don’t know the concrete values that will be passed into this function, so we don’t know whether the <code>if</code> case or the <code>else</code> case will execute. We also don’t know the concrete lifetimes of the references that will be passed in, so we can’t look at the scopes to determine whether the reference we return will always be valid. </p>
<h4 id="10-3-4-Lifetime-Annotation-Syntax"><a href="#10-3-4-Lifetime-Annotation-Syntax" class="headerlink" title="10-3-4 Lifetime Annotation Syntax"></a>10-3-4 Lifetime Annotation Syntax</h4><p>Lifetime annotations don’t change how long any of the references live. Just as functions can accept any type when the signature specifies a generic type parameter, functions can accept references with any lifetime by specifying a generic lifetime parameter. Lifetime annotations describe the relationships of the lifetimes of multiple references to each other without affecting the lifetimes.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="keyword">i32</span>        <span class="comment">// a reference</span></span><br><span class="line">&amp;<span class="symbol">'a</span> <span class="keyword">i32</span>     <span class="comment">// a reference with an explicit lifetime</span></span><br><span class="line">&amp;<span class="symbol">'a</span> <span class="keyword">mut</span> <span class="keyword">i32</span> <span class="comment">// a mutable reference with an explicit lifetime</span></span><br></pre></td></tr></table></figure>
<h4 id="10-3-5-Lifetime-Annotations-in-Function-Signatures"><a href="#10-3-5-Lifetime-Annotations-in-Function-Signatures" class="headerlink" title="10-3-5 Lifetime Annotations in Function Signatures"></a>10-3-5 Lifetime Annotations in Function Signatures</h4><p>All the references in the parameters and the return value must have the same lifetime. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">longest</span></span>&lt;<span class="symbol">'a</span>&gt;(x: &amp;<span class="symbol">'a</span> <span class="keyword">str</span>, y: &amp;<span class="symbol">'a</span> <span class="keyword">str</span>) -&gt; &amp;<span class="symbol">'a</span> <span class="keyword">str</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> x.len() &gt; y.len() &#123;</span><br><span class="line">        x</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Remember, when we specify the lifetime parameters in this function signature, we’re not changing the lifetimes of any values passed in or returned. Rather, we’re specifying that the borrow checker should reject any values that don’t adhere to these constraints. Note that the <code>longest</code> function doesn’t need to know exactly how long <code>x</code> and <code>y</code> will live, only that some scope can be substituted for <code>&#39;a</code> that will satisfy this signature.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> string1 = <span class="built_in">String</span>::from(<span class="string">"long string is long"</span>);</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> string2 = <span class="built_in">String</span>::from(<span class="string">"xyz"</span>);</span><br><span class="line">        <span class="keyword">let</span> result = longest(string1.as_str(), string2.as_str());</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"The longest string is &#123;&#125;"</span>, result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// The longest string is long string is long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> string1 = <span class="built_in">String</span>::from(<span class="string">"long string is long"</span>);</span><br><span class="line">    <span class="keyword">let</span> result;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> string2 = <span class="built_in">String</span>::from(<span class="string">"xyz"</span>);</span><br><span class="line">        result = longest(string1.as_str(), string2.as_str());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"The longest string is &#123;&#125;"</span>, result);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error[E0597]: `string2` does not live long enough</span></span><br></pre></td></tr></table></figure>
<p>The error shows that for <code>result</code> to be valid for the <code>println!</code> statement, <code>string2</code> would need to be valid until the end of the outer scope. Rust knows this because we annotated the lifetimes of the function parameters and return values using the same lifetime parameter <code>&#39;a</code>.</p>
<p>As humans, we can look at this code and see that <code>string1</code> is longer than <code>string2</code> and therefore <code>result</code> will contain a reference to <code>string1</code>. Because <code>string1</code> has not gone out of scope yet, a reference to <code>string1</code> will still be valid for the <code>println!</code> statement. However, the compiler can’t see that the reference is valid in this case. We’ve told Rust that the lifetime of the reference returned by the <code>longest</code> function is the same as the smaller of the lifetimes of the references passed in.</p>
<h4 id="10-3-6-Thinking-in-Terms-of-Lifetimes"><a href="#10-3-6-Thinking-in-Terms-of-Lifetimes" class="headerlink" title="10-3-6 Thinking in Terms of Lifetimes"></a>10-3-6 Thinking in Terms of Lifetimes</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">longest</span></span>&lt;<span class="symbol">'a</span>&gt;(x: &amp;<span class="keyword">str</span>, y: &amp;<span class="keyword">str</span>) -&gt; &amp;<span class="symbol">'a</span> <span class="keyword">str</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="built_in">String</span>::from(<span class="string">"really long string"</span>);</span><br><span class="line">    result.as_str()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error[E0597]: `result` does not live long enough</span></span><br></pre></td></tr></table></figure>
<p>The problem is that <code>result</code> goes out of scope and gets cleaned up at the end of the <code>longest</code> function. We’re also trying to return a reference to <code>result</code> from the function. </p>
<h4 id="10-3-7-Lifetime-Annotations-in-Struct-Definitions"><a href="#10-3-7-Lifetime-Annotations-in-Struct-Definitions" class="headerlink" title="10-3-7 Lifetime Annotations in Struct Definitions"></a>10-3-7 Lifetime Annotations in Struct Definitions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ImportantExcerpt</span></span>&lt;<span class="symbol">'a</span>&gt; &#123;</span><br><span class="line">    part: &amp;<span class="symbol">'a</span> <span class="keyword">str</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// This annotation means an instance of ImportantExcerpt can’t outlive the reference it holds in its part field.</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> novel = <span class="built_in">String</span>::from(<span class="string">"Call me Ishmael. Some years ago..."</span>);</span><br><span class="line">    <span class="keyword">let</span> first_sentence = novel.split(<span class="string">'.'</span>)</span><br><span class="line">        .next()</span><br><span class="line">        .expect(<span class="string">"Could not find a '.'"</span>);</span><br><span class="line">    <span class="keyword">let</span> i = ImportantExcerpt &#123; part: first_sentence &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="10-3-8-Lifetime-Elision"><a href="#10-3-8-Lifetime-Elision" class="headerlink" title="10-3-8 Lifetime Elision"></a>10-3-8 Lifetime Elision</h4><p>Lifetimes on function or method parameters are called <em>input lifetimes</em>, and lifetimes on return values are called <em>output lifetimes</em>.</p>
<p>The compiler uses three rules to figure out what lifetimes references have when there aren’t explicit annotations. The first rule applies to input lifetimes, and the second and third rules apply to output lifetimes. If the compiler gets to the end of the three rules and there are still references for which it can’t figure out lifetimes, the compiler will stop with an error. These rules apply to <code>fn</code> definitions as well as <code>impl</code> blocks.</p>
<ul>
<li>The first rule is that each parameter that is a reference gets its own lifetime parameter.</li>
<li>The second rule is if there is exactly one input lifetime parameter, that lifetime is assigned to all output lifetime parameters.</li>
<li>The third rule is if there are multiple input lifetime parameters, but one of them is <code>&amp;self</code> or <code>&amp;mut self</code> because this is a method, the lifetime of <code>self</code> is assigned to all output lifetime parameters. </li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">longest</span></span>(x: &amp;<span class="keyword">str</span>, y: &amp;<span class="keyword">str</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br><span class="line"><span class="comment">// Let’s apply the first rule: each parameter gets its own lifetime. This time we have two parameters instead of one, so we have two lifetimes:</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">longest</span></span>&lt;<span class="symbol">'a</span>, <span class="symbol">'b</span>&gt;(x: &amp;<span class="symbol">'a</span> <span class="keyword">str</span>, y: &amp;<span class="symbol">'b</span> <span class="keyword">str</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br></pre></td></tr></table></figure>
<p>You can see that the second rule doesn’t apply because there is more than one input lifetime. The third rule doesn’t apply either, because longest is a function rather than a method, so none of the parameters are self. After working through all three rules, we still haven’t figured out what the return type’s lifetime is. This is why we got an error trying to compile the code above.</p>
<h4 id="10-3-9-Lifetime-Annotations-in-Method-Definitions"><a href="#10-3-9-Lifetime-Annotations-in-Method-Definitions" class="headerlink" title="10-3-9 Lifetime Annotations in Method Definitions"></a>10-3-9 Lifetime Annotations in Method Definitions</h4><p>Lifetime names for struct fields always need to be declared after the <code>impl</code> keyword and then used after the struct’s name, because those lifetimes are part of the struct’s type.</p>
<p>In method signatures inside the <code>impl</code> block, references might be tied to the lifetime of references in the struct’s fields, or they might be independent. In addition, the lifetime elision rules often make it so that lifetime annotations aren’t necessary in method signatures. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;<span class="symbol">'a</span>&gt; ImportantExcerpt&lt;<span class="symbol">'a</span>&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">level</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="keyword">i32</span> &#123;</span><br><span class="line">        <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The lifetime parameter declaration after <code>impl</code> and use after the type name is required, but we’re not required to annotate the lifetime of the reference to <code>self</code> because of the first elision rule.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;<span class="symbol">'a</span>&gt; ImportantExcerpt&lt;<span class="symbol">'a</span>&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">announce_and_return_part</span></span>(&amp;<span class="keyword">self</span>, announcement: &amp;<span class="keyword">str</span>) -&gt; &amp;<span class="keyword">str</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Attention please: &#123;&#125;"</span>, announcement);</span><br><span class="line">        <span class="keyword">self</span>.part</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>There are two input lifetimes, so Rust applies the first lifetime elision rule and gives both <code>&amp;self</code> and <code>announcement</code> their own lifetimes. Then, because one of the parameters is <code>&amp;self</code>, the return type gets the lifetime of <code>&amp;self</code>, and all lifetimes have been accounted for.</p>
<h4 id="10-3-10-The-Static-Lifetime"><a href="#10-3-10-The-Static-Lifetime" class="headerlink" title="10-3-10 The Static Lifetime"></a>10-3-10 The Static Lifetime</h4><p><code>let s: &amp;&#39;static str = &quot;I have a static lifetime.&quot;;</code></p>
<p>The text of this string is stored directly in the binary of your program, which is always available. Therefore, the lifetime of all string literals is <code>&#39;static</code>.</p>
<h3 id="10-4-Generic-Type-Parameters-Trait-Bounds-and-Lifetimes-Together"><a href="#10-4-Generic-Type-Parameters-Trait-Bounds-and-Lifetimes-Together" class="headerlink" title="10-4 Generic Type Parameters Trait Bounds and Lifetimes Together"></a>10-4 Generic Type Parameters Trait Bounds and Lifetimes Together</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fmt::Display;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">longest_with_an_announcement</span></span>&lt;<span class="symbol">'a</span>, T&gt;(x: &amp;<span class="symbol">'a</span> <span class="keyword">str</span>, y: &amp;<span class="symbol">'a</span> <span class="keyword">str</span>, ann: T) -&gt; &amp;<span class="symbol">'a</span> <span class="keyword">str</span></span><br><span class="line">    <span class="keyword">where</span> T: Display</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"Announcement! &#123;&#125;"</span>, ann);</span><br><span class="line">    <span class="keyword">if</span> x.len() &gt; y.len() &#123;</span><br><span class="line">        x</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This is the <code>longest</code> function now has an extra parameter named <code>ann</code> of the generic type <code>T</code>, which can be filled in by any type that implements the <code>Display</code> trait as specified by the <code>where</code> clause. This extra parameter will be printed before the function compares the lengths of the string slices, which is why the <code>Display</code> trait bound is necessary. Because lifetimes are a type of generic, the declarations of the lifetime parameter <code>&#39;a</code>and the generic type parameter <code>T</code> go in the same list inside the angle brackets after the function name.</p>
<p>Generic type parameters let you apply the code to different types. Traits and trait bounds ensure that even though the types are generic, they’ll have the behavior the code needs. </p>
<h2 id="11-Writing-Automated-Tests"><a href="#11-Writing-Automated-Tests" class="headerlink" title="11 Writing Automated Tests"></a>11 Writing Automated Tests</h2><h3 id="11-1-How-to-Write-Tests"><a href="#11-1-How-to-Write-Tests" class="headerlink" title="11-1 How to Write Tests"></a>11-1 How to Write Tests</h3><ul>
<li>Set up needed data or state</li>
<li>Run test code</li>
<li>Assert results are what you expect</li>
</ul>
<h4 id="11-1-1-The-Anatomy-of-a-Test-Function"><a href="#11-1-1-The-Anatomy-of-a-Test-Function" class="headerlink" title="11-1-1 The Anatomy of a Test Function"></a>11-1-1 The Anatomy of a Test Function</h4><p>At its simplest, a test in Rust is a function that’s annotated with the <code>test</code> attribute. Attributes are metadata about pieces of Rust code. To change a function into a test function, add <code>#[test]</code> on the line before <code>fn</code>.</p>
<h4 id="11-1-2-Checking-Results-with-the-assert-Macro"><a href="#11-1-2-Checking-Results-with-the-assert-Macro" class="headerlink" title="11-1-2 Checking Results with the assert! Macro"></a>11-1-2 Checking Results with the <code>assert!</code> Macro</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;&#125;</span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rectangle</span></span> &#123;</span><br><span class="line">    width: <span class="keyword">u32</span>,</span><br><span class="line">    height: <span class="keyword">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Rectangle &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">can_hold</span></span>(&amp;<span class="keyword">self</span>, other: &amp;Rectangle) -&gt; <span class="keyword">bool</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width &gt; other.width &amp;&amp; <span class="keyword">self</span>.height &gt; other.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests &#123;</span><br><span class="line">    <span class="comment">// Because the tests module is an inner module, we need to bring the code under test in the outer module into the scope of the inner module. </span></span><br><span class="line">    <span class="keyword">use</span> super::*;</span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">larger_can_hold_smaller</span></span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> larger = Rectangle &#123; width: <span class="number">8</span>, height: <span class="number">7</span> &#125;;</span><br><span class="line">        <span class="keyword">let</span> smaller = Rectangle &#123; width: <span class="number">5</span>, height: <span class="number">1</span> &#125;;</span><br><span class="line">        <span class="built_in">assert!</span>(larger.can_hold(&amp;smaller));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="11-1-3-Testing-Equality-with-the-assert-eq-and-assert-ne-Macros"><a href="#11-1-3-Testing-Equality-with-the-assert-eq-and-assert-ne-Macros" class="headerlink" title="11-1-3 Testing Equality with the assert_eq! and assert_ne! Macros"></a>11-1-3 Testing Equality with the <code>assert_eq!</code> and <code>assert_ne!</code> Macros</h4><p>The <code>assert_ne!</code> macro will pass if the two values we give it are not equal and fail if they’re equal. This macro is most useful for cases when we’re not sure what a value <em>will</em> be, but we know what the value definitely <em>won’t</em> be if our code is functioning as we intend.</p>
<p>Under the surface, the <code>assert_eq!</code> and <code>assert_ne!</code> macros use the operators <code>==</code> and <code>!=</code>, respectively. When the assertions fail, these macros print their arguments using debug formatting, which means the values being compared must implement the <code>PartialEq</code> and <code>Debug</code> traits. </p>
<ul>
<li>For structs and enums that you define, you’ll need to implement <code>PartialEq</code> to assert that values of those types are equal or not equal. </li>
<li>You’ll need to implement <code>Debug</code> to print the values when the assertion fails.</li>
</ul>
<h4 id="11-1-4-Adding-Custom-Failure-Messages"><a href="#11-1-4-Adding-Custom-Failure-Messages" class="headerlink" title="11-1-4 Adding Custom Failure Messages"></a>11-1-4 Adding Custom Failure Messages</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">greeting</span></span>(name: &amp;<span class="keyword">str</span>) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">    <span class="built_in">format!</span>(<span class="string">"Hello &#123;&#125;!"</span>, name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests &#123;</span><br><span class="line">    <span class="keyword">use</span> super::*;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">greeting_contains_name</span></span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> result = greeting(<span class="string">"Carol"</span>);</span><br><span class="line">        <span class="built_in">assert!</span>(</span><br><span class="line">        result.contains(<span class="string">"Carol"</span>),</span><br><span class="line">        <span class="string">"Greeting did not contain name, value was `&#123;&#125;`"</span>, result</span><br><span class="line">    );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="11-1-5-Checking-for-Panics-with-should-panic"><a href="#11-1-5-Checking-for-Panics-with-should-panic" class="headerlink" title="11-1-5 Checking for Panics with should_panic"></a>11-1-5 Checking for Panics with <code>should_panic</code></h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Guess</span></span> &#123;</span><br><span class="line">    value: <span class="keyword">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Guess &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>(value: <span class="keyword">i32</span>) -&gt; Guess &#123;</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">1</span> &#123;</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">"Guess value must be greatr than or equal to 1, got &#123;&#125;."</span>, value);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> value &gt; <span class="number">100</span> &#123;</span><br><span class="line">            <span class="built_in">panic!</span>(<span class="string">"Guess value must be less than or equal to 100, got &#123;&#125;."</span>, value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Guess &#123;</span><br><span class="line">            value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests &#123;</span><br><span class="line">    <span class="keyword">use</span> super::*;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="meta">#[should_panic(expected = <span class="meta-string">"Guess value must be less than or equal to 100"</span>)]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">greater_than_100</span></span>() &#123;</span><br><span class="line">        Guess::new(<span class="number">200</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="11-1-6-Using-Result-lt-T-E-gt-in-Tests"><a href="#11-1-6-Using-Result-lt-T-E-gt-in-Tests" class="headerlink" title="11-1-6 Using Result&lt;T, E&gt; in Tests"></a>11-1-6 Using <code>Result&lt;T, E&gt;</code> in Tests</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests &#123;</span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">it_works</span></span>() -&gt; <span class="built_in">Result</span>&lt;(), <span class="built_in">String</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="number">2</span> + <span class="number">2</span> == <span class="number">4</span> &#123;</span><br><span class="line">            <span class="literal">Ok</span>(())</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="literal">Err</span>(<span class="built_in">String</span>::from(<span class="string">"two plus two does not equal four"</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="11-2-Controlling-How-Tests-Are-Run"><a href="#11-2-Controlling-How-Tests-Are-Run" class="headerlink" title="11-2 Controlling How Tests Are Run"></a>11-2 Controlling How Tests Are Run</h3><h4 id="11-2-1-Running-Tests-in-Parallel-or-Consecutively"><a href="#11-2-1-Running-Tests-in-Parallel-or-Consecutively" class="headerlink" title="11-2-1 Running Tests in Parallel or Consecutively"></a>11-2-1 Running Tests in Parallel or Consecutively</h4><p>If you don’t want to run the tests in parallel or if you want more fine-grained control over the number of threads used: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo <span class="built_in">test</span> -- --test-threads=1</span><br></pre></td></tr></table></figure>
<h4 id="11-2-2-Showing-Function-Output"><a href="#11-2-2-Showing-Function-Output" class="headerlink" title="11-2-2 Showing Function Output"></a>11-2-2 Showing Function Output</h4><p>If we want to see printed values for passing tests as well:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo <span class="built_in">test</span> -- --nocapture</span><br></pre></td></tr></table></figure>
<h4 id="11-2-3-Running-a-Subset-of-Tests-by-Name"><a href="#11-2-3-Running-a-Subset-of-Tests-by-Name" class="headerlink" title="11-2-3 Running a Subset of Tests by Name"></a>11-2-3 Running a Subset of Tests by Name</h4><ul>
<li>Running single tests: <code>cargo test func_name</code></li>
<li>Filtering to run multiple tests: <code>cargo test some</code> will run functions whose name contains <code>some</code></li>
</ul>
<h4 id="11-2-4-Ignoring-Some-Tests-Unless-Specifically-Requested"><a href="#11-2-4-Ignoring-Some-Tests-Unless-Specifically-Requested" class="headerlink" title="11-2-4 Ignoring Some Tests Unless Specifically Requested"></a>11-2-4 Ignoring Some Tests Unless Specifically Requested</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[test]</span></span><br><span class="line"><span class="meta">#[ignore]</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">expensive_test</span></span>() &#123;</span><br><span class="line">    <span class="comment">// code that takes an hour to run</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> If we want to run only the ignored tests:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo <span class="built_in">test</span> -- --ignored</span><br></pre></td></tr></table></figure>
<h3 id="11-3-Test-Organization"><a href="#11-3-Test-Organization" class="headerlink" title="11-3 Test Organization"></a>11-3 Test Organization</h3><p>The Rust community thinks about tests in terms of two main categories: <em>unit tests</em> and <em>integration tests</em>.</p>
<p>Writing both kinds of tests is important to ensure that the pieces of your library are doing what you expect them to, separately and together.</p>
<h4 id="11-3-1-Unit-Tests"><a href="#11-3-1-Unit-Tests" class="headerlink" title="11-3-1 Unit Tests"></a>11-3-1 Unit Tests</h4><h5 id="11-3-1-1-The-Tests-Module-and-cfg-test"><a href="#11-3-1-1-The-Tests-Module-and-cfg-test" class="headerlink" title="11-3-1-1 The Tests Module and #[cfg(test)]"></a>11-3-1-1 The Tests Module and <code>#[cfg(test)]</code></h5><p>The <code>#[cfg(test)]</code> annotation on the tests module tells Rust to compile and run the test code only when you run <code>cargo test</code>, not when you run <code>cargo build</code>. </p>
<h5 id="11-3-1-2-Testing-Private-Functions"><a href="#11-3-1-2-Testing-Private-Functions" class="headerlink" title="11-3-1-2 Testing Private Functions"></a>11-3-1-2 Testing Private Functions</h5><p>Rust’s privacy rules do allow you to test private functions:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">add_two</span></span>(a: <span class="keyword">i32</span>) -&gt; <span class="keyword">i32</span> &#123;</span><br><span class="line">    internal_adder(a, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">internal_adder</span></span>(a: <span class="keyword">i32</span>, b: <span class="keyword">i32</span>) -&gt; <span class="keyword">i32</span> &#123;</span><br><span class="line">    a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[cfg(test)]</span></span><br><span class="line"><span class="keyword">mod</span> tests &#123;</span><br><span class="line">    <span class="keyword">use</span> super::*;</span><br><span class="line"></span><br><span class="line">    <span class="meta">#[test]</span></span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">internal</span></span>() &#123;</span><br><span class="line">        <span class="built_in">assert_eq!</span>(<span class="number">4</span>, internal_adder(<span class="number">2</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="11-3-2-Integration-Tests"><a href="#11-3-2-Integration-Tests" class="headerlink" title="11-3-2 Integration Tests"></a>11-3-2 Integration Tests</h4><h5 id="11-3-2-1-The-tests-Directory"><a href="#11-3-2-1-The-tests-Directory" class="headerlink" title="11-3-2-1 The tests Directory"></a>11-3-2-1 The tests Directory</h5><p>We create a <em>tests</em> directory at the top level of our project directory, next to <em>src</em>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> adder;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[test]</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">it_adds_two</span></span>() &#123;</span><br><span class="line">	<span class="built_in">assert_eq!</span>(<span class="number">4</span>, adder::add_two(<span class="number">2</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We’ve added <code>use adder</code> at the top because each test in the <code>tests</code> directory is a separate crate, so we need to bring our library into each test crate’s scope. We don’t need to annotate any code in <em>tests/integration_test.rs</em> with <code>#[cfg(test)]</code>. </p>
<p>We can still run a particular integration test function by specifying the test function’s name as an argument to <code>cargo test</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo <span class="built_in">test</span> --test func_name</span><br></pre></td></tr></table></figure>
<h5 id="11-3-2-2-Submodules-in-Integration-Tests"><a href="#11-3-2-2-Submodules-in-Integration-Tests" class="headerlink" title="11-3-2-2 Submodules in Integration Tests"></a>11-3-2-2 Submodules in Integration Tests</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tests/common.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">setup</span></span>() &#123;</span><br><span class="line">    <span class="comment">// setup code specific to your library's tests would go here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>To avoid having <code>common</code> appear in the test output, instead of creating <em>tests/common.rs</em>, we’ll create <em>tests/common/mod.rs</em>. This is an alternate naming convention that Rust also understands. Naming the file this way tells Rust not to treat the <code>common</code> module as an integration test file. </p>
<p>Now the section in the test output will no longer appear. Files in subdirectories of the <em>tests</em> directory don’t get compiled as separate crates or have sections in the test output.</p>
<h5 id="11-3-2-3-Integration-Tests-for-Binary-Crates"><a href="#11-3-2-3-Integration-Tests-for-Binary-Crates" class="headerlink" title="11-3-2-3 Integration Tests for Binary Crates"></a>11-3-2-3 Integration Tests for Binary Crates</h5><p>If our project is a binary crate that only contains a <em>src/main.rs</em> file and doesn’t have a <em>src/lib.rs</em> file, we can’t create integration tests in the <em>tests</em> directory and bring functions defined in the <em>src/main.rs</em> file into scope with a <code>use</code> statement. Only library crates expose functions that other crates can use; binary crates are meant to be run on their own.</p>
<p>This is one of the reasons Rust projects that provide a binary have a straightforward <em>src/main.rs</em> file that calls logic that lives in the <em>src/lib.rs</em> file. Using that structure, integration tests <em>can</em> test the library crate with <code>use</code> to make the important functionality available. If the important functionality works, the small amount of code in the <em>src/main.rs</em> file will work as well, and that small amount of code doesn’t need to be tested.</p>
<h2 id="18-Patterns-and-Matching"><a href="#18-Patterns-and-Matching" class="headerlink" title="18 Patterns and Matching"></a>18 Patterns and Matching</h2><p>A pattern consists of some combination of the following:</p>
<ul>
<li>Literals</li>
<li>Destructured arrays, enums, structs, or tuples</li>
<li>Variables</li>
<li>Wildcards</li>
<li>Placeholders</li>
</ul>
<h3 id="18-1-All-the-Places-Patterns-Can-Be-Used"><a href="#18-1-All-the-Places-Patterns-Can-Be-Used" class="headerlink" title="18-1 All the Places Patterns Can Be Used"></a>18-1 All the Places Patterns Can Be Used</h3><h4 id="18-1-1-match-Arms"><a href="#18-1-1-match-Arms" class="headerlink" title="18-1-1 match Arms"></a>18-1-1 <code>match</code> Arms</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> VALUE &#123;</span><br><span class="line">    PATTERN =&gt; EXPRESSION,</span><br><span class="line">    PATTERN =&gt; EXPRESSION,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>One requirement for <code>match</code> expressions is that they need to be <em>exhaustive</em> in the sense that all possibilities for the value in the <code>match</code> expression must be accounted for. </p>
<h4 id="18-1-2-Conditional-if-let-Expressions"><a href="#18-1-2-Conditional-if-let-Expressions" class="headerlink" title="18-1-2 Conditional if let Expressions"></a>18-1-2 Conditional <code>if let</code> Expressions</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">	<span class="keyword">let</span> favorite_color: <span class="built_in">Option</span>&lt;&amp;<span class="keyword">str</span>&gt; = <span class="literal">None</span>;</span><br><span class="line">    <span class="keyword">let</span> is_tuesday = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">let</span> age: <span class="built_in">Result</span>&lt;<span class="keyword">u8</span>, _&gt; = <span class="string">"34"</span>.parse();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(color) = favorite_color &#123;</span><br><span class="line">    	<span class="built_in">println!</span>(<span class="string">"Using your favorite color, &#123;&#125;, as the background"</span>, color);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> is_tuesday &#123;</span><br><span class="line">    	<span class="built_in">println!</span>(<span class="string">"Tuesday is green day!"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Ok</span>(age) = age &#123;</span><br><span class="line">    	<span class="keyword">if</span> age &gt; <span class="number">30</span> &#123;</span><br><span class="line">        	<span class="built_in">println!</span>(<span class="string">"Using purple as the background color"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        	<span class="built_in">println!</span>(<span class="string">"Using orange as the background color"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="built_in">println!</span>(<span class="string">"Using blue as the background color"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Using purple as the background color</span></span><br></pre></td></tr></table></figure>
<p>The line <code>if let Ok(age) = age</code> introduces a new shadowed <code>age</code> variable that contains the value inside the <code>Ok</code> variant. This means we need <code>if age &gt; 30</code> condition within that block: we can’t  <code>if let Ok(age) = age &amp;&amp; age &gt; 30</code>. </p>
<p>The downside of using <code>if let</code> expressions is that the compiler doesn’t check exhaustiveness, whereas with <code>match</code> expressions it does.</p>
<h4 id="18-1-3-while-let-Conditional-Loops"><a href="#18-1-3-while-let-Conditional-Loops" class="headerlink" title="18-1-3 while let Conditional Loops"></a>18-1-3 <code>while let</code> Conditional Loops</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> stack = <span class="built_in">Vec</span>::new();</span><br><span class="line"></span><br><span class="line">stack.push(<span class="number">1</span>);</span><br><span class="line">stack.push(<span class="number">2</span>);</span><br><span class="line">stack.push(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// a pattern match, loop running</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">let</span> <span class="literal">Some</span>(top) = stack.pop() &#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, top);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="18-1-4-for-Loops"><a href="#18-1-4-for-Loops" class="headerlink" title="18-1-4 for Loops"></a>18-1-4 <code>for</code> Loops</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// for x in y the x is the pattern</span></span><br><span class="line"><span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (index, value) <span class="keyword">in</span> v.iter().enumerate() &#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">"&#123;&#125; is at index &#123;&#125;"</span>, value, index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="18-1-5-let-Statements"><a href="#18-1-5-let-Statements" class="headerlink" title="18-1-5 let Statements"></a>18-1-5 <code>let</code> Statements</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> PATTERN = EXPRESSION;</span><br></pre></td></tr></table></figure>
<p>x is a pattern that means “bind what matches here to the variable x. Because the name <code>x</code> is the whole pattern, this pattern effectively means “bind everything to the variable <code>x</code>, whatever the value is.”</p>
<p>If we wanted to ignore one or more of the values in the tuple, we could use <code>_</code> or <code>..</code>.</p>
<h4 id="18-1-6-Function-Parameters"><a href="#18-1-6-Function-Parameters" class="headerlink" title="18-1-6 Function Parameters"></a>18-1-6 Function Parameters</h4><p>Function parameters can also be patterns. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">foo</span></span>(x: <span class="keyword">i32</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">print_coordinates</span></span>(&amp;(x, y): &amp;(<span class="keyword">i32</span>, <span class="keyword">i32</span>)) &#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">"current location: (&#123;&#125;, &#123;&#125;)"</span>, x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">	<span class="keyword">let</span> point = (<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">    print_coordinates(&amp;point);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="18-2-Refutability-Whether-a-Pattern-Might-Fail-to-Match"><a href="#18-2-Refutability-Whether-a-Pattern-Might-Fail-to-Match" class="headerlink" title="18-2 Refutability Whether a Pattern Might Fail to Match"></a>18-2 Refutability Whether a Pattern Might Fail to Match</h3><p>Patterns that will match for any possible value passed are <em>irrefutable</em>. Patterns that can fail to match for some possible value are <em>refutable</em>. </p>
<p>Function parameters, <code>let</code> statements, and <code>for</code> loops can only accept irrefutable patterns, because the program cannot do anything meaningful when values don’t match. </p>
<p>The <code>if let</code> and <code>while let</code> expressions only accept refutable patterns, because by definition they’re intended to handle possible failure: the functionality of a conditional is in its ability to perform differently depending on success or failure.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="literal">Some</span>(x) = some_option_value;</span><br><span class="line"><span class="comment">// error[E0005]: refutable pattern in local binding: `None` not covered</span></span><br></pre></td></tr></table></figure>
<p>If <code>some_option_value</code> was a <code>None</code> value, it would fail to match the pattern <code>Some(x)</code>, meaning the pattern is refutable. Because we didn’t cover (and couldn’t cover!) every valid value with the pattern <code>Some(x)</code>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(x) = some_option_value &#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If the pattern doesn’t match, the code will just skip the code in the curly brackets, giving it a way to continue validly.</p>
<p>It doesn’t make sense to use <code>if let</code> with an irrefutable pattern:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> x = <span class="number">5</span> &#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error[E0162]: irrefutable if-let pattern</span></span><br></pre></td></tr></table></figure>
<h3 id="18-3-Pattern-Syntax"><a href="#18-3-Pattern-Syntax" class="headerlink" title="18-3 Pattern Syntax"></a>18-3 Pattern Syntax</h3><h4 id="18-3-1-Matching-Literals"><a href="#18-3-1-Matching-Literals" class="headerlink" title="18-3-1 Matching Literals"></a>18-3-1 Matching Literals</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">	<span class="number">1</span> =&gt; <span class="built_in">println!</span>(<span class="string">"one"</span>);</span><br><span class="line">    <span class="number">2</span> =&gt; <span class="built_in">println!</span>(<span class="string">"two"</span>);</span><br><span class="line">    _ =&gt; <span class="built_in">println!</span>(<span class="string">"anything"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This syntax is useful when you want your code to take an action if it gets a particular concrete value.</p>
<h4 id="18-3-2-Matching-Named-Variables"><a href="#18-3-2-Matching-Named-Variables" class="headerlink" title="18-3-2 Matching Named Variables"></a>18-3-2 Matching Named Variables</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">let</span> y = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> x &#123;</span><br><span class="line">        <span class="literal">Some</span>(<span class="number">50</span>) =&gt; <span class="built_in">println!</span>(<span class="string">"Got 50"</span>),</span><br><span class="line">        <span class="literal">Some</span>(y) =&gt; <span class="built_in">println!</span>(<span class="string">"Matched, y = &#123;:?&#125;"</span>, y),</span><br><span class="line">        _ =&gt; <span class="built_in">println!</span>(<span class="string">"Default case, x = &#123;:?&#125;"</span>, x),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"at the end: x = &#123;:?&#125;, y = &#123;:?&#125;"</span>, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Matched, y = 5</span></span><br><span class="line"><span class="comment">// at the end: x = Some(5), y = 10</span></span><br></pre></td></tr></table></figure>
<h4 id="18-3-3-Multiple-Patterns"><a href="#18-3-3-Multiple-Patterns" class="headerlink" title="18-3-3 Multiple Patterns"></a>18-3-3 Multiple Patterns</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">    <span class="number">1</span> | <span class="number">2</span> =&gt; <span class="built_in">println!</span>(<span class="string">"one or two"</span>),</span><br><span class="line">    <span class="number">3</span> =&gt; <span class="built_in">println!</span>(<span class="string">"three"</span>),</span><br><span class="line">    _ =&gt; <span class="built_in">println!</span>(<span class="string">"anything"</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// one or two</span></span><br></pre></td></tr></table></figure>
<h4 id="18-3-4-Matching-Ranges-of-Values-with"><a href="#18-3-4-Matching-Ranges-of-Values-with" class="headerlink" title="18-3-4 Matching Ranges of Values with ..="></a>18-3-4 Matching Ranges of Values with <code>..=</code></h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">	<span class="number">1</span>..=<span class="number">5</span> =&gt; <span class="built_in">println!</span>(<span class="string">"one through five"</span>),</span><br><span class="line">    _ =&gt; <span class="built_in">println!</span>(<span class="string">"something else"</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// one through five</span></span><br></pre></td></tr></table></figure>
<p>Ranges are only allowed with numeric values or <code>char</code> values, because the compiler checks that the range isn’t empty at compile time. The only types for which Rust can tell if a range is empty or not are <code>char</code> and numeric values.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="string">'c'</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">    <span class="string">'a'</span>..=<span class="string">'j'</span> =&gt; <span class="built_in">println!</span>(<span class="string">"early ASCII letter"</span>),</span><br><span class="line">    <span class="string">'k'</span>..=<span class="string">'z'</span> =&gt; <span class="built_in">println!</span>(<span class="string">"late ASCII letter"</span>),</span><br><span class="line">    _ =&gt; <span class="built_in">println!</span>(<span class="string">"something else"</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// early ASCII letter</span></span><br></pre></td></tr></table></figure>
<h4 id="18-3-5-Destructuring-to-Break-Apart-Values"><a href="#18-3-5-Destructuring-to-Break-Apart-Values" class="headerlink" title="18-3-5 Destructuring to Break Apart Values"></a>18-3-5 Destructuring to Break Apart Values</h4><h5 id="18-3-5-1-Destructuring-Structs"><a href="#18-3-5-1-Destructuring-Structs" class="headerlink" title="18-3-5-1 Destructuring Structs"></a>18-3-5-1 Destructuring Structs</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span> &#123;</span><br><span class="line">	x: <span class="keyword">i32</span>,</span><br><span class="line">    y: <span class="keyword">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">	<span class="keyword">let</span> p = Point &#123;x: <span class="number">0</span>, y: <span class="number">7</span>&#125;</span><br><span class="line">    <span class="keyword">let</span> Point &#123;x: a, y: b&#125; = p;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">0</span>, a);</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">7</span>, b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It’s common to want the variable names to match the field names to make it easier to remember which variables came from which fields.</p>
<p>There is a shorthand for patterns that match struct fields:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span> &#123;</span><br><span class="line">    x: <span class="keyword">i32</span>,</span><br><span class="line">    y: <span class="keyword">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> p = Point &#123; x: <span class="number">0</span>, y: <span class="number">7</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> Point &#123; x, y &#125; = p;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">0</span>, x);</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="number">7</span>, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We can also destructure with literal values as part of the struct pattern rather than creating variables for all the fields. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> p = Point &#123; x: <span class="number">0</span>, y: <span class="number">7</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> p &#123;</span><br><span class="line">        Point &#123; x, y: <span class="number">0</span> &#125; =&gt; <span class="built_in">println!</span>(<span class="string">"On the x axis at &#123;&#125;"</span>, x),</span><br><span class="line">        Point &#123; x: <span class="number">0</span>, y &#125; =&gt; <span class="built_in">println!</span>(<span class="string">"On the y axis at &#123;&#125;"</span>, y),</span><br><span class="line">        Point &#123; x, y &#125; =&gt; <span class="built_in">println!</span>(<span class="string">"On neither axis: (&#123;&#125;, &#123;&#125;)"</span>, x, y),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// On the y axis at 7</span></span><br></pre></td></tr></table></figure>
<h5 id="18-3-5-2-Destructuring-Enums"><a href="#18-3-5-2-Destructuring-Enums" class="headerlink" title="18-3-5-2 Destructuring Enums"></a>18-3-5-2 Destructuring Enums</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span> &#123;</span><br><span class="line">    Quit,</span><br><span class="line">    Move &#123; x: <span class="keyword">i32</span>, y: <span class="keyword">i32</span> &#125;,</span><br><span class="line">    Write(<span class="built_in">String</span>),</span><br><span class="line">    ChangeColor(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> msg = Message::ChangeColor(<span class="number">0</span>, <span class="number">160</span>, <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> msg &#123;</span><br><span class="line">        Message::Quit =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"The Quit variant has no data to destructure."</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        Message::Move &#123; x, y &#125; =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Move in the x direction &#123;&#125; and in the y direction &#123;&#125;"</span>, x, y);</span><br><span class="line">        &#125;</span><br><span class="line">        Message::Write(text) =&gt; <span class="built_in">println!</span>(<span class="string">"Text message: &#123;&#125;"</span>, text),</span><br><span class="line">        Message::ChangeColor(r, g, b) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Change the color to red &#123;&#125;, green &#123;&#125;, and blue &#123;&#125;"</span>, r, g, b)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="18-3-5-3-Destructuring-Nested-Structs-and-Enums"><a href="#18-3-5-3-Destructuring-Nested-Structs-and-Enums" class="headerlink" title="18-3-5-3 Destructuring Nested Structs and Enums"></a>18-3-5-3 Destructuring Nested Structs and Enums</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Color</span></span> &#123;</span><br><span class="line">   Rgb(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>),</span><br><span class="line">   Hsv(<span class="keyword">i32</span>, <span class="keyword">i32</span>, <span class="keyword">i32</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span> &#123;</span><br><span class="line">    Quit,</span><br><span class="line">    Move &#123; x: <span class="keyword">i32</span>, y: <span class="keyword">i32</span> &#125;,</span><br><span class="line">    Write(<span class="built_in">String</span>),</span><br><span class="line">    ChangeColor(Color),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> msg = Message::ChangeColor(Color::Hsv(<span class="number">0</span>, <span class="number">160</span>, <span class="number">255</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> msg &#123;</span><br><span class="line">        Message::ChangeColor(Color::Rgb(r, g, b)) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Change the color to red &#123;&#125;, green &#123;&#125;, and blue &#123;&#125;"</span>, r, g, b)</span><br><span class="line">        &#125;,</span><br><span class="line">        Message::ChangeColor(Color::Hsv(h, s, v)) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Change the color to hue &#123;&#125;, saturation &#123;&#125;, and value &#123;&#125;"</span>, h, s, v)</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; ()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="18-3-5-4-Destructuring-Structs-and-Tuples"><a href="#18-3-5-4-Destructuring-Structs-and-Tuples" class="headerlink" title="18-3-5-4 Destructuring Structs and Tuples"></a>18-3-5-4 Destructuring Structs and Tuples</h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ((feet, inches), Point &#123;x, y&#125;) = ((<span class="number">3</span>, <span class="number">10</span>), Point &#123; x: <span class="number">3</span>, y: -<span class="number">10</span> &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="18-3-6-Ignoring-Values-in-a-Pattern"><a href="#18-3-6-Ignoring-Values-in-a-Pattern" class="headerlink" title="18-3-6 Ignoring Values in a Pattern"></a>18-3-6 Ignoring Values in a Pattern</h4><h5 id="18-3-6-1-Ignoring-an-Entire-Value-with"><a href="#18-3-6-1-Ignoring-an-Entire-Value-with" class="headerlink" title="18-3-6-1 Ignoring an Entire Value with _"></a>18-3-6-1 Ignoring an Entire Value with <code>_</code></h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">foo</span></span>(_: <span class="keyword">i32</span>, y: <span class="keyword">i32</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"This code only uses the y parameter: &#123;&#125;"</span>, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    foo(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="18-3-6-2-Ignoring-Parts-of-a-Value-with-a-Nested"><a href="#18-3-6-2-Ignoring-Parts-of-a-Value-with-a-Nested" class="headerlink" title="18-3-6-2 Ignoring Parts of a Value with a Nested _"></a>18-3-6-2 Ignoring Parts of a Value with a Nested <code>_</code></h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> setting_value = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> new_setting_value = <span class="literal">Some</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> (setting_value, new_setting_value) &#123;</span><br><span class="line">    (<span class="literal">Some</span>(_), <span class="literal">Some</span>(_)) =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Can't overwrite an existing customized value"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    _ =&gt; &#123;</span><br><span class="line">        setting_value = new_setting_value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"setting is &#123;:?&#125;"</span>, setting_value);</span><br></pre></td></tr></table></figure>
<p>In the first match arm, we don’t need to match on or use the values inside either <code>Some</code> variant, but we do need to test for the case when <code>setting_value</code> and <code>new_setting_value</code> are the <code>Some</code> variant. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = (<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> numbers &#123;</span><br><span class="line">    (first, _, third, _, fifth) =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Some numbers: &#123;&#125;, &#123;&#125;, &#123;&#125;"</span>, first, third, fifth)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="18-3-6-3-Ignoring-an-Unused-Variable-by-Starting-Its-Name-with"><a href="#18-3-6-3-Ignoring-an-Unused-Variable-by-Starting-Its-Name-with" class="headerlink" title="18-3-6-3 Ignoring an Unused Variable by Starting Its Name with _"></a>18-3-6-3 Ignoring an Unused Variable by Starting Its Name with <code>_</code></h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> _x = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> y = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The syntax <code>_x</code> still binds the value to the variable, whereas <code>_</code> doesn’t bind at all. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="literal">Some</span>(<span class="built_in">String</span>::from(<span class="string">"Hello!"</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(_s) = s &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"found a string"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, s);</span><br></pre></td></tr></table></figure>
<p>We’ll receive an error because the <code>s</code> value will still be moved into <code>_s</code>, which prevents us from using <code>s</code> again. However, using the underscore by itself doesn’t ever bind to the value. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="literal">Some</span>(<span class="built_in">String</span>::from(<span class="string">"Hello!"</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(_) = s &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"found a string"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">"&#123;:?&#125;"</span>, s);</span><br></pre></td></tr></table></figure>
<h5 id="18-3-6-4-Ignoring-Remaining-Parts-of-a-Value-with"><a href="#18-3-6-4-Ignoring-Remaining-Parts-of-a-Value-with" class="headerlink" title="18-3-6-4 Ignoring Remaining Parts of a Value with .."></a>18-3-6-4 Ignoring Remaining Parts of a Value with <code>..</code></h5><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span> &#123;</span><br><span class="line">    x: <span class="keyword">i32</span>,</span><br><span class="line">    y: <span class="keyword">i32</span>,</span><br><span class="line">    z: <span class="keyword">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> origin = Point &#123; x: <span class="number">0</span>, y: <span class="number">0</span>, z: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> origin &#123;</span><br><span class="line">    Point &#123; x, .. &#125; =&gt; <span class="built_in">println!</span>(<span class="string">"x is &#123;&#125;"</span>, x),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The syntax <code>..</code> will expand to as many values as it needs to be. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> numbers = (<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> numbers &#123;</span><br><span class="line">        (first, .., last) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Some numbers: &#123;&#125;, &#123;&#125;"</span>, first, last);</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If it is unclear which values are intended for matching and which should be ignored, Rust will give us an error.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> numbers = (<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> numbers &#123;</span><br><span class="line">        (.., second, ..) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">"Some numbers: &#123;&#125;"</span>, second)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// error: `..` can only be used once per tuple or tuple struct pattern</span></span><br></pre></td></tr></table></figure>
<h4 id="18-3-7-Extra-Conditionals-with-Match-Guards"><a href="#18-3-7-Extra-Conditionals-with-Match-Guards" class="headerlink" title="18-3-7 Extra Conditionals with Match Guards"></a>18-3-7 Extra Conditionals with Match Guards</h4><p>A <em>match guard</em> is an additional <code>if</code> condition specified after the pattern in a <code>match</code> arm that must also match, along with the pattern matching, for that arm to be chosen. Match guards are useful for expressing more complex ideas than a pattern alone allows.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="literal">Some</span>(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> num &#123;</span><br><span class="line">    <span class="literal">Some</span>(x) <span class="keyword">if</span> x &lt; <span class="number">5</span> =&gt; <span class="built_in">println!</span>(<span class="string">"less than five: &#123;&#125;"</span>, x),</span><br><span class="line">    <span class="literal">Some</span>(x) =&gt; <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, x),</span><br><span class="line">    <span class="literal">None</span> =&gt; (),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>There is no way to express the <code>if x &lt; 5</code> condition within a pattern, so the match guard gives us the ability to express this logic.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">let</span> y = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> x &#123;</span><br><span class="line">        <span class="literal">Some</span>(<span class="number">50</span>) =&gt; <span class="built_in">println!</span>(<span class="string">"Got 50"</span>),</span><br><span class="line">        <span class="comment">// outer y</span></span><br><span class="line">        <span class="literal">Some</span>(n) <span class="keyword">if</span> n == y =&gt; <span class="built_in">println!</span>(<span class="string">"Matched, n = &#123;:?&#125;"</span>, n),</span><br><span class="line">        _ =&gt; <span class="built_in">println!</span>(<span class="string">"Default case, x = &#123;:?&#125;"</span>, x),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"at the end: x = &#123;:?&#125;, y = &#123;:?&#125;"</span>, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Default case, x = Some(5)</span></span><br></pre></td></tr></table></figure>
<p>Use the <em>or</em> operator <code>|</code> in a match guard to specify multiple patterns.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">let</span> y = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">    <span class="number">4</span> | <span class="number">5</span> | <span class="number">6</span> <span class="keyword">if</span> y =&gt; <span class="built_in">println!</span>(<span class="string">"yes"</span>),</span><br><span class="line">    _ =&gt; <span class="built_in">println!</span>(<span class="string">"no"</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// no</span></span><br></pre></td></tr></table></figure>
<p>Only matches if the value of <code>x</code> is equal to <code>4</code>, <code>5</code>, or <code>6</code> <em>and</em> if <code>y</code> is <code>true</code>. </p>
<h4 id="18-3-8-Bindings"><a href="#18-3-8-Bindings" class="headerlink" title="18-3-8 @ Bindings"></a>18-3-8 <code>@</code> Bindings</h4><p>The <em>at</em> operator (<code>@</code>) lets us create a variable that holds a value at the same time we’re testing that value to see whether it matches a pattern. </p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span> &#123;</span><br><span class="line">    Hello &#123; id: <span class="keyword">i32</span> &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> msg = Message::Hello &#123; id: <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> msg &#123;</span><br><span class="line">    Message::Hello &#123; id: id_variable @ <span class="number">3</span>..=<span class="number">7</span> &#125; =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Found an id in range: &#123;&#125;"</span>, id_variable)</span><br><span class="line">    &#125;,</span><br><span class="line">    Message::Hello &#123; id: <span class="number">10</span>..=<span class="number">12</span> &#125; =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Found an id in another range"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    Message::Hello &#123; id &#125; =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">"Found some other id: &#123;&#125;"</span>, id)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Found an id in range: 5</span></span><br></pre></td></tr></table></figure>
<p>In the second arm, where we only have a range specified in the pattern, the code associated with the arm doesn’t have a variable that contains the actual value of the <code>id</code> field. The <code>id</code> field’s value could have been 10, 11, or 12, but the code that goes with that pattern doesn’t know which it is. The pattern code isn’t able to use the value from the <code>id</code> field, because we haven’t saved the <code>id</code> value in a variable.</p>

      
    </div><!-- .entry-content -->

    <footer class="entry-meta">
    <a href="/2019/12/31/Rust/RPL/2019-12-31-RPL-Brief-Note-Vol1-Basic/">
    <time datetime="2019-12-31T04:00:00.000Z" class="entry-date">
        2019-12-31
    </time>
</a>
    
  <span class="article-delim">&#8226;</span>
  <div class="article-category">
  <a class="article-category-link" href="/categories/Coding/">Coding</a>
  </div>

    
  <span class="article-delim">&#8226;</span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rust/">Rust</a></li></ul>

    </footer>
</article>


    
<nav class="nav-single">
    <h3 class="assistive-text">文章导航</h3>
    
        <span class="nav-previous"><a href="/2019/12/31/Rust/RPL/2019-12-31-RPL-Brief-Note-Vol2-Manage/" rel="prev"><span class="meta-nav">←</span> The Rust Programming Language Brief Note (Vol2-Manage)</a></span>
    
    
        <span class="nav-next"><a href="/2019/12/28/Paper/2019-12-28-Bi-LSTM-CRF-NER-Paper/" rel="next">Neural Architectures for Named Entity Recognition 论文笔记 <span class="meta-nav">→</span></a></span>
    
</nav><!-- .nav-single -->







<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a><a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a><a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a><a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{},"image":{"viewList":["fbook","twi","linkedin","qzone","tsina","douban","weixin","evernotecn"],"viewText":"分享到：","viewSize":"16"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?'];</script>

<section id="comment">
  <!-- 评论代码 -->
  <div id="gitalk-container"></div>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <script>
  const gitalk = new Gitalk({
    clientID: '0eb512031083d6e7edfb',
    clientSecret: 'e830808995dd813ca26fed50573760963457da37',
    repo: 'hscspring.github.io',
    owner: 'hscspring',
    admin: ['hscspring'],
    id: md5(location.pathname),
    distractionFreeMode: false
  })
  gitalk.render('gitalk-container')
  </script>
  <!-- 评论代码已完成 -->
</section>

</div></div>
        <div id="secondary" class="widget-area" role="complementary">
  
    
  <aside class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-content">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Coding/">Coding</a><span class="category-list-count">66</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Feeling/">Feeling</a><span class="category-list-count">84</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thinking/">Thinking</a><span class="category-list-count">18</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Music</h3>
    <div class="widget-content">
      <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=541131&auto=0&height=66"></iframe>
      <!-- 评论代码 -->
      <!-- <audio src="http://qnimg.lovevivian.cn/miss.mp3" controls="controls"
             style="width:100%">
        您的浏览器不支持 audio 标签。
      </audio> -->
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-content tagcloud">
      <a href="/tags/AE/" style="font-size: 10px;">AE</a> <a href="/tags/AI/" style="font-size: 19.09px;">AI</a> <a href="/tags/ALBERT/" style="font-size: 10px;">ALBERT</a> <a href="/tags/AR/" style="font-size: 10px;">AR</a> <a href="/tags/AUC/" style="font-size: 10px;">AUC</a> <a href="/tags/Accuracy/" style="font-size: 10px;">Accuracy</a> <a href="/tags/Activation/" style="font-size: 10px;">Activation</a> <a href="/tags/Algorithm/" style="font-size: 13.64px;">Algorithm</a> <a href="/tags/Array/" style="font-size: 10px;">Array</a> <a href="/tags/Arrow/" style="font-size: 10px;">Arrow</a> <a href="/tags/Attention/" style="font-size: 12.73px;">Attention</a> <a href="/tags/Automatic-Speech-Processing/" style="font-size: 10px;">Automatic Speech Processing</a> <a href="/tags/Automation/" style="font-size: 10px;">Automation</a> <a href="/tags/BERT/" style="font-size: 13.64px;">BERT</a> <a href="/tags/BPE/" style="font-size: 10px;">BPE</a> <a href="/tags/Backtracking/" style="font-size: 10px;">Backtracking</a> <a href="/tags/Backward/" style="font-size: 10px;">Backward</a> <a href="/tags/Bahdanau-Attention/" style="font-size: 10px;">Bahdanau Attention</a> <a href="/tags/Bart/" style="font-size: 10px;">Bart</a> <a href="/tags/Bayes/" style="font-size: 10px;">Bayes</a> <a href="/tags/Beam-Search/" style="font-size: 10px;">Beam Search</a> <a href="/tags/Bert/" style="font-size: 14.55px;">Bert</a> <a href="/tags/Bert-Flow/" style="font-size: 10px;">Bert-Flow</a> <a href="/tags/Bi-LSTM/" style="font-size: 10px;">Bi-LSTM</a> <a href="/tags/Binary-Search/" style="font-size: 11.82px;">Binary Search</a> <a href="/tags/Blending/" style="font-size: 10px;">Blending</a> <a href="/tags/Business/" style="font-size: 11.82px;">Business</a> <a href="/tags/C/" style="font-size: 10.91px;">C</a> <a href="/tags/CCG/" style="font-size: 10.91px;">CCG</a> <a href="/tags/CFG/" style="font-size: 10px;">CFG</a> <a href="/tags/CKY/" style="font-size: 10px;">CKY</a> <a href="/tags/CNN/" style="font-size: 10px;">CNN</a> <a href="/tags/CRF/" style="font-size: 10px;">CRF</a> <a href="/tags/CYK/" style="font-size: 10px;">CYK</a> <a href="/tags/Calculus/" style="font-size: 10px;">Calculus</a> <a href="/tags/Camera/" style="font-size: 10px;">Camera</a> <a href="/tags/Catalan/" style="font-size: 10px;">Catalan</a> <a href="/tags/ChatBot/" style="font-size: 10px;">ChatBot</a> <a href="/tags/Chi2/" style="font-size: 10px;">Chi2</a> <a href="/tags/Chunking/" style="font-size: 10px;">Chunking</a> <a href="/tags/Classification/" style="font-size: 10.91px;">Classification</a> <a href="/tags/Cognition/" style="font-size: 10.91px;">Cognition</a> <a href="/tags/Collaborative-Filtering/" style="font-size: 10px;">Collaborative Filtering</a> <a href="/tags/Collins-Parser/" style="font-size: 10px;">Collins Parser</a> <a href="/tags/Computational-Linguistics/" style="font-size: 10px;">Computational Linguistics</a> <a href="/tags/Computer/" style="font-size: 10px;">Computer</a> <a href="/tags/Computer-Science/" style="font-size: 12.73px;">Computer Science</a> <a href="/tags/Confusing-Labels/" style="font-size: 10px;">Confusing Labels</a> <a href="/tags/Context-Free-Grammars/" style="font-size: 10px;">Context-Free Grammars</a> <a href="/tags/Contrastive-Learning/" style="font-size: 10px;">Contrastive-Learning</a> <a href="/tags/Coordinate-Ascent/" style="font-size: 10px;">Coordinate Ascent</a> <a href="/tags/Cosine/" style="font-size: 10.91px;">Cosine</a> <a href="/tags/Cosine-Similarity/" style="font-size: 10px;">Cosine Similarity</a> <a href="/tags/Cross-Entropy/" style="font-size: 10px;">Cross Entropy</a> <a href="/tags/Cross-brackets/" style="font-size: 10px;">Cross-brackets</a> <a href="/tags/Ctrl/" style="font-size: 10px;">Ctrl</a> <a href="/tags/DB/" style="font-size: 10.91px;">DB</a> <a href="/tags/DNN/" style="font-size: 10px;">DNN</a> <a href="/tags/DP/" style="font-size: 10px;">DP</a> <a href="/tags/Data-Clearing/" style="font-size: 10px;">Data Clearing</a> <a href="/tags/Data-Preprocess/" style="font-size: 10px;">Data Preprocess</a> <a href="/tags/Data-Science/" style="font-size: 14.55px;">Data Science</a> <a href="/tags/Data-Structure/" style="font-size: 16.36px;">Data Structure</a> <a href="/tags/Database/" style="font-size: 10px;">Database</a> <a href="/tags/DeBERTa/" style="font-size: 10px;">DeBERTa</a> <a href="/tags/Decoder/" style="font-size: 10px;">Decoder</a> <a href="/tags/Decoding/" style="font-size: 10px;">Decoding</a> <a href="/tags/Deep/" style="font-size: 10px;">Deep</a> <a href="/tags/DeepGraph/" style="font-size: 10px;">DeepGraph</a> <a href="/tags/DeepLearning/" style="font-size: 11.82px;">DeepLearning</a> <a href="/tags/Dependence/" style="font-size: 10px;">Dependence</a> <a href="/tags/Diary/" style="font-size: 10.91px;">Diary</a> <a href="/tags/Disentangled-Attention/" style="font-size: 10px;">Disentangled Attention</a> <a href="/tags/DistilBERT/" style="font-size: 10px;">DistilBERT</a> <a href="/tags/Distillation/" style="font-size: 10px;">Distillation</a> <a href="/tags/Django/" style="font-size: 10px;">Django</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Docker-Compose/" style="font-size: 10px;">Docker-Compose</a> <a href="/tags/Dockerfile/" style="font-size: 10px;">Dockerfile</a> <a href="/tags/Dropout/" style="font-size: 10.91px;">Dropout</a> <a href="/tags/Dynamic-Mask/" style="font-size: 10px;">Dynamic-Mask</a> <a href="/tags/EDA/" style="font-size: 10px;">EDA</a> <a href="/tags/EMD/" style="font-size: 10px;">EMD</a> <a href="/tags/ERNIE/" style="font-size: 10px;">ERNIE</a> <a href="/tags/Economics/" style="font-size: 10px;">Economics</a> <a href="/tags/Edit-Distance/" style="font-size: 10px;">Edit Distance</a> <a href="/tags/Efficient-DeepLearning/" style="font-size: 10px;">Efficient-DeepLearning</a> <a href="/tags/Elasticsearch/" style="font-size: 10px;">Elasticsearch</a> <a href="/tags/Electra/" style="font-size: 10px;">Electra</a> <a href="/tags/Elixir/" style="font-size: 10.91px;">Elixir</a> <a href="/tags/Embedding/" style="font-size: 11.82px;">Embedding</a> <a href="/tags/Embeddings/" style="font-size: 10.91px;">Embeddings</a> <a href="/tags/Encoder/" style="font-size: 10px;">Encoder</a> <a href="/tags/Entropy/" style="font-size: 10.91px;">Entropy</a> <a href="/tags/Evaluation/" style="font-size: 10.91px;">Evaluation</a> <a href="/tags/F1/" style="font-size: 10px;">F1</a> <a href="/tags/FDW/" style="font-size: 10px;">FDW</a> <a href="/tags/FSM/" style="font-size: 10px;">FSM</a> <a href="/tags/Feature-Engineering/" style="font-size: 10px;">Feature Engineering</a> <a href="/tags/Feature-based/" style="font-size: 10px;">Feature-based</a> <a href="/tags/Few-Shot/" style="font-size: 10px;">Few-Shot</a> <a href="/tags/Fine-tuning/" style="font-size: 10px;">Fine-tuning</a> <a href="/tags/Formal-Grammars/" style="font-size: 11.82px;">Formal Grammars</a> <a href="/tags/Forward/" style="font-size: 10px;">Forward</a> <a href="/tags/Full-Text-Search/" style="font-size: 10px;">Full-Text-Search</a> <a href="/tags/Function-Syntax/" style="font-size: 10px;">Function Syntax</a> <a href="/tags/Funk-MF/" style="font-size: 10px;">Funk MF</a> <a href="/tags/Funnel-Transformer/" style="font-size: 10px;">Funnel Transformer</a> <a href="/tags/GBTD/" style="font-size: 10px;">GBTD</a> <a href="/tags/GELU/" style="font-size: 10px;">GELU</a> <a href="/tags/GPT-2/" style="font-size: 10px;">GPT-2</a> <a href="/tags/GPU/" style="font-size: 10px;">GPU</a> <a href="/tags/GRU/" style="font-size: 10px;">GRU</a> <a href="/tags/GSG/" style="font-size: 10px;">GSG</a> <a href="/tags/Gan/" style="font-size: 10px;">Gan</a> <a href="/tags/Garden-path/" style="font-size: 10px;">Garden-path</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Glow/" style="font-size: 10px;">Glow</a> <a href="/tags/Graceful-Shutdown/" style="font-size: 10px;">Graceful Shutdown</a> <a href="/tags/Gradient-Descent/" style="font-size: 10px;">Gradient Descent</a> <a href="/tags/Graph/" style="font-size: 10.91px;">Graph</a> <a href="/tags/GraphQL/" style="font-size: 10.91px;">GraphQL</a> <a href="/tags/Grid-Grammar/" style="font-size: 10px;">Grid Grammar</a> <a href="/tags/HMM/" style="font-size: 10.91px;">HMM</a> <a href="/tags/Hard-SVM/" style="font-size: 10px;">Hard-SVM</a> <a href="/tags/Hinge-Loss/" style="font-size: 10px;">Hinge Loss</a> <a href="/tags/IE/" style="font-size: 10px;">IE</a> <a href="/tags/IQR/" style="font-size: 10px;">IQR</a> <a href="/tags/Imbalance-Data/" style="font-size: 10px;">Imbalance Data</a> <a href="/tags/Industry/" style="font-size: 10px;">Industry</a> <a href="/tags/Information-Extraction/" style="font-size: 10px;">Information Extraction</a> <a href="/tags/Information-Theory/" style="font-size: 10px;">Information Theory</a> <a href="/tags/Isolation-Forest/" style="font-size: 10px;">Isolation Forest</a> <a href="/tags/ItemCF/" style="font-size: 10px;">ItemCF</a> <a href="/tags/Jaccard/" style="font-size: 10px;">Jaccard</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Jax/" style="font-size: 10px;">Jax</a> <a href="/tags/Job/" style="font-size: 10px;">Job</a> <a href="/tags/Jupyter/" style="font-size: 10px;">Jupyter</a> <a href="/tags/KKT/" style="font-size: 10px;">KKT</a> <a href="/tags/KS/" style="font-size: 10px;">KS</a> <a href="/tags/Kernel/" style="font-size: 10px;">Kernel</a> <a href="/tags/Kernel-Function/" style="font-size: 10px;">Kernel Function</a> <a href="/tags/Kernel-Method/" style="font-size: 10px;">Kernel Method</a> <a href="/tags/Keyword/" style="font-size: 10px;">Keyword</a> <a href="/tags/Knowledge-Graph/" style="font-size: 10.91px;">Knowledge Graph</a> <a href="/tags/LM/" style="font-size: 10.91px;">LM</a> <a href="/tags/LOF/" style="font-size: 10px;">LOF</a> <a href="/tags/LR/" style="font-size: 10px;">LR</a> <a href="/tags/LSTM/" style="font-size: 10px;">LSTM</a> <a href="/tags/Language-Model/" style="font-size: 10.91px;">Language Model</a> <a href="/tags/Lexical-Semantics/" style="font-size: 10px;">Lexical Semantics</a> <a href="/tags/Lexicalism/" style="font-size: 10px;">Lexicalism</a> <a href="/tags/Lexicalized-CFG/" style="font-size: 10px;">Lexicalized CFG</a> <a href="/tags/Lexicalized-Grammars/" style="font-size: 10px;">Lexicalized Grammars</a> <a href="/tags/Linear-Algebra/" style="font-size: 10px;">Linear Algebra</a> <a href="/tags/Linear-Sturcture/" style="font-size: 10px;">Linear Sturcture</a> <a href="/tags/Linked-List/" style="font-size: 10px;">Linked List</a> <a href="/tags/LinkedList/" style="font-size: 10.91px;">LinkedList</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Logistic-Regression/" style="font-size: 10px;">Logistic Regression</a> <a href="/tags/Lucene/" style="font-size: 10px;">Lucene</a> <a href="/tags/Luong-Attention/" style="font-size: 10px;">Luong Attention</a> <a href="/tags/MEMM/" style="font-size: 10px;">MEMM</a> <a href="/tags/MF/" style="font-size: 10px;">MF</a> <a href="/tags/Machine/" style="font-size: 10px;">Machine</a> <a href="/tags/Machine-Learning/" style="font-size: 14.55px;">Machine Learning</a> <a href="/tags/Machine-Translation/" style="font-size: 10px;">Machine Translation</a> <a href="/tags/Manacher/" style="font-size: 10px;">Manacher</a> <a href="/tags/Managemnt/" style="font-size: 11.82px;">Managemnt</a> <a href="/tags/Markov/" style="font-size: 10px;">Markov</a> <a href="/tags/Materialized-Views/" style="font-size: 10px;">Materialized Views</a> <a href="/tags/Math/" style="font-size: 10.91px;">Math</a> <a href="/tags/Matplotlib/" style="font-size: 10px;">Matplotlib</a> <a href="/tags/Matrix-Factorization/" style="font-size: 10px;">Matrix Factorization</a> <a href="/tags/Median/" style="font-size: 10px;">Median</a> <a href="/tags/Metric/" style="font-size: 10px;">Metric</a> <a href="/tags/Minimum-Edit-Distance/" style="font-size: 10px;">Minimum Edit Distance</a> <a href="/tags/Minkowski/" style="font-size: 10px;">Minkowski</a> <a href="/tags/Model-Evaluation/" style="font-size: 10px;">Model Evaluation</a> <a href="/tags/Module/" style="font-size: 10px;">Module</a> <a href="/tags/Multi-Head-Attention/" style="font-size: 10px;">Multi-Head Attention</a> <a href="/tags/Multiway-Tree/" style="font-size: 10px;">Multiway Tree</a> <a href="/tags/NER/" style="font-size: 10.91px;">NER</a> <a href="/tags/NLG/" style="font-size: 10px;">NLG</a> <a href="/tags/NLM/" style="font-size: 10px;">NLM</a> <a href="/tags/NLP/" style="font-size: 20px;">NLP</a> <a href="/tags/NLU/" style="font-size: 10px;">NLU</a> <a href="/tags/NMT/" style="font-size: 10px;">NMT</a> <a href="/tags/Naive-Bayes/" style="font-size: 10px;">Naive Bayes</a> <a href="/tags/Neo4j/" style="font-size: 10px;">Neo4j</a> <a href="/tags/Ngram/" style="font-size: 10.91px;">Ngram</a> <a href="/tags/Normalizing-Flow/" style="font-size: 10px;">Normalizing Flow</a> <a href="/tags/NumPy/" style="font-size: 10px;">NumPy</a> <a href="/tags/Numba/" style="font-size: 10px;">Numba</a> <a href="/tags/Numpy/" style="font-size: 10px;">Numpy</a> <a href="/tags/Occupation/" style="font-size: 10px;">Occupation</a> <a href="/tags/Orientation/" style="font-size: 10px;">Orientation</a> <a href="/tags/P-R/" style="font-size: 10px;">P-R</a> <a href="/tags/PCCG/" style="font-size: 10px;">PCCG</a> <a href="/tags/PCFG/" style="font-size: 10px;">PCFG</a> <a href="/tags/PEGASUS/" style="font-size: 10px;">PEGASUS</a> <a href="/tags/PPMI/" style="font-size: 10px;">PPMI</a> <a href="/tags/PTM/" style="font-size: 10px;">PTM</a> <a href="/tags/PageRank/" style="font-size: 10px;">PageRank</a> <a href="/tags/Palindromic/" style="font-size: 10px;">Palindromic</a> <a href="/tags/Pandarallel/" style="font-size: 10px;">Pandarallel</a> <a href="/tags/Pandas/" style="font-size: 10.91px;">Pandas</a> <a href="/tags/Partial-Parsing/" style="font-size: 10px;">Partial Parsing</a> <a href="/tags/Pearson/" style="font-size: 10px;">Pearson</a> <a href="/tags/Philosophy/" style="font-size: 10.91px;">Philosophy</a> <a href="/tags/Phrase-Structure-Grammar/" style="font-size: 10px;">Phrase Structure Grammar</a> <a href="/tags/Phrase-Structure-Grammars/" style="font-size: 10px;">Phrase Structure Grammars</a> <a href="/tags/PoS/" style="font-size: 10px;">PoS</a> <a href="/tags/Polars/" style="font-size: 10px;">Polars</a> <a href="/tags/Pooling/" style="font-size: 10px;">Pooling</a> <a href="/tags/Position-Encoding/" style="font-size: 10px;">Position-Encoding</a> <a href="/tags/Postgres/" style="font-size: 10.91px;">Postgres</a> <a href="/tags/Pragmatic-Automatic-Processing/" style="font-size: 10px;">Pragmatic Automatic Processing</a> <a href="/tags/Pre-Trained/" style="font-size: 10px;">Pre-Trained</a> <a href="/tags/Pre-Training/" style="font-size: 10px;">Pre-Training</a> <a href="/tags/Pre-training/" style="font-size: 10.91px;">Pre-training</a> <a href="/tags/Precision/" style="font-size: 10px;">Precision</a> <a href="/tags/Pretrain/" style="font-size: 10px;">Pretrain</a> <a href="/tags/Pretrained/" style="font-size: 10px;">Pretrained</a> <a href="/tags/Pretraining/" style="font-size: 10.91px;">Pretraining</a> <a href="/tags/Probabilistic-Grammar/" style="font-size: 10px;">Probabilistic Grammar</a> <a href="/tags/Probabilistic-Model/" style="font-size: 10px;">Probabilistic Model</a> <a href="/tags/ProtoBERT/" style="font-size: 10px;">ProtoBERT</a> <a href="/tags/Pruning/" style="font-size: 10px;">Pruning</a> <a href="/tags/Psychology/" style="font-size: 10.91px;">Psychology</a> <a href="/tags/PyPI/" style="font-size: 10px;">PyPI</a> <a href="/tags/Python/" style="font-size: 18.18px;">Python</a> <a href="/tags/Quant/" style="font-size: 10px;">Quant</a> <a href="/tags/Quantization/" style="font-size: 10px;">Quantization</a> <a href="/tags/Query/" style="font-size: 10px;">Query</a> <a href="/tags/Queue/" style="font-size: 10px;">Queue</a> <a href="/tags/R-Drop/" style="font-size: 10.91px;">R-Drop</a> <a href="/tags/RELU/" style="font-size: 10px;">RELU</a> <a href="/tags/RFE/" style="font-size: 10px;">RFE</a> <a href="/tags/RMSE/" style="font-size: 10px;">RMSE</a> <a href="/tags/RNN/" style="font-size: 10px;">RNN</a> <a href="/tags/ROC/" style="font-size: 10px;">ROC</a> <a href="/tags/RaspberryPi/" style="font-size: 10.91px;">RaspberryPi</a> <a href="/tags/Raspberrypi/" style="font-size: 10px;">Raspberrypi</a> <a href="/tags/Recall/" style="font-size: 10px;">Recall</a> <a href="/tags/Recommendation/" style="font-size: 13.64px;">Recommendation</a> <a href="/tags/Recursion/" style="font-size: 10.91px;">Recursion</a> <a href="/tags/Reformer/" style="font-size: 10px;">Reformer</a> <a href="/tags/Regex/" style="font-size: 10px;">Regex</a> <a href="/tags/Regular-Expression/" style="font-size: 10px;">Regular Expression</a> <a href="/tags/Reinforcement-Learning/" style="font-size: 10px;">Reinforcement Learning</a> <a href="/tags/Relationship-Extraction/" style="font-size: 10px;">Relationship Extraction</a> <a href="/tags/Representation/" style="font-size: 10.91px;">Representation</a> <a href="/tags/Reqular-Expressions/" style="font-size: 10px;">Reqular Expressions</a> <a href="/tags/RoBERTa/" style="font-size: 10px;">RoBERTa</a> <a href="/tags/Rotated-Sorted-Array/" style="font-size: 10px;">Rotated Sorted Array</a> <a href="/tags/Rust/" style="font-size: 15.45px;">Rust</a> <a href="/tags/SCFG/" style="font-size: 10px;">SCFG</a> <a href="/tags/SGD/" style="font-size: 10px;">SGD</a> <a href="/tags/SMO/" style="font-size: 10px;">SMO</a> <a href="/tags/SQL/" style="font-size: 10.91px;">SQL</a> <a href="/tags/SRN/" style="font-size: 10px;">SRN</a> <a href="/tags/SVD/" style="font-size: 10px;">SVD++</a> <a href="/tags/SVM/" style="font-size: 10.91px;">SVM</a> <a href="/tags/Seaborn/" style="font-size: 10px;">Seaborn</a> <a href="/tags/Search/" style="font-size: 10.91px;">Search</a> <a href="/tags/Segmentation/" style="font-size: 10px;">Segmentation</a> <a href="/tags/Self-Attention/" style="font-size: 11.82px;">Self-Attention</a> <a href="/tags/Semantic-Automatic-Processing/" style="font-size: 10px;">Semantic Automatic Processing</a> <a href="/tags/Semantic-Similarity/" style="font-size: 10px;">Semantic Similarity</a> <a href="/tags/Senta/" style="font-size: 10px;">Senta</a> <a href="/tags/Sentence-Similarity/" style="font-size: 10px;">Sentence Similarity</a> <a href="/tags/Sentence-BERT/" style="font-size: 10px;">Sentence-BERT</a> <a href="/tags/Sentiment-Classification/" style="font-size: 10px;">Sentiment Classification</a> <a href="/tags/SentimentAnalysis/" style="font-size: 10px;">SentimentAnalysis</a> <a href="/tags/Siamese/" style="font-size: 10px;">Siamese</a> <a href="/tags/Sigmoid/" style="font-size: 10px;">Sigmoid</a> <a href="/tags/SimCSE/" style="font-size: 10.91px;">SimCSE</a> <a href="/tags/Similarity/" style="font-size: 10px;">Similarity</a> <a href="/tags/Simon/" style="font-size: 10px;">Simon</a> <a href="/tags/Simpson-Paradox/" style="font-size: 10px;">Simpson Paradox</a> <a href="/tags/Skill/" style="font-size: 10px;">Skill</a> <a href="/tags/Slide/" style="font-size: 10px;">Slide</a> <a href="/tags/Smoothing/" style="font-size: 10.91px;">Smoothing</a> <a href="/tags/Soft-SVM/" style="font-size: 10px;">Soft-SVM</a> <a href="/tags/Softmax/" style="font-size: 10px;">Softmax</a> <a href="/tags/Sort/" style="font-size: 10.91px;">Sort</a> <a href="/tags/Spell-Check/" style="font-size: 10px;">Spell Check</a> <a href="/tags/SqueezeBERT/" style="font-size: 10px;">SqueezeBERT</a> <a href="/tags/Stack/" style="font-size: 10px;">Stack</a> <a href="/tags/Stacking/" style="font-size: 10px;">Stacking</a> <a href="/tags/Statistics/" style="font-size: 10px;">Statistics</a> <a href="/tags/Stirling/" style="font-size: 10px;">Stirling</a> <a href="/tags/StratifiedKFold/" style="font-size: 10px;">StratifiedKFold</a> <a href="/tags/String/" style="font-size: 10.91px;">String</a> <a href="/tags/Style/" style="font-size: 10px;">Style</a> <a href="/tags/Substring/" style="font-size: 10px;">Substring</a> <a href="/tags/Summarization/" style="font-size: 10px;">Summarization</a> <a href="/tags/Supertagging/" style="font-size: 10px;">Supertagging</a> <a href="/tags/Swap/" style="font-size: 10px;">Swap</a> <a href="/tags/System/" style="font-size: 10.91px;">System</a> <a href="/tags/TF-IDF/" style="font-size: 10px;">TF-IDF</a> <a href="/tags/Tagging/" style="font-size: 10px;">Tagging</a> <a href="/tags/TanH/" style="font-size: 10px;">TanH</a> <a href="/tags/TensorBay/" style="font-size: 10px;">TensorBay</a> <a href="/tags/Tensorflow/" style="font-size: 10px;">Tensorflow</a> <a href="/tags/Test/" style="font-size: 10px;">Test</a> <a href="/tags/Text-Classification/" style="font-size: 10px;">Text Classification</a> <a href="/tags/Text-Generation/" style="font-size: 10px;">Text Generation</a> <a href="/tags/Text-Normalization/" style="font-size: 10px;">Text Normalization</a> <a href="/tags/TextCNN/" style="font-size: 10.91px;">TextCNN</a> <a href="/tags/TextRank/" style="font-size: 10px;">TextRank</a> <a href="/tags/Thought/" style="font-size: 10px;">Thought</a> <a href="/tags/Transformer/" style="font-size: 17.27px;">Transformer</a> <a href="/tags/Transformer-XL/" style="font-size: 10px;">Transformer-XL</a> <a href="/tags/Tree/" style="font-size: 10px;">Tree</a> <a href="/tags/Treebank/" style="font-size: 10px;">Treebank</a> <a href="/tags/Tuning/" style="font-size: 10px;">Tuning</a> <a href="/tags/Tutorial/" style="font-size: 10px;">Tutorial</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/UniLM/" style="font-size: 10px;">UniLM</a> <a href="/tags/Unity-Operation/" style="font-size: 10px;">Unity Operation</a> <a href="/tags/Unix/" style="font-size: 10px;">Unix</a> <a href="/tags/UserCF/" style="font-size: 10px;">UserCF</a> <a href="/tags/Vagrant/" style="font-size: 10px;">Vagrant</a> <a href="/tags/Valence/" style="font-size: 10px;">Valence</a> <a href="/tags/Vector-Semantics/" style="font-size: 10px;">Vector Semantics</a> <a href="/tags/VirtualBox/" style="font-size: 10px;">VirtualBox</a> <a href="/tags/Visualization/" style="font-size: 10px;">Visualization</a> <a href="/tags/Viterbi/" style="font-size: 10.91px;">Viterbi</a> <a href="/tags/Vocabulary-Learning/" style="font-size: 10px;">Vocabulary Learning</a> <a href="/tags/Voting/" style="font-size: 10px;">Voting</a> <a href="/tags/WOE/" style="font-size: 10px;">WOE</a> <a href="/tags/Web-Server-Multithreaded-Server/" style="font-size: 10px;">Web Server Multithreaded Server</a> <a href="/tags/Wide/" style="font-size: 10px;">Wide</a> <a href="/tags/Word2vec/" style="font-size: 10px;">Word2vec</a> <a href="/tags/Work/" style="font-size: 10px;">Work</a> <a href="/tags/XLNet/" style="font-size: 10px;">XLNet</a> <a href="/tags/Z-Score/" style="font-size: 10px;">Z-Score</a> <a href="/tags/ZhouZhihua/" style="font-size: 10px;">ZhouZhihua</a> <a href="/tags/Zipf/" style="font-size: 10px;">Zipf</a> <a href="/tags/binning/" style="font-size: 10px;">binning</a> <a href="/tags/few-shot/" style="font-size: 10px;">few-shot</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/jpype/" style="font-size: 10px;">jpype</a> <a href="/tags/knowledge-Graph/" style="font-size: 10px;">knowledge Graph</a> <a href="/tags/motion/" style="font-size: 10px;">motion</a> <a href="/tags/node2vec/" style="font-size: 10px;">node2vec</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/str/" style="font-size: 10px;">str</a> <a href="/tags/vlc/" style="font-size: 10px;">vlc</a>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-content">
      <ul>
        
          <li>
            <a href="/2021/10/27/NLP/2021-10-27-Senta/">浅析文本分类——情感分析与自然语言处理</a>
          </li>
        
          <li>
            <a href="/2021/09/21/NLP/2021-09-21-TensorBay-Intro/">TensorBay 指南</a>
          </li>
        
          <li>
            <a href="/2021/08/31/AI/2021-08-31-SL-CL-Dropout/">在 TextCNN 上实验 Dropout 和对比学习</a>
          </li>
        
          <li>
            <a href="/2021/08/18/Paper/2021-08-18-R-Drop/">R-Drop</a>
          </li>
        
          <li>
            <a href="/2021/08/12/DataSci/2021-08-12-Dataprocess-Performance/">高性能数据处理</a>
          </li>
        
      </ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-content">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AE/">AE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/">AI</a><span class="tag-list-count">52</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ALBERT/">ALBERT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AR/">AR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AUC/">AUC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Accuracy/">Accuracy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Activation/">Activation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/">Algorithm</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Array/">Array</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Arrow/">Arrow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Attention/">Attention</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Automatic-Speech-Processing/">Automatic Speech Processing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Automation/">Automation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BERT/">BERT</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BPE/">BPE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backtracking/">Backtracking</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backward/">Backward</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bahdanau-Attention/">Bahdanau Attention</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bart/">Bart</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bayes/">Bayes</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Beam-Search/">Beam Search</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bert/">Bert</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bert-Flow/">Bert-Flow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bi-LSTM/">Bi-LSTM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Binary-Search/">Binary Search</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blending/">Blending</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Business/">Business</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CCG/">CCG</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CFG/">CFG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CKY/">CKY</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/">CNN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CRF/">CRF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CYK/">CYK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Calculus/">Calculus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Camera/">Camera</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Catalan/">Catalan</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ChatBot/">ChatBot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chi2/">Chi2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chunking/">Chunking</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Classification/">Classification</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cognition/">Cognition</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collaborative-Filtering/">Collaborative Filtering</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collins-Parser/">Collins Parser</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Computational-Linguistics/">Computational Linguistics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Computer/">Computer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Computer-Science/">Computer Science</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Confusing-Labels/">Confusing Labels</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Context-Free-Grammars/">Context-Free Grammars</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Contrastive-Learning/">Contrastive-Learning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coordinate-Ascent/">Coordinate Ascent</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cosine/">Cosine</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cosine-Similarity/">Cosine Similarity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cross-Entropy/">Cross Entropy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cross-brackets/">Cross-brackets</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ctrl/">Ctrl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB/">DB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNN/">DNN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DP/">DP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Clearing/">Data Clearing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Preprocess/">Data Preprocess</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Science/">Data Science</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Data-Structure/">Data Structure</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Database/">Database</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DeBERTa/">DeBERTa</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Decoder/">Decoder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Decoding/">Decoding</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deep/">Deep</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DeepGraph/">DeepGraph</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DeepLearning/">DeepLearning</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dependence/">Dependence</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Diary/">Diary</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Disentangled-Attention/">Disentangled Attention</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DistilBERT/">DistilBERT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Distillation/">Distillation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker-Compose/">Docker-Compose</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dockerfile/">Dockerfile</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dropout/">Dropout</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dynamic-Mask/">Dynamic-Mask</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EDA/">EDA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EMD/">EMD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ERNIE/">ERNIE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Economics/">Economics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Edit-Distance/">Edit Distance</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Efficient-DeepLearning/">Efficient-DeepLearning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Electra/">Electra</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elixir/">Elixir</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Embedding/">Embedding</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Embeddings/">Embeddings</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Encoder/">Encoder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Entropy/">Entropy</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Evaluation/">Evaluation</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/F1/">F1</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FDW/">FDW</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FSM/">FSM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Feature-Engineering/">Feature Engineering</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Feature-based/">Feature-based</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Few-Shot/">Few-Shot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fine-tuning/">Fine-tuning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Formal-Grammars/">Formal Grammars</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Forward/">Forward</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Full-Text-Search/">Full-Text-Search</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Function-Syntax/">Function Syntax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Funk-MF/">Funk MF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Funnel-Transformer/">Funnel Transformer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GBTD/">GBTD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GELU/">GELU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPT-2/">GPT-2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPU/">GPU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GRU/">GRU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GSG/">GSG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gan/">Gan</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Garden-path/">Garden-path</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Glow/">Glow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graceful-Shutdown/">Graceful Shutdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gradient-Descent/">Gradient Descent</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Graph/">Graph</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphQL/">GraphQL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Grid-Grammar/">Grid Grammar</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HMM/">HMM</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hard-SVM/">Hard-SVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hinge-Loss/">Hinge Loss</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IE/">IE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IQR/">IQR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Imbalance-Data/">Imbalance Data</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Industry/">Industry</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Information-Extraction/">Information Extraction</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Information-Theory/">Information Theory</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Isolation-Forest/">Isolation Forest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ItemCF/">ItemCF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jaccard/">Jaccard</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jax/">Jax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Job/">Job</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jupyter/">Jupyter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KKT/">KKT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KS/">KS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kernel/">Kernel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kernel-Function/">Kernel Function</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kernel-Method/">Kernel Method</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Keyword/">Keyword</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Knowledge-Graph/">Knowledge Graph</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LM/">LM</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LOF/">LOF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LR/">LR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LSTM/">LSTM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Language-Model/">Language Model</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lexical-Semantics/">Lexical Semantics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lexicalism/">Lexicalism</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lexicalized-CFG/">Lexicalized CFG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lexicalized-Grammars/">Lexicalized Grammars</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linear-Algebra/">Linear Algebra</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linear-Sturcture/">Linear Sturcture</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linked-List/">Linked List</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LinkedList/">LinkedList</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Logistic-Regression/">Logistic Regression</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lucene/">Lucene</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Luong-Attention/">Luong Attention</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MEMM/">MEMM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MF/">MF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine/">Machine</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Translation/">Machine Translation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Manacher/">Manacher</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Managemnt/">Managemnt</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markov/">Markov</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Materialized-Views/">Materialized Views</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Matplotlib/">Matplotlib</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Matrix-Factorization/">Matrix Factorization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Median/">Median</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Metric/">Metric</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Minimum-Edit-Distance/">Minimum Edit Distance</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Minkowski/">Minkowski</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Model-Evaluation/">Model Evaluation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Module/">Module</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Multi-Head-Attention/">Multi-Head Attention</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Multiway-Tree/">Multiway Tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NER/">NER</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLG/">NLG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLM/">NLM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLP/">NLP</a><span class="tag-list-count">72</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLU/">NLU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NMT/">NMT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Naive-Bayes/">Naive Bayes</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neo4j/">Neo4j</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ngram/">Ngram</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Normalizing-Flow/">Normalizing Flow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NumPy/">NumPy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numba/">Numba</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/">Numpy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Occupation/">Occupation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Orientation/">Orientation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/P-R/">P-R</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PCCG/">PCCG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PCFG/">PCFG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PEGASUS/">PEGASUS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PPMI/">PPMI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PTM/">PTM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PageRank/">PageRank</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Palindromic/">Palindromic</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pandarallel/">Pandarallel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pandas/">Pandas</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Partial-Parsing/">Partial Parsing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pearson/">Pearson</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Philosophy/">Philosophy</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Phrase-Structure-Grammar/">Phrase Structure Grammar</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Phrase-Structure-Grammars/">Phrase Structure Grammars</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PoS/">PoS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Polars/">Polars</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pooling/">Pooling</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Position-Encoding/">Position-Encoding</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres/">Postgres</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pragmatic-Automatic-Processing/">Pragmatic Automatic Processing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pre-Trained/">Pre-Trained</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pre-Training/">Pre-Training</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pre-training/">Pre-training</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Precision/">Precision</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pretrain/">Pretrain</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pretrained/">Pretrained</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pretraining/">Pretraining</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Probabilistic-Grammar/">Probabilistic Grammar</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Probabilistic-Model/">Probabilistic Model</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ProtoBERT/">ProtoBERT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pruning/">Pruning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Psychology/">Psychology</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PyPI/">PyPI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quant/">Quant</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quantization/">Quantization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Query/">Query</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Queue/">Queue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/R-Drop/">R-Drop</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RELU/">RELU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RFE/">RFE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RMSE/">RMSE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RNN/">RNN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROC/">ROC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RaspberryPi/">RaspberryPi</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Raspberrypi/">Raspberrypi</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Recall/">Recall</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Recommendation/">Recommendation</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Recursion/">Recursion</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reformer/">Reformer</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regex/">Regex</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regular-Expression/">Regular Expression</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reinforcement-Learning/">Reinforcement Learning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Relationship-Extraction/">Relationship Extraction</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Representation/">Representation</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reqular-Expressions/">Reqular Expressions</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RoBERTa/">RoBERTa</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rotated-Sorted-Array/">Rotated Sorted Array</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rust/">Rust</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SCFG/">SCFG</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SGD/">SGD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SMO/">SMO</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/">SQL</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SRN/">SRN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVD/">SVD++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVM/">SVM</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Seaborn/">Seaborn</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Search/">Search</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Segmentation/">Segmentation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Self-Attention/">Self-Attention</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Semantic-Automatic-Processing/">Semantic Automatic Processing</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Semantic-Similarity/">Semantic Similarity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Senta/">Senta</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sentence-Similarity/">Sentence Similarity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sentence-BERT/">Sentence-BERT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sentiment-Classification/">Sentiment Classification</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SentimentAnalysis/">SentimentAnalysis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Siamese/">Siamese</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sigmoid/">Sigmoid</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SimCSE/">SimCSE</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Similarity/">Similarity</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Simon/">Simon</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Simpson-Paradox/">Simpson Paradox</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Skill/">Skill</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Slide/">Slide</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Smoothing/">Smoothing</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Soft-SVM/">Soft-SVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Softmax/">Softmax</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sort/">Sort</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spell-Check/">Spell Check</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SqueezeBERT/">SqueezeBERT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stack/">Stack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stacking/">Stacking</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Statistics/">Statistics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stirling/">Stirling</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/StratifiedKFold/">StratifiedKFold</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/String/">String</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Style/">Style</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Substring/">Substring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Summarization/">Summarization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Supertagging/">Supertagging</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swap/">Swap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/System/">System</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TF-IDF/">TF-IDF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tagging/">Tagging</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TanH/">TanH</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorBay/">TensorBay</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/">Tensorflow</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Test/">Test</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Text-Classification/">Text Classification</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Text-Generation/">Text Generation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Text-Normalization/">Text Normalization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextCNN/">TextCNN</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextRank/">TextRank</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thought/">Thought</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Transformer/">Transformer</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Transformer-XL/">Transformer-XL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tree/">Tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Treebank/">Treebank</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tuning/">Tuning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tutorial/">Tutorial</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UniLM/">UniLM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity-Operation/">Unity Operation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unix/">Unix</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UserCF/">UserCF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vagrant/">Vagrant</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Valence/">Valence</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vector-Semantics/">Vector Semantics</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VirtualBox/">VirtualBox</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Visualization/">Visualization</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Viterbi/">Viterbi</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vocabulary-Learning/">Vocabulary Learning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Voting/">Voting</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WOE/">WOE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web-Server-Multithreaded-Server/">Web Server Multithreaded Server</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wide/">Wide</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Word2vec/">Word2vec</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Work/">Work</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XLNet/">XLNet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Z-Score/">Z-Score</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZhouZhihua/">ZhouZhihua</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zipf/">Zipf</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/binning/">binning</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/few-shot/">few-shot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg/">ffmpeg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jpype/">jpype</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/knowledge-Graph/">knowledge Graph</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/motion/">motion</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node2vec/">node2vec</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/">ssh</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/str/">str</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vlc/">vlc</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </aside>

  
</div>
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2021 Yam
    All rights reserved.</p>
    <p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></p>
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <!-- <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span> -->
    <!-- <span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span> -->
    <!-- <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次</span> -->

</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script src="/js/navigation.js"></script>

<div id="bg"></div>

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>